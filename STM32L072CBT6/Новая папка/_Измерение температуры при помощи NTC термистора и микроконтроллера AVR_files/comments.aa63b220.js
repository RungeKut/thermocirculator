(()=>{"use strict";var __webpack_modules__={49794:(e,t,i)=>{function _(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" d="m6.55 5.05 4.77 2.64a.35.35 0 0 1 0 .62l-4.77 2.64a.37.37 0 0 1-.5-.13.34.34 0 0 1-.05-.17v-5.3A.36.36 0 0 1 6.37 5c.06 0 .12.02.18.05Z"/></svg>',name:"play_marusia_foreground_16"}}i.d(t,{getIcon16PlayMarusiaForeground:()=>_})},49988:(e,t,i)=>{function _(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" d="M5 7.4c0-.84 0-1.26.16-1.58a1.5 1.5 0 0 1 .66-.66C6.14 5 6.56 5 7.4 5h1.2c.84 0 1.26 0 1.58.16a1.5 1.5 0 0 1 .66.66c.16.32.16.74.16 1.58v1.2c0 .84 0 1.26-.16 1.58a1.5 1.5 0 0 1-.66.66c-.32.16-.74.16-1.58.16H7.4c-.84 0-1.26 0-1.58-.16a1.5 1.5 0 0 1-.66-.66C5 9.86 5 9.44 5 8.6V7.4Z"/></svg>',name:"stop_marusia_foreground_16"}}i.d(t,{getIcon16StopMarusiaForeground:()=>_})},28829:(e,t,i)=>{i.d(t,{BRIDGE_STAT_CALL_ARGUMENTS_MAX_LENGTH:()=>p,ERROR_CODES:()=>_,ERROR_REASONS:()=>o,ERROR_TYPES:()=>s,NFT_APP_ID:()=>n,ORD_APP_ID:()=>a,SITPOSTING_APP_ID:()=>l,VKPAY_APPS:()=>r,VK_CONNECT_EVENTS:()=>c,VMOJI_CONSTRUCTOR_APP_ID:()=>d});const _={UNKNOWN:1,MISSING_PARAM:2,OLD_MISSING_PARAM:100,CONNECTION_LOST:3,USER_DENIED:4,INVALID_PARAMS:5,UNSUPPORTED_PLATFORM:6,REQUESTS_LIMIT_REACHED:10,ACCESS_DENIED:11,CUSTOM:13,NO_ADS:20},o={ACCESS_DENIED:"Access denied",UNSUPPORTED_PLATFORM:"Unsupported platform",UNSUPPORTED_ACTION:"Unsupported action",NATIVE_APP_IS_NOT_INSTALLED:"VK client is not installed on device",USER_NOT_A_PRIVATE_GROUP_MEMBER:"User is not a member of the given private group",UNKNOWN_ERROR:"Unknown error",CONNECTION_LOST:"Connection lost",NETWORK_ERROR:"Network error",USER_DENIED:"User denied",INVALID_PARAMS:"Invalid params",NO_ADS:"No ads",ADS_ALREADY_PLAYED:"Ads already played",VK_PAY_DISABLED:"This app can't use VK Pay",SCROLL_SUBSCRIBER_ALREADY_EXIST:"Scroll subscriber already exist",SUBSCRIPTION_IS_ALREADY_CANCELLED:"Subscription is in invalid status: subscription is already cancelled",SURVEY_INIT_IN_PROGRESS:"Survey init in progress",SURVEY_ALREADY_INIT:"Survey already init",SURVEY_NO_MATCH:"Survey no match",SURVEY_USER_CANCEL:"Survey user cancel",ALREADY_IN_PROGRESS:"Already in progress",USER_IS_NOT_GROUP_ADMIN:"Only group admins have access to group tokens",DEVICE_CANT_GET_GEODATA:"Device can't get geodata",USER_DIDNT_ALLOWED_ACTION:"User didn't allowed"},s={CLIENT:"client_error",API:"api_error",AUTH:"auth_error"},r=[6217559,7131443],a=51707812,n=51459963,l=7644481,d=7929683,c={VKWebAppAddToCommunity:"add_to_community",VKWebAppAddToCommunityPreload:"get_groups_list",VKWebAppAddToFavorites:"add_to_favorites",VKWebAppAddToFavoritesPreload:"already_added_to_favorites",VKWebAppAddToMenu:"add_to_menu",VKWebAppAddToMenuPreload:"is_in_left_menu",VKWebAppGetCommunityToken:"get_community_token",VKWebAppGetCommunityTokenPreload:"get_community_preload_settings",VKWebAppGetAuthToken:"get_auth_token",VKWebAppGetAuthTokenPreload:"get_auth_token_info",VKWebAppGetPhoneNumber:"get_phone_number",VKWebAppGetPhoneNumberPreload:"already_get_phone_number",VKWebAppGetEmail:"get_email",VKWebAppGetEmailPreload:"already_get_email",VKWebAppGetFriends:"get_friends",VKWebAppAllowNotificationsPreload:"are_notifications_allowed",VKWebAppAllowNotifications:"allow_notifications",VKWebAppDenyNotifications:"deny_notifications",VKWebAppAllowMessagesFromGroup:"allow_messages_from_group",VKWebAppAllowMessagesFromGroupPreload:"can_send_messages_from_group",VKWebAppJoinGroup:"join_group",VKWebAppJoinGroupPreload:"is_group_member",VKWebAppLeaveGroup:"leave_group",VKWebAppLeaveGroupPreload:"is_group_member",VKWebAppOpenApp:"open_app",VKWebAppSendPayload:"send_payload",VKWebAppSendToClient:"send_to_client",VKWebAppSendToClientPreload:"get_open_in_native_permission",VKWebAppShowOrderBox:"order",VKWebAppShowSubscriptionBox:"subscription",VKWebAppShowLeaderBoardBox:"show_leader_board",VKWebAppShowLinkCardBox:"show_link_card",VKWebAppShowNftPaymentBox:"show_nft_pay_box",VKWebAppShowInviteBox:"invite_friends",VKWebAppShowStoryBox:"story_box",VKWebAppShowRequestBox:"send_request",VKWebAppShowRequestBoxPreload:"request_box_preload",VKWebAppStorageGetKeys:"storage_get_keys",VKWebAppStorageSet:"storage_set",VKWebAppStorageGet:"storage_get",VKWebAppOpenArticleEditor:"open_article_edit",VKWebAppSubscribeStoryApp:"subscribe_story_app",VKWebAppClose:"close",VKWebAppGetSilentToken:"get_silent_token",VKWebAppCheckAllowedScopes:"check_allowed_scopes",VKWebAppOpenPayForm:"open_pay_form",VKWebAppCheckSurvey:"check_survey",VKWebAppShowSurvey:"show_survey",VKWebAppAddToChat:"add_to_chat",VKWebAppTrackEvent:"track_event",VKWebAppCallStart:"call_start",VKWebAppCallJoin:"call_join",VKWebAppCallLeft:"call_left",VKWebAppCallFinished:"call_finished",VKWebAppCallGetStatus:"call_get_status",VKWebAppCallStartSharing:"call_start_sharing",VKWebAppCallStopSharing:"call_stop_sharing"},p=256},35025:(e,t,i)=>{function _(e,t,i,_){const o=t?"article.php":"al_articles.php";ajax.post(o,{act:"tts",article_owner_id:e.owner_id,article_id:e.id,hash:e.tts_hash,support_streaming:i?1:0},{onDone:e=>{_(e)}})}i.d(t,{loadArticle:()=>_})},57888:(e,t,i)=>{i(8520),i(76448),i(72950)},77608:(e,t,i)=>{i.d(t,{ArticleTts:()=>c});var _=i(85152),o=i(20166),s=i(88343),r=i(95910),a=i(52487),n=i(16934),l=i(91110),d=i(35025);class c{static load(e,t,i,_){this.loadingArticleRawId=e.raw_id,(0,d.loadArticle)(e,t,i,(e=>{this.loadingArticleRawId=null,_(e)}))}static getAudio(e,t,i){const _=[],s=JSON.stringify({articleTts:!0,articleId:e,articleOwnerId:t,externalStream:!0});return _[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ID]=`${t}${e}`,_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_OWNER_ID]=t,_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_URL]=i.url,_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TITLE]=i.title,_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_PERFORMER]=i.artist,_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_DURATION]=i.duration,_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_AUTHOR_LINK]="",_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_LYRICS]=0,_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FLAGS]=0,_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_CONTEXT]="",_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_EXTRA]=s,_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_HASHES]="",_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_COVER_URL]="",_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ADS]={},_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_SUBTITLE]="",_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_MAIN_ARTISTS]="",_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FEAT_ARTISTS]="",_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM]=!1,_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TRACK_CODE]="",_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_RESTRICTION]=0,_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM_PART]=0,_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY]="",_[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CHART_INFO_INDEX]=!1,_}static play(e,t,i,o){this.onArticleTtsExpire=o,this.statsHandlersInitialized||(this._audioPlayer().subscribe(r.AudioPlayerEventType.PLAY,(()=>{if(this.isAnyArticleInPlayer()){const e=this._audioPlayer().getCurrentProgress()>0?_.ArticleTtsActionType.CONTINUE:_.ArticleTtsActionType.START;this.sendStats(e)}})),this._audioPlayer().subscribe(r.AudioPlayerEventType.PAUSE,(()=>{this.isAnyArticleInPlayer()&&this.sendStats(_.ArticleTtsActionType.PAUSE)})),this._audioPlayer().subscribe(r.AudioPlayerEventType.ENDED,(()=>{if(this.isAnyArticleInPlayer()){let e=this._audioPlayer();if(e._impl?._hlsError||e._impl?._currentAudioEl?.error){e._impl&&(e._impl._hlsError=void 0);const t=(0,l.getAudioExtra)(e.getCurrentAudio());e.deleteCurrentPlaylist(),c.retryCount<3&&(c.retryCount+=1,setTimeout((()=>{this.onArticleTtsExpire?.(t)}),c.RETRY_TIMEOUT))}this.sendStats(_.ArticleTtsActionType.P100)}})),this.statsHandlersInitialized=!0);const s=this.getAudio(e,t,i),a=this._audioPlayer().getPlaylist(n.AudioPlaylist.TYPE_ARTICLE_TTS,t,e);a.mergeWith({list:[s]}),this._audioPlayer().play(s,a)}static _audioPlayer(){return window.getAudioPlayer()}static _audioExtra(){const e=this._audioPlayer().getCurrentAudio();return(0,l.getAudioExtra)(e)??{}}static isLoadingArticle(e){return this.loadingArticleRawId===e.raw_id}static isArticleInPlayer(e){return e.owner_id===this._audioExtra().articleOwnerId&&e.id===this._audioExtra().articleId}static isAnyArticleInPlayer(){return(0,s.isArticleTts)(this._audioPlayer().getCurrentAudio())}static sendStats(e){const{articleId:t,articleOwnerId:i}=this._audioExtra();_.articleTtsActionStatController.logEvent({action:e,nav_screen:"article_read",article_id:t,owner_id:i,audio_length:(0,a.audioTupleToAudioObject)(this._audioPlayer().getCurrentAudio())?.duration??0,speed:Math.round(100*AudioPlayer.podcastGetPlaybackRate()),volume:Math.round(100*this._audioPlayer().getVolume())})}}c.statsHandlersInitialized=!1,c.retryCount=0,c.RETRY_TIMEOUT=1e3},55860:(e,t,i)=>{i.d(t,{default:()=>d});var _=i(51998),o=i(11440),s=i(825),r=i(71490),a=i(78402);const n="page_header_cont",l="onboarding";class d{initOnboardingBG(){if(!window.onboardingBG){let e='\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="49px">\n    <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" class="GroupOnboardingBgClip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ',t=(0,_.se)(e);(0,_.domInsertBefore)(t,window.layerBG),window.onboardingBGHeader=(0,_.ge)("onboarding_bg_header"),window.onboardingBG=(0,_.ge)("onboarding_bg"),window.onboardingBGRect=(0,_.ge)("onboarding_bg_rect"),window.onboardingBGClip=(0,_.ge)("onboarding_bg_clip"),window.cur.destroy.push((()=>{(0,_.hide)(window.onboardingBG),(0,_.hide)(window.onboardingBGHeader),(0,_.removeClass)((0,_.ge)(n),l),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&(0,o.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick)}))}this.opts.onBGClick&&(0,o.addEvent)(window.onboardingBG,"click",this.opts.onBGClick)}showTT(){const[,e]=(0,_.getXY)(this.el);this.tt=new a.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();const t=this.tt.getContent();(0,r.isElementInViewport)(this.el)&&(0,r.isElementInViewport)(t)||(0,s.scrollToY)(e-42-this.ttParams.scrollOffset)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&((0,o.removeEvent)(window,"scroll"),(0,o.removeEvent)(window,"resize")),this.opts.onBGClick&&window.onboardingBG&&(0,o.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick),this.opts.onHide&&this.opts.onHide())}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),(0,o.addEvent)(window,"scroll",this.onScrollTT.bind(this)),(0,o.addEvent)(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){let e=this.el.offsetWidth,t=this.el.offsetHeight,i=(0,_.getXY)(this.el);(0,_.attr)(window.onboardingBGClip,"width",e+this.border[1]+this.border[3]),(0,_.attr)(window.onboardingBGClip,"height",t+this.border[0]+this.border[2]),(0,_.attr)(window.onboardingBGClip,"x",i[0]-this.border[1]),(0,_.attr)(window.onboardingBGClip,"y",i[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){let e=this.getPageHeight();window.onboardingBG.height!=e&&this.setDartToFullHeight()}setDartToFullHeight(){(0,_.attr)(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){(0,_.attr)(window.onboardingBG,"width",this.getPageWidth()),(0,_.attr)(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){(0,_.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),(0,_.show)(window.onboardingBG),(0,_.isVisible)(window.onboardingBGHeader)||((0,_.show)(window.onboardingBGHeader),(0,_.addClass)((0,_.ge)(n),l)))}removeDarkens(){this.hideDarkness&&((0,_.hide)(window.onboardingBG),(0,_.hide)(window.onboardingBGHeader),(0,_.removeClass)((0,_.ge)(n),l))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){const e=document.documentElement,t=document.body;return Math.max(t.scrollWidth,e.scrollWidth,t.offsetWidth,e.offsetWidth,t.clientWidth,e.clientWidth)}getPageHeight(){const e=document.documentElement,t=document.body;return Math.max(t.scrollHeight,e.scrollHeight,t.offsetHeight,e.offsetHeight,t.clientHeight,e.clientHeight)}constructor(e,t,i={}){this.el=e,this.text=t,this.hideDarkness=!0,this.oldColor=!1;let _={autoShow:!1,noAutoHideOnWindowClick:i.noAutoHideOnWindowClick??!0,content:t instanceof HTMLElement?t:`${t}`,cls:`feature_intro_tt tutorial_tip_tt ${(()=>{const e=i.class??"";return i.tooltipWhite?e:e+" feature_intro_blue_tt"})()}`,appendToParent:!0,onHide:this.ttOnHide.bind(this),scrollOffset:i.scrollOffset||0,align:i.align||a.ElementTooltip.ALIGN_CENTER};i.side&&(_.forceSide=i.side),i.offset&&(_.offset=i.offset),i.width&&(_.width=i.width),i.shift&&(_.centerShift=i.shift),i.border?this.border=i.border:this.border=[10,10,10,10],i.ttOnHide&&(_.onHide=i.ttOnHide),i.withCloseButton&&(_.withCloseButton=i.withCloseButton,_.onCloseButtonClick=i.onCloseButtonClick),i.align&&(_.align=i.align),this.ttParams=_,this.opts=i,this.initOnboardingBG()}}},71490:(e,t,i)=>{function _(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}i.d(t,{isElementInViewport:()=>_})},5241:(e,t,i)=>{i.d(t,{UiScroll:()=>d});var _=i(39565),o=i(77004),s=i(91691),r=i(51998),a=i(11440),n=i(63330),l=i(72995);class d{init(){if(this.options.stopScrollPropagation&&this.fixBlocker(),!this.inited){if(!this.el.container.scrollWidth||this.disabled)return;this.fixSize(!0),this.options.autoresize&&this.startResizeListening(),this.options.global||cur.destroy.push(this.destroy.bind(this)),this.inited=!0}return this.update(!0),this.api}addEvent(e,t,i,_){return this.removeEvents.push([e,t,i]),(0,a.addEvent)(e,t,i,void 0,void 0,_?{passive:!0}:void 0),i}destroy(){if(this.disabled=!0,this.fixSize(),this.animation&&this.animation.stop(),this.moreTimeout&&clearTimeout(this.moreTimeout),this.dragstopHandler&&(0,a.removeEvent)(document,"mouseup contextmenu",this.dragstopHandler),this.dragHandler&&(0,a.removeEvent)(document,"mousemove",this.dragHandler),(0,s.each)(this.removeEvents,(function(e,t){a.removeEvent.apply(null,t)})),this.el.overflow.parentNode==this.el.container){const e=(0,r.cf)();for(;this.el.content.firstChild;)e.appendChild(this.el.content.firstChild);this.el.container.appendChild(e)}return(0,r.removeData)(this.el.container,"ui-scroll"),this.el.container.className=this.el.container.className.replace(/\bui_scroll_.+?\b/g," "),(0,s.each)(this.removeElements,(function(e,t){(0,r.re)(t)})),this.el.container.scrollTop=this.api.data.scrollTop,delete this.el.container.__uiScroll__,this.api}updateAbove(e){if((0,s.isFunction)(e)){this.animation&&this.animation.stop();const t=this.el.outer.scrollHeight-this.el.outer.scrollTop-this.el.overflow.offsetHeight;e(),this.el.outer.scrollTop=this.el.outer.scrollHeight-this.el.overflow.offsetHeight-t}return this.api}updateBelow(e){if((0,s.isFunction)(e)){this.animation&&this.animation.stop();const t=this.options.preserveEdgeBelow&&this.api.data.scrollBottom<=this.options.preserveEdgeBelowThreshold;e(),t&&this.scrollBottom(!1)}return this.api}fixBlocker(){_.browser.chrome&&!this.options.noForceReFlow&&this.forceReFlow(),this.el.blocker.scrollTop=this.blockerScrollTop}forceReFlow(){this.el.blocker.style.display="inline-block",this.el.blocker.offsetHeight,this.el.blocker.style.display=""}fixSize(e){this.options.native||(e&&null==this.fixSizeDefault&&(this.fixSizeDefault=this.el.container.style.width),(0,r.setStyle)(this.el.container,"width",e?(0,r.getSize)(this.el.container,!0)[0]||this.fixSizeDefault||"":this.fixSizeDefault||""))}emitEvent(e){this.disabled||this.inited&&this.emitter.emitEvent(e,[this.api])}static scrollEventDelta(e){let t=0;const i=void 0!==e.deltaMode?e.deltaMode:"MozMousePixelScroll"==e.type?0:1;return"wheel"==e.type?t=e.deltaY:void 0!==e.wheelDeltaX&&void 0!==e.wheelDeltaY?(t=1/40*-e.wheelDeltaY,_.browser.mac&&_.browser.opera&&(t*=.1)):void 0!==e.wheelDelta?t=1/40*-e.wheelDelta:e.detail&&2===e.axis&&(t=e.detail),t*(1==i?15:2==i?450:1)}isScrollEventUnused(e){return d.scrollEventDelta(e)>0?!this.api.data.scrollBottom:!this.api.data.scrollTop}resize(e){if(!e&&this.options.preserveEdgeBelow){const t=this.options.preserveEdgeBelow&&this.api.data.scrollBottom<=this.options.preserveEdgeBelowThreshold;this.update(!0)&&(this.emitEvent("resize"),t&&this.scrollBottom(),this.options.stopScrollPropagation&&!e&&this.fixBlocker())}else this.update(!0)&&(this.options.stopScrollPropagation&&!e&&this.fixBlocker(),this.emitEvent("resize"))}disable(e){return this.disabled=!!e,e?(this.animation&&this.animation.stop(),this.fixSize()):(this.fixSize(!0),this.options.stopScrollPropagation&&this.fixBlocker(),this.update(!0)),(0,r.toggleClass)(this.el.container,"ui_scroll_disabled",this.disabled),this.api}dragstart(e){if(!(this.disabled||this.dragging||this.options.native))return e||(e=window.event),this.dragging=!0,this.animation&&this.animation.stop(),this.options.reversed&&(this.noMore=!0),(0,a.addEvent)(document,"mouseup contextmenu",this.dragstartHandler=this.dragstop.bind(this)),(0,a.addEvent)(document,"mousemove",this.dragHandler=this.drag.bind(this)),this.dragScroll=this.options.reversed?this.api.data.scrollBottom:this.api.data.scrollTop,this.dragY=e.screenY,(0,a.cancelEvent)(e),this.emitEvent("dragstart"),this.api}dragstop(e){if(!this.disabled&&this.dragging&&!this.options.native){if(e||(e=window.event),this.dragging=!1,this.dragstopHandler&&(0,a.removeEvent)(document,"mouseup contextmenu",this.dragstopHandler),this.dragHandler&&(0,a.removeEvent)(document,"mousemove",this.dragHandler),(0,r.setStyle)(document.body,"cursor",""),(0,r.removeClass)(this.el.container,"ui_scroll_dragging"),this.dragged)this.noMore&&(this.noMore=!1,this.more());else{this.options.reversed&&(this.noMore=!0);const t=(e.pageY-(0,r.getXY)(this.el.barOuter)[1]-this.barInnerHeight/2)*(Math.max(this.options.minContentHeight,this.api.data.scrollHeight)-this.api.data.viewportHeight)/(this.barOuterHeight-this.barInnerHeight);this.scrollTop(!1,t,0,function(){this.noMore&&(this.noMore=!1,this.more())}.bind(this))}return this.dragged=!1,e&&"contextmenu"!==e.type&&(0,a.cancelEvent)(e),this.emitEvent("dragstop"),this.api}}drag(e){if(this.disabled||!this.dragging||this.options.native)return;e||(e=window.event);const t=(e.screenY-this.dragY)*(this.api.data.scrollHeight/this.el.barOuter.scrollHeight);return this.el.outer.scrollTop=this.options.reversed?this.el.outer.scrollHeight-this.el.overflow.offsetHeight-this.dragScroll+t:this.dragScroll+t,this.dragged||(this.dragged=!0,(0,r.setStyle)(document.body,"cursor","pointer"),(0,r.addClass)(this.el.container,"ui_scroll_dragging")),(0,a.cancelEvent)(e),this.emitEvent("drag"),this.api}scroll(e,t,i){return this.animation&&this.animation.stop(),this.el.outer.scrollTop==e&&this.update(!0),t?(t="number"!=typeof t||!isFinite(t)||t%1?300:Math.abs(t),this.animation=new n.Fx.Base({scrollTop:this.el.outer.scrollTop},{transition:n.Fx.Transitions.easeOutCubic,onStep:function(e){this.el.outer.scrollTop=e.scrollTop}.bind(this),duration:t,onComplete:(0,s.isFunction)(i)?i.pbind(this.api):void 0}).start({scrollTop:this.el.outer.scrollTop},{scrollTop:e})):(this.el.outer.scrollTop=e,(0,s.isFunction)(i)&&i(this.api)),this.api}scrollTop(e,t,i,_){if(e&&this.options.stopScrollPropagation&&this.fixBlocker(),!this.disabled&&!this.dragging)return this.scroll((0,s.intval)(t),i,_)}scrollBottom(e,t,i,_){if(e&&this.options.stopScrollPropagation&&this.fixBlocker(),!this.disabled&&!this.dragging)return this.scroll(this.el.outer.scrollHeight-this.el.overflow.offsetHeight-(0,s.intval)(t),i,_)}scrollBy(e,t,i){if(!this.disabled&&!this.dragging)return this.scroll(this.el.outer.scrollTop+(0,s.intval)(e),t,i)}scrollIntoView(e,t,i,_){if(e&&this.options.stopScrollPropagation&&this.fixBlocker(),(t=(0,l.getScrollElement)(t))&&t.compareDocumentPosition&&t.compareDocumentPosition(this.el.content)&Node.DOCUMENT_POSITION_CONTAINS){const e=(0,r.getXY)(t)[1],o=(0,r.getXY)(this.el.overflow)[1],a=(0,r.getSize)(t)[1];if(e<=o&&e+a>=o+this.api.data.viewportHeight||e>=o&&e+a<=o+this.api.data.viewportHeight)(0,s.isFunction)(_)&&(i?setTimeout(_.bind(this.api),0):_(this.api));else if(a>this.api.data.viewportHeight||e<o)this.scrollTop(!1,e-o+this.api.data.scrollTop-(this.options.shadows?(0,r.getSize)(this.el.shadowTop)[1]:0),i,_);else{const t=this.options.shadows?(0,r.getSize)(this.el.shadowBottom)[1]:0;this.scrollTop(!1,e-o+this.api.data.scrollTop+a-this.api.data.viewportHeight+t,i,_)}}return this.api}update(e){let t,i;this.el.container&&!this.el.container.updateScroll&&(this.el.container.updateScroll=this.update.bind(this,!1));const _=this.el.outer.scrollTop;if(this.inited&&!this.disabled&&(e&&(t=this.el.inner.offsetHeight,this.api.data.viewportHeight!==(this.api.data.viewportHeight=this.el.overflow.offsetHeight)||this.api.data.scrollHeight!==t)||this.api.data.scrollTop!==_)){if(e&&(this.api.data.scrollHeight=t),this.api.data.scrollTop=Math.max(0,Math.min(this.api.data.scrollHeight-this.api.data.viewportHeight,Math.max(0,_))),this.api.data.scrollBottom=Math.max(0,this.api.data.scrollHeight-this.api.data.scrollTop-this.api.data.viewportHeight),!this.options.native){if(t=Math.max(this.options.minContentHeight,this.api.data.scrollHeight),i=t<=this.api.data.viewportHeight,!i){const i=this.el.barOuter.offsetHeight;(e||this.barOuterHeight!==i)&&(this.barOuterHeight=i,this.barInnerHeight=Math.max(this.options.barMinHeight,this.barOuterHeight*this.api.data.viewportHeight/t),this.el.barInner.style.height=this.barInnerHeight+"px"),(0,l.nextFrame)((()=>{const e=(this.barOuterHeight-this.barInnerHeight)*this.api.data.scrollTop/(t-this.api.data.viewportHeight);this.el.barInner.style.transform=`translateY(${e}px)`}))}this.options.shadows&&(this.shadowTop!=(this.api.data.scrollTop&&!i)&&(0,r.toggleClass)(this.el.container,"ui_scroll_shadow_top_visible",this.shadowTop=this.api.data.scrollTop&&!i),this.shadowBottom!=(this.api.data.scrollBottom&&!i)&&(0,r.toggleClass)(this.el.container,"ui_scroll_shadow_bottom_visible",this.shadowBottom=this.api.data.scrollBottom&&!i)),this.unnecessary!==i&&((0,r.toggleClass)(this.el.container,"ui_scroll_unnecessary",i),this.unnecessary=i,this.options.stopScrollPropagation&&this.fixBlocker(),i&&this.barInnerHeight&&this.barOuterHeight&&(0,l.nextFrame)(function(e){this.el.barInner.style.height=100*this.barInnerHeight/this.barOuterHeight+"%";const i=(this.barOuterHeight-this.barInnerHeight)*this.api.data.scrollTop/(t-this.api.data.viewportHeight)*100/this.barInnerHeight;this.el.barInner.style.transform=`translateY(${i}%)`}.bind(this)))}return this.emitEvent("update"),(!this.options.reversed||_>=0)&&this.more(),!0}return!1}more(){const e=this.options.reversed?this.api.data.scrollTop:this.api.data.scrollBottom,t=null!==this.options.onmoreThreshold?this.options.onmoreThreshold:2*this.api.data.viewportHeight;!this.noMore&&e<=t&&this.emitEvent("more")}constructor(e,t){if(!(e=(0,l.getScrollElement)(e)))throw new Error("uiScroll container is undefined");e.__uiScroll__&&e.__uiScroll__.destroy(),this.options=(0,s.extend)({global:!1,native:!1,theme:"default",reversed:!1,autoresize:!0,preserveEdgeBelow:!1,barMinHeight:30,preserveEdgeBelowThreshold:20,stopScrollPropagation:!0,stopScrollPropagationAlways:!1,minContentHeight:0,onmoreThreshold:null,hidden:!1,shadows:!1,scrollElements:[],onresize:null,onscroll:null,onscrollstart:null,onscrollstop:null,ondrag:null,ondragstart:null,ondragstop:null,onupdate:null,onmore:null,noForceReFlow:!1},t),this.options.native&&(this.options.shadows=!1),_.browser.mobile&&(this.options.stopScrollPropagation=!1),(0,o.isArray)(this.options.scrollElements)||(this.options.scrollElements=[]),this.removeEvents=[],this.removeElements=[],this.dragging=!1,this.dragged=!1,this.released=!0,this.noMore=!1,this.dragY=null,this.dragScroll=null,this.shadowTop=!1,this.shadowBottom=!1,this.unnecessary=!1,this.disabled=!1,this.stopped=!0,this.stoppedTimeout=null,this.fixSizeDefault=null,this.animation=null,this.barOuterHeight=null,this.barInnerHeight=null,this.currentFrame=null,this.blockerScrollTop=500,this.emitter=new EventEmitter,(0,s.isFunction)(this.options.onresize)&&this.emitter.addListener("resize",this.options.onresize),(0,s.isFunction)(this.options.onscroll)&&this.emitter.addListener("scroll",this.options.onscroll),(0,s.isFunction)(this.options.onscrollstart)&&this.emitter.addListener("scrollstart",this.options.onscrollstart),(0,s.isFunction)(this.options.onscrollstop)&&this.emitter.addListener("scrollstop",this.options.onscrollstop),(0,s.isFunction)(this.options.ondrag)&&this.emitter.addListener("drag",this.options.ondrag),(0,s.isFunction)(this.options.ondragstart)&&this.emitter.addListener("dragstart",this.options.ondragstart),(0,s.isFunction)(this.options.ondragstop)&&this.emitter.addListener("dragstop",this.options.ondragstop),(0,s.isFunction)(this.options.onupdate)&&this.emitter.addListener("update",this.options.onupdate),(0,s.isFunction)(this.options.onmore)&&this.emitter.addListener("more",this.options.onmore),this.el={container:e,overflow:(0,r.ce)("div",{className:"ui_scroll_overflow"}),outer:(0,r.ce)("div",{className:"ui_scroll_outer"},{margin:this.options.stopScrollPropagation?this.blockerScrollTop+"px 0":void 0}),inner:(0,r.ce)("div",{className:"ui_scroll_inner tt_noappend"}),shadowTop:(0,r.ce)("div",{className:"ui_scroll_shadow_top"}),shadowBottom:(0,r.ce)("div",{className:"ui_scroll_shadow_bottom"}),content:(0,r.ce)("div",{className:"ui_scroll_content clear_fix"}),barContainer:(0,r.ce)("div",{className:"ui_scroll_bar_container"}),barOuter:(0,r.ce)("div",{className:"ui_scroll_bar_outer"}),barInner:(0,r.ce)("div",{className:"ui_scroll_bar_inner"})},(0,r.data)(this.el.container,"ui-scroll",this);const i=(0,r.cf)(),n=["ui_scroll_container"];for((0,s.each)((0,o.isArray)(this.options.theme)?this.options.theme:(0,s.trim)(this.options.theme+"").split(/\s+/),(function(e,t){t&&n.push("ui_scroll_"+t+"_theme")})),(0,r.addClass)(this.el.container,n.join(" ")),this.options.hidden&&(0,r.addClass)(this.el.container,"ui_scroll_hidden");this.el.container.firstChild;)this.el.content.appendChild(this.el.container.firstChild);if(this.el.outer.appendChild(this.el.inner),this.el.inner.appendChild(this.el.content),this.options.stopScrollPropagation?(this.el.blocker=(0,r.ce)("div",{className:"ui_scroll_blocker"}),this.addEvent(this.el.blocker,"scroll",this.fixBlocker.bind(this),!0),this.el.blocker.appendChild(this.el.outer),this.el.overflow.appendChild(this.el.blocker)):this.el.overflow.appendChild(this.el.outer),i.appendChild(this.el.overflow),this.options.native?(0,r.addClass)(this.el.container,"ui_scroll_native"):(this.el.barOuter.appendChild(this.el.barInner),this.el.barContainer.appendChild(this.el.barOuter),i.appendChild(this.el.barContainer),this.options.shadows&&(this.el.overflow.appendChild(this.el.shadowTop),this.el.overflow.appendChild(this.el.shadowBottom)),_.browser.mobile||this.options.scrollElements.push(this.el.barContainer)),this.options.autoresize){const e=(0,l.addResizeSensor)(this.el.inner,this.resize.bind(this,!0)),t=(0,l.addResizeSensor)(this.el.overflow,this.resize.bind(this,!1));this.removeElements.push(e[0]),this.removeElements.push(t[0]),this.startResizeListening=function(){e[1](),t[1]()}}this.removeElements.push(this.el.overflow,this.el.barContainer),this.el.container.appendChild(i),this.options.reversed&&(this.el.outer.scrollTop=this.el.outer.scrollHeight),this.el.container.__uiScroll__=this.api={container:this.el.container,scroller:this.el.outer,content:this.el.content,emitter:this.emitter,ondragstart:this.dragstart.bind(this),ondragstop:this.dragstop.bind(this),ondrag:this.drag.bind(this),destroy:this.destroy.bind(this),disable:this.disable.bind(this,!0),enable:this.disable.bind(this,!1),scrollTop:this.scrollTop.bind(this,!0),scrollBottom:this.scrollBottom.bind(this,!0),scrollBy:this.scrollBy.bind(this),scrollIntoView:this.scrollIntoView.bind(this,!0),update:this.init.bind(this),updateAbove:this.updateAbove.bind(this),updateBelow:this.updateBelow.bind(this),data:{scrollTop:null,scrollBottom:null,scrollHeight:null,viewportHeight:null}},this.init();const c="onwheel"in this.el.outer?"wheel":void 0!==document.onmousewheel?"mousewheel":_.browser.mozilla?"MozMousePixelScroll":"DOMMouseScroll";return this.addEvent(this.el.container,c,function(e){this.animation&&this.animation.stop(),!this.disabled&&this.options.stopScrollPropagation&&(this.unnecessary?this.options.stopScrollPropagationAlways&&(0,a.cancelEvent)(e):this.isScrollEventUnused(e)?(0,a.cancelEvent)(e):(0,a.stopEvent)(e))}.bind(this),!this.options.stopScrollPropagation),this.options.native||this.addEvent(this.el.barContainer,"mousedown",this.dragstart.bind(this)),(0,s.each)(this.options.scrollElements,function(e,t){this.addEvent(t,c,function(e){this.disabled||this.unnecessary||(this.scrollBy(d.scrollEventDelta(e)),!this.options.stopScrollPropagation&&this.isScrollEventUnused(e)||(0,a.cancelEvent)(e))}.bind(this))}.bind(this)),this.options.reversed&&this.addEvent(this.el.container,"mousedown touchstart pointerdown",function(e){this.released=!1,this.noMore=!0;const t=this.addEvent(document,"mouseup contextmenu touchend pointerup",function(e){(0,a.removeEvent)(document,"mouseup contextmenu touchend pointerup",t),this.released=!0,this.noMore&&this.stopped&&!this.dragging&&(this.noMore=!1,this.more())}.bind(this))}.bind(this)),this.addEvent(this.el.outer,"scroll",function(){this.update()&&(this.stopped?(this.stopped=!1,this.emitEvent("scrollstart")):this.options.native||!1!==this.stopped||(this.stopped=0,(0,r.addClass)(this.el.container,"ui_scroll_scrolled")),this.emitEvent("scroll"),this.stoppedTimeout&&clearTimeout(this.stoppedTimeout),this.stoppedTimeout=setTimeout(function(){this.stopped||(this.stopped=!0,this.options.native||(0,r.removeClass)(this.el.container,"ui_scroll_scrolled"),this.emitEvent("scrollstop"),this.noMore&&this.released&&!this.dragging&&(this.noMore=!1,this.more()))}.bind(this),200))}.bind(this)),this.api}}d.addResizeSensor=l.addResizeSensor},72995:(e,t,i)=>{i.d(t,{addResizeSensor:()=>c,getScrollElement:()=>d,nextFrame:()=>l});var _=i(91691),o=i(51998),s=i(39565);let r;const a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||(e=>setTimeout(e,1)),n=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout;function l(e){r&&n(r),r=a(e)}function d(e){return(0,_.isString)(e)&&"_"===e[0]?(0,o.geByClass1)(e):(0,o.ge)(e)}function c(e,t){if((e=d(e))&&(0,_.isFunction)(t)){if(s.browser.msie9||s.browser.opera&&s.browser.version<13){let i=!1,r=!1;const a=(0,o.ce)("object",{type:"text/html",className:"ui_scroll_resize_object",data:"about:blank",onload:function(){r=!0,i&&n()}});function n(){if(!a.contentDocument)return setTimeout(n,100);a.contentDocument.defaultView.removeEventListener("resize",t),a.contentDocument.defaultView.addEventListener("resize",t),t()}return e.appendChild(a),e.__resizeSensor__=[a,function(){i=!0,r&&n()}]}{const l=(0,o.ce)("div",{className:"ui_scroll_resize_sensor"}),c=(0,o.ce)("div",{className:"ui_scroll_resize_sensor ui_scroll_resize_expand"}),p=(0,o.ce)("div",{className:"ui_scroll_resize_sensor ui_scroll_resize_shrink"}),u=(0,o.ce)("div"),h=(0,o.ce)("div");let m=null;return c.appendChild(u),p.appendChild(h),l.appendChild(c),l.appendChild(p),e.appendChild(l),e.__resizeSensor__=[l,c.onscroll=p.onscroll=function(){const i=(e.offsetWidth||1e4)+10,_=(e.offsetHeight||1e4)+10;u.style.width=i+"px",u.style.height=_+"px",c.scrollLeft=i,c.scrollTop=_,p.scrollLeft=i,p.scrollTop=_,m!==(m=i+" "+_)&&t()}]}}}},63349:(e,t,i)=>{i.d(t,{createFriendsAddFx:()=>o,createFriendsDeleteFx:()=>s});var _=i(8536);const o=e=>(0,_.createApiEffect)("friends.add",e),s=e=>(0,_.createApiEffect)("friends.delete",e)},46118:(e,t,i)=>{i.d(t,{createGroupsGetByIdFx:()=>o,createGroupsJoinFx:()=>s,createGroupsLeaveFx:()=>r});var _=i(8536);const o=e=>(0,_.createApiEffect)("groups.getById",e),s=e=>(0,_.createApiEffect)("groups.join",e),r=e=>(0,_.createApiEffect)("groups.leave",e)},83376:(e,t,i)=>{i.d(t,{formatCount:()=>_});const _=(e,t)=>{const i=t?.separator||".",_=t?.maximumFractionDigits??1,o=t?.roundingMode||void 0,s=t?.kLimit||1e3,r=t?.mLimit||1e6,a=t?.bLimit||1e9,n=window.langConfig?.locale||"ru",l=(e,t)=>{"floor"===o&&(e=Math.floor(e*Math.pow(10,_))/Math.pow(10,_));let s=e.toFixed(_);return Number(s).toLocaleString(n).replace(/\./,i)+t};if(e>-s&&e<s)return e.toLocaleString(n);const d=e/a;if(d>=1||d<=-1)return l(e/1e9,"B");const c=e/r;if(c>=1||c<=-1)return l(e/1e6,"M");const p=e/s;return p>=1||p<=-1?l(e/1e3,"K"):String(e)}},99740:(e,t,i)=>{i.d(t,{getOwnerFullName:()=>a,getOwnerHref:()=>r,getOwnerShortName:()=>n,isOwnerGroup:()=>s,isOwnerUser:()=>o});var _=i(10170);const o=e=>!!e&&"first_name"in e,s=e=>!!e&&"name"in e;function r(e,t=!1){let i="/";return e&&(s(e)?i+=e.screen_name||`club${e.id}`:i+=e.screen_name||e.domain||`id${e.id}`),t?window.location.origin+i:i}function a(e){let t="";return e?(e.first_name&&(t+=e.first_name.trim()),e.last_name&&(t+=` ${e.last_name.trim()}`),e.maiden_name&&e.sex===_.BaseSexEnumNames.FEMALE&&(t+=` (${e.maiden_name.trim()})`),t):t}function n(e){let t="";return e.first_name&&(t+=e.first_name.trim()),e.last_name&&(t+=` ${e.last_name.trim().slice(0,1)}.`),t}},10170:(e,t,i)=>{i.d(t,{BaseSexEnumNames:()=>_});const _={UNKNOWN:0,FEMALE:1,MALE:2}},94768:(e,t,i)=>{i.d(t,{FriendsFriendStatusStatusEnumNames:()=>_});const _={NOT_A_FRIEND:0,OUTCOMING_REQUEST:1,INCOMING_REQUEST:2,IS_FRIEND:3}},91959:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{var _shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(25324),_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(94468),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(46040),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(39565),_web_lib_video__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(21477),_web_lib_ui__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(82086),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(47733),_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(14581),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(33763),_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(77004),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(45643),_web_lib_fx__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(63330),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(11440),_web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(5241),_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(51998),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(91691),_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(15220),_web_evbus__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(92322),_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(59926),_shared_ranges__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(4884);(0,_web_evbus__WEBPACK_IMPORTED_MODULE_17__.init)(),window.WComments={init(e){e.reply_names&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.isArray)(e.reply_names)&&(e.reply_names={}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(cur,{options:e,oid:e.user_id,postTo:e.user_id,heightEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_page"),countEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_count"),contentEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_content"),section:e.section,noAwayCheck:!0,sendPostBtn:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("send_post"),postsEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("wcomments_posts"),postsOuterEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_posts_outer"),wallType:"widget_comments",onReplyFormSizeUpdate:WComments.contentUpdated.bind(WComments,!1),onEditFormSizeUpdate:WComments.contentUpdated.bind(WComments,!1)}),cur.options.filter_media_types=cur.options.media_types||[],this.override("lite.js"),this.override(window.jsc("web/page.js")),this.override(window.jsc("web/emoji.js")),window.stManager.emitter.addListener("update",this.override.bind(this)),this.updateSize(),(e.is_auto||e.is_nano)&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(e,{media_opts:{hideAfterCount:0,maxShown:0}}),Wall.init(e),e.fixed_height?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.setStyle)(cur.postsOuterEl,{maxHeight:e.fixed_height-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_head"))[1]-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_form"))[1]}),cur.scrollbar=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_13__.UiScroll(cur.postsOuterEl,{hidden:1,onmore:this.showMore.bind(this),ondragstart:function(){cur.Rpc.callMethod("startDrag")},ondragstop:function(){cur.Rpc.callMethod("stopDrag")}}),cur.mouseMove=cur.scrollbar.ondrag.bind(cur.scrollbar),cur.mouseUp=cur.scrollbar.ondragstop.bind(cur.scrollbar)):(cur.mouseMove=function(){},cur.mouseUp=function(){}),e.qtransport&&this.initQTransport(e.qtransport),window.timeUpdateInt=setInterval(this.updateTimes.bind(this),1e4),cur.RpcMethods={onInit:function(){let e=this.resizeWidget.bind(this);setTimeout(e,0),setTimeout(e,500)}.bind(this),updateStickers:function(){window.emojiStickers=!1,window.Emoji&&Emoji.updateTabs()},mouseMove:cur.mouseMove,mouseUp:cur.mouseUp,chooseMedia:function(){let e=cleanObj(this.uncleanObj([].slice.call(arguments)));cur.chooseMedia.apply(cur.chooseMedia,e),setTimeout(this.resizeWidget.bind(this),0)}.bind(this),addMedia:function(e,t,...i){~["pollBackgroundUploaded"].indexOf(t)&&cur.addMedia&&cur.addMedia[e]&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(cur.addMedia[e][t])&&cur.addMedia[e][t].apply(cur.addMedia[e],i)},showMediaProgress:function(){let e=cleanObj([].slice.call(arguments));cur.showMediaProgress.apply(cur.showMediaProgress,e)},likeFullUpdate:function(){}};try{cur.Rpc=new fastXDM.Client(cur.RpcMethods,{safe:!0,sameOrigin:!0,unsafeMethods:["mouseMove","mouseUp"]}),cur.resizeInt=setInterval(this.resizeWidget.bind(this),1e3)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_6__.debugLog)(e)}_shared_ranges__WEBPACK_IMPORTED_MODULE_19__.Ranges.isUserId(e.user_id)||((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_12__.addEvent)("send_post","click",Widgets.oauth.bind(Widgets)),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_12__.addEvent)("post_field","click",Widgets.oauth.bind(Widgets)))},uncleanObj:function(e){let t;if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.isObject)(e)){t={};for(let i in e)t[i.replace(/[^a-zA-Z0-9_\-]/g,"")]=this.uncleanObj(e[i])}else if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.isArray)(e))t=[],e.forEach((e=>{t.push(this.uncleanObj(e))}));else{let i=typeof e;t="number"==i||"boolean"==i||"function"==i?e:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.unclean)(e)}return t},getSectionParams:function(){let e={app:cur.options.app,width:cur.options.width,startWidth:cur.options.startWidth,limit:cur.options.limit};switch(cur.section){case"admin_browse":e.act="admin_browse";break;case"admin_bl":e.act="admin_bl",e.limit=15;break;case"admin_updates":e.act="admin_updates";break;case"browse":e.browse=1,e.replies=cur.options.replies;break;default:e.page_query=cur.options.page_query,e.part=1}return e},contentUpdated:function(e){e&&this.applyOptions(e),this.resizeWidget()},applyOptions:function(options){if(options.reply_names&&((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.isArray)(options.reply_names)&&(options.reply_names={}),cur.options.reply_names=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(cur.options.reply_names||{},options.reply_names),delete options.reply_names),options.head_count&&"browse"!=cur.section&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_count"),options.head_count),delete options.head_count),options.script)try{eval(options.script),delete options.script}catch(e){(0,_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_18__.logEvalError)(e,options.script)}(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(cur.options,options),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.toggle)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_more"),options.offset<options.count)},updateSize:function e(t){let i=(t||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.getSize)("page_wrap"))[0];if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.setStyle)(cur.heightEl,{width:i}),cur.options.is_auto){let t=1==cur.options.mini||0!=cur.options.mini&&i<630,_=t&&i<380;e.size!=t+""+_&&(e.size=t+""+_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(document.body,"wcomments_mini"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(document.body,"wcomments_nano"),t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(document.body,"wcomments_mini"),_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(document.body,"wcomments_nano"))}},resizeWidget:function e(){if(!cur.heightEl||!cur.Rpc)return;let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.getSize)("page_wrap");(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_3__.browser.msie&&!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_3__.browser.msie8||_shared_lib_browser__WEBPACK_IMPORTED_MODULE_3__.browser.opera)&&(t[1]+=15),window.onBodyResize&&onBodyResize(),e.size!=t.join(" ")&&(e.size=t.join(" "),this.updateSize(t),cur.Rpc.callMethod("resize",t[1]))},showMore:function(){if(cur.switchingSection)return;let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_more");if(cur.options.offset>=cur.options.count)return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(e);buttonLocked(e)||ajax.post("al_widget_comments.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(WComments.getSectionParams(),{offset:cur.options.offset,width:cur.options.width,startWidth:cur.options.startWidth,part:1}),{onDone:function(e,t){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("wcomments_posts").appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.cf)(t)),WComments.contentUpdated(e)},showProgress:lockButton.pbind(e),hideProgress:unlockButton.pbind(e)})},switchSection:function(e){if(cur.switchingSection||cur.section==e)return!1;cur.switchingSection=!0;let t=uiTabs&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_admin_tabs"),i=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_"+e);return"posts"==e||"posts"==cur.section?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(cur.contentEl,"wcomments_content_loading"):t&&uiTabs.showProgress(t),i&&uiTabs.switchTab((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("ui_tab",i)),cur.section=e,ajax.post("al_widget_comments.php",WComments.getSectionParams(),{onDone:function(i,_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.val)(cur.postsEl,_),t&&uiTabs.hideProgress(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(cur.contentEl,"wcomments_content_loading"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(cur.heightEl,"wcomments_section_posts"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(cur.heightEl,"wcomments_section_admin_browse"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(cur.heightEl,"wcomments_section_admin_bl"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(cur.heightEl,"wcomments_section_admin_updates"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(cur.heightEl,"wcomments_section_browse"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(cur.heightEl,"wcomments_section_"+e),cur.options.fixed_height&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.setStyle)(cur.postsOuterEl,{maxHeight:cur.options.fixed_height-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_head"))[1]-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.getSize)("posts"==cur.section||"browse"==cur.section?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_form"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_admin_tabs"))[1]}),cur.scrollbar&&cur.scrollbar.scrollTop(),WComments.contentUpdated(i),cur.switchingSection=!1}}),!1},addToBl:function(e,t,i){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(i,"wcomments_bl_action_loading"))return!1;ajax.post("al_widget_comments.php",{act:"a_add_to_bl",id:e,hash:t,app:cur.options.app},{onDone:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_bl_label_"+e)),i.onclick=WComments.delFromBl.bind(WComments,e,t,i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.val)(i,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_8__.getLang)("widgets_remove_from_banlist"))},showProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass.pbind(i,"wcomments_bl_action_loading"),hideProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass.pbind(i,"wcomments_bl_action_loading")})},delFromBl:function(e,t,i){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(i,"wcomments_bl_action_loading"))return!1;ajax.post("al_widget_comments.php",{act:"a_del_from_bl",id:e,hash:t,app:cur.options.app},{onDone:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.setStyle)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_wcomments_bl_label_"+e),"display","inline"),i.onclick=WComments.addToBl.bind(WComments,e,t,i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.val)(i,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_8__.getLang)("widgets_restore_to_banlist"))},showProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass.pbind(i,"wcomments_bl_action_loading"),hideProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass.pbind(i,"wcomments_bl_action_loading")})},updateTimes:function(e){if(!(cur.lang||{}).wall_X_seconds_ago_words)return;let t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.vkNow)()/1e3),i=[];t-=cur.tsDiff,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass)("rel_date_needs_update",e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("wcomments_posts"),"span"),(function(e,_){if(!_)return;let o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(_.getAttribute("time")),s=t-o,r=_.getAttribute("abs_time");s<5?r=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_8__.getLang)("profile_status_word_secs_ago",1):s<60?r=Wall.langWordNumeric(s,cur.lang.wall_X_seconds_ago_words,cur.lang.wall_X_seconds_ago):s<3600?r=Wall.langWordNumeric((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(s/60),cur.lang.wall_X_minutes_ago_words,cur.lang.wall_X_minutes_ago):s<14400?r=Wall.langWordNumeric((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(s/3600),cur.lang.wall_X_hours_ago_words,cur.lang.wall_X_hours_ago):i.push(_),_.innerHTML=r})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(i,(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(this,"rel_date_needs_update")}))},langWordNumeric:function(e,t,i){return(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.isArray)(t)&&e<t.length?t[e]:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_8__.langNumeric)(e,i)},showLikesBox:function(e,t){showBox("widget_like.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({act:"a_stats_box",app:cur.options.app,obj:e,from:"wcomments",check_hash:cur.likeCheckHash,widget_width:638},t||{}))},deleteAllAndBan:function(e,t,i,_){ajax.post("al_widget_comments.php",{act:"a_add_to_bl",id:t,hash:i,app:cur.options.app},{onDone(i,_){_&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass)("wcomments_post",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("wcomments_posts"),"div"),(function(){!this.id.indexOf("post"+t)&&this.id.split("_")[1]>=_&&this.id!="post"+e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.isVisible)(this)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(this)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("post_del"+e).innerHTML=i,WComments.contentUpdated()},showProgress:()=>{lockButton(_)},hideProgress:()=>{unlockButton(_)}})},initQTransport:function(e){window.curNotifier=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(e,{lp_connected:!1,error_timeout:1,addQueues:{},recvClbks:{},recvData:{},onConnectionId:[]}),WComments.lpInit(),WComments.lpStart()},lpGetTransportWrap(){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("queue_transport_wrap");return e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ce)("div",{id:"queue_transport_wrap"}),utilsNode.appendChild(e)),e},lpInit:function(){curNotifier.lpMakeRequest||(delete curNotifier.lpMakeRequest,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.re)("queue_transport_frame"),WComments.lpGetTransportWrap().appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ce)("iframe",{id:"queue_transport_frame",name:"queue_transport_frame",src:curNotifier.frame_path})))},lpStart:function(){curNotifier.lp_started=!0,WComments.lpCheck()},lpStop(){curNotifier.lp_started=!1,clearTimeout(curNotifier.lp_check_to),clearTimeout(curNotifier.lp_error_to)},lpCheck(){curNotifier.lp_started&&(curNotifier.lpMakeRequest?curNotifier.lpMakeRequest(curNotifier.frame_url,{act:"a_check",ts:curNotifier.timestamp,key:curNotifier.key,id:curNotifier.uid,wait:25},(text=>{if(curNotifier.lp_started)try{let success=this.lpChecked(eval("("+text+")"));success&&(this.lpCheck(),curNotifier.error_timeout=1)}catch(e){(0,_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_7__.topError)("Notify error: "+e.message),curNotifier.lp_error_to=setTimeout(this.lpCheck.bind(this),1e3*curNotifier.error_timeout),curNotifier.error_timeout<64&&(curNotifier.error_timeout*=2)}}),(()=>{curNotifier.lp_error_to=setTimeout(this.lpCheck.bind(this),1e3*curNotifier.error_timeout),curNotifier.error_timeout<64&&(curNotifier.error_timeout*=2)})):curNotifier.lp_check_to=setTimeout(this.lpCheck.bind(this),1e3))},lpChecked:function(e){let t=e.failed;if(2==t)return curNotifier.lp_error_to=setTimeout(this.lpGetKey.bind(this),1e3*curNotifier.error_timeout),curNotifier.error_timeout<64&&(curNotifier.error_timeout*=2),!1;if(t)throw new Error((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_8__.getLang)("global_unknown_error"));return curNotifier.timestamp=e.ts,!cur.section.indexOf("admin")||(cur.saveScrollPosition=cur.scrollbar&&cur.scrollbar.data.scrollTop>100,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(e.events,(function(e,t){WComments.eventsParse(t)})),!0)},lpGetKey:function(){ajax.post("al_widget_comments.php",{act:"a_get_key",id:curNotifier.uid,app:cur.options.app,page_query:cur.options.page_query},{onDone:function(e,t){curNotifier.timestamp=t,curNotifier.key=e,this.lpCheck()}.bind(this),onFail:function(e){if(3!=e)return curNotifier.error_timeout=64,this.lp_error_to=setTimeout(this.lpGetKey.bind(this),1e3*curNotifier.error_timeout),curNotifier.error_timeout<64&&(curNotifier.error_timeout*=2),!0;location.reload()}.bind(this)})},resizePostSizedThumbs:function(e,t,i,_,o){let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass)("page_post_thumb_wrap",e),r=[],a=0,n=0;const l=function(){a=n=0,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(this,{tiles:[],height:0,x:0,y:0}),r.push(this)};let d=function(e){e&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(this,{el:e,lastRow:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(e,"page_post_thumb_last_row"),lastColumn:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(e,"page_post_thumb_last_column"),width:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e.style.width),height:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e.style.height)})},c=new l,p=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.positive)(e.style.width),u=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.positive)(e.style.height),h=0;if(t>p&&(t=null),(_>u||o&&s.length>1)&&(_=null),!_&&t)_=Math.round(u*(t/p));else if(_&&!t)t=Math.round(p*(_/u));else{if(!t||!_)return;o&&(_=Math.min(_,Math.round(u*(t/p))),t=Math.round(p*(_/u)))}return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(s,(function(e,t){let _=t.tile||new d(t),o=new d(s[e+1]);c.height=Math.max(c.height,_.height),p-a>=_.width/2?(a+=_.width+(_.lastColumn?0:i),n=_.height,_.x=c.x,_.y=c.y=0,c.tiles.push(_),_.lastColumn?o&&o.lastColumn&&c.height-n>=o.height/2||(c=new l):c.x++):_.lastColumn&&c.height-n>=_.height/2&&(n+=_.height+i,_.x=c.x,_.y=++c.y,c.tiles.push(_),!_.lastRow&&o&&o.lastColumn&&c.height-n>=o.height/2||(c.height=Math.max(c.height,n),c=new l))})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(r,(function(e,o){let s=0,a=0,n=(t-i*o.x)/(p-i*o.x),l=(_-i*o.y)/(u-i*o.y),d=r.length-1==e?_-h:Math.round(o.height*l),c=0,m=0;h+=d+i,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(o.tiles,(function(e,_){_.x<o.x?(c=Math.round(_.width*n),s+=c+i,_.y||(m=d)):_.lastColumn&&(c=t-s,_.y==o.y?m=d-a:(m=Math.round(_.height*l),a+=m+i)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.setStyle)(_.el,{width:c,height:m})}))})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.setStyle)(e,{width:t,height:_}),[t,_]},resizePostAlbumWrap:function(e,t,i,_){_||(_="");let o=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.positive)(e.style.width),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("page"+_+"_album_thumb_wrap",e,"div"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("page"+_+"_album_photos",e,"div")),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("page"+_+"_album_under_row",e,"div"));if(scaleX=t/o,o<t)return;if(!s)return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.setStyle)(e,{width:t});let n=Math.round((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.positive)(s.style.width)*scaleX),l=Math.round((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.positive)(s.style.height)*scaleX);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.setStyle)(s,{width:n,height:l}),r&&WComments.resizePostSizedThumbs(r,t-i-n,i,l),a&&WComments.resizePostSizedThumbs(a,t,i,(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.positive)(a.style.height)*((t-i)/(o-i)))},resizePost(e,t){let i=t?cur.options.reply_max_w:cur.options.max_w,_=Math.max(cur.options.kludges_min_h,i*(t?cur.options.reply_kludges_ratio:cur.options.kludges_ratio));return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass)("page_album_wrap",e,"div"),(function(e,t){WComments.resizePostAlbumWrap(t,i,5)})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass)("page_market_album_wrap",e,"div"),(function(e,t){WComments.resizePostAlbumWrap(t,i-2,2,"_market")})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass)("page_post_sized_thumbs",e,"div"),(function(e,t){WComments.resizePostSizedThumbs(t,i,5,_,!0)})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass)("audio_pl_snippet",e,"div"),(function(e,t){let _;_=i<=cur.playlist_snippet_max_narrow_width?"audio_pl_snippet_size_narrow":i<=cur.playlist_snippet_max_medium_width?"audio_pl_snippet_size_medium":"",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.setStyle)(t,"width",i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(t,"audio_pl_snippet_size_narrow"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(t,"audio_pl_snippet_size_medium"),_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(t,_)})),e},eventsQueue:[],eventsPaused:!1,eventsPause:function(){this.eventsPaused=!0},eventsProceed:function(){for(this.eventsPaused=!1;this.eventsQueue.length;)this.eventsParse(this.eventsQueue.shift())},eventsUpdateAttaches:function(e){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass)("audio_row",e,"div"),(function(e,t){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(t,"audio_no_actions")}))},eventsParse:function(e){if(this.eventsPaused)return this.eventsQueue.push(e);if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.isObject)(e))return Wall.processQueueEvent(e);let t,i=e.split("<!>"),_=i[0],o=i[1],s=i[2],r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("post"+s);if(_!=cur.options.qversion)return location.reload();switch(o){case"new_post":if(r)break;let a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("wcomments_posts");function n(){a.insertBefore(t,a.firstChild),(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_1__.updateNarrativeSnippetsFromQueueByPost)(t),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_16__.updateArticleSnippetsFromQueueByPost)(t)}t=this.resizePost((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.se)(Wall.getNewPostHTML(i,cur.options.is_admin))),WComments.eventsUpdateAttaches(t),cur.saveScrollPosition?cur.scrollbar.updateAbove(n):(n(),cur.scrollbar&&cur.scrollbar.scrollTop(0,!0)),nodeUpdated(t),Wall.updateMentionsIndex(),"browse"!==cur.section&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.val)(cur.countEl,newCnt?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_8__.getLang)("widgets_comments_top_count",newCnt):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_8__.getLang)("widgets_comments"));break;case"del_post":r&&(!cur.wallMyDeleted[s]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(r),cur.options.offset--);break;case"res_post":r&&cur.options.offset++;break;case"new_reply":if(!r||cur.wallMyReplied[s]||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("post"+i[3]))break;let l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("replies"+s);t=this.resizePost((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.se)(Wall.getNewReplyHTML(i,cur.options.is_admin)),!0);let d=!1;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.isVisible)("reply_link"+s))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.re)("reply_link"+s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("replies_wrap"+s),d=!0;else{let c=l.nextSibling,p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass)("new_reply",l,"div").length+1;if(cur.wallMyOpened[s]){c&&"replies_open"==c.className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.re)(c),d=!0;let u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("wr_header",l,"a"),h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass)("reply",l,"div").length+1,m=h;u&&(m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(u.getAttribute("offs").split("/")[1])+1),(m>5||h<m)&&(u||(u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ce)("a",{className:"wr_header"}),l.insertBefore(u,l.firstChild)),Wall.updateRepliesHeader(s,u,h,m))}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(t,"new_reply"),c&&"replies_open"==c.className||(c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ce)("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(s),role:"button",tabIndex:0}),l.parentNode.insertBefore(c,l.nextSibling)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.val)(c,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_8__.getLang)("news_x_new_replies_more",Math.min(100,p))),c.newCnt=p}(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_1__.updateNarrativeSnippetsFromQueueByPost)(t),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_16__.updateArticleSnippetsFromQueueByPost)(t),WComments.eventsUpdateAttaches(t),l.appendChild(t),d&&nodeUpdated(t);break;case"del_reply":!cur.wallMyDeleted[s]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.re)(r)}this.resizeWidget()},override(e,t){const i=new RegExp(e.replace(/\.js$/,"\\.[0-9a-f]{8,20}\\.js$"));var _,o;if(Boolean(StaticFiles[e])||Object.keys(StaticFiles).some((function(e){return i.test(e)}))||!0===t)switch(e){case"lite.js":(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(window,{showTooltip:Widgets.showTooltip,showBox:Widgets.showBox({"al_photos.php":{photo_box:!0,choose_photo:!0},"al_video.php":{video_box:!0,a_choose_video_box:!0},"al_places.php":{show_photo_place:!0},"like.php":{publish_box:!0},"widget_like.php":{a_stats_box:!0},"al_wall.php":{canvas_draw_box:!0},"al_im.php":{stickers_store:!0,sticker_preview:!0},"al_audio.php":{choose_box:!0},"al_page.php":{owner_photo_box:!0},"al_voting.php":{export_box:!0},"docs.php":{show_box:!0}}),showReCaptchaBox:Widgets.showReCaptchaBox,gotSession(){location.reload()},showPhoto:Widgets.showPhoto,showVideo:Widgets.showVideo,shareAudioPlaylist:function(e){_shared_ranges__WEBPACK_IMPORTED_MODULE_19__.Ranges.isUserId(vk.id)?e.apply(null,[].slice.call(arguments,1)):Widgets.oauth()}.bind(null,shareAudioPlaylist),addAudio:function(e){_shared_ranges__WEBPACK_IMPORTED_MODULE_19__.Ranges.isUserId(vk.id)?e.apply(null,[].slice.call(arguments,1)):Widgets.oauth()}.bind(null,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_2__.AudioUtils.toggleAddAudio),showWiki:function(e){if("likes"==(e=(e&&e.w||"").split("/"))[0])WComments.showLikesBox(e[1]);else{if("shares"!=e[0])return!0;WComments.showLikesBox(e[1],{tab:"published"})}},mentionOver:function(){return!0},mentionClick:function(){return!0},showInlineVideo:Widgets.showInlineVideo,revertLastInlineVideo:Widgets.revertLastInlineVideo,pauseLastInlineVideo:Widgets.pauseLastInlineVideo});break;case window.jsc("web/emoji.js"):(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(Emoji,{focus:function(e,t){if(Emoji.editableFocus(e,!1,!0),t&&cur.scrollbar){let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.domCA)(e,".reply_box");t&&cur.scrollbar.scrollIntoView(t)}}});break;case window.jsc("web/page.js"):(cur.options.is_auto||cur.options.is_nano)&&(Composer.init=(o=Composer.init,function(){let e=[].slice.call(arguments);return e[1].media&&(e[1].media.options=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(e[1].media.options||{},{hideAfterCount:0,maxShown:0,forceToUp:1})),o.apply(Wall,e)})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(Wall,{scrollHighlightReply:function(e){(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)(e))&&(cur.options.fixed_height&&cur.scrollbar?cur.scrollbar.scrollIntoView(e,!0,Wall.highlightReply.bind(Wall,e)):(e.scrollIntoView(),Wall.highlightReply(e)))},postTooltip:(_=Wall.postTooltip,function(){let e=[].slice.call(arguments);return e[3]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(e[3]||{},{appendEl:cur.postsOuterEl}),_.apply(this,e)}),sendPost:function(){if(!cur.sendPostBtn)return;let e=cur.wallAddMedia||{},t=e.chosenMedia||{},i=cur.wallAddMedia?e.getMedias():[],_=e.shareData||{},o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)((window.Emoji?Emoji.editableVal:_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("post_field"))),s=cur.options.suggesting?"suggest":cur.wallType,r={act:"post",message:o,to_id:cur.postTo,type:s,status_export:"",widget_app:cur.options.app,widget_page_url:cur.options.page_url,widget_page_title:cur.options.page_title,widget_page_desc:cur.options.page_desc,widget_page_query:cur.options.page_query,hash:cur.options.post_hash},a=0;if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.isArray)(t)&&t.length&&i.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clone)(t)),i.length){let t=!1;if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(i,(function(i,s){if(!s)return;let n=this[0],l=this[1];switch(n){case"poll":let i=e.pollData();if(!i)return t=!0,!1;l=i.media,delete i.media,r=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(r,i);break;case"share":if(_.share_upload_failed)break;if(_.failed||!_.url||!_.title&&(!_.images||!_.images.length)&&!_.photo_url)return cur.shareLastParseSubmitted&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.vkNow)()-cur.shareLastParseSubmitted<2e3?(t=!0,!1):void 0;if(l=!_.noPhoto&&_shared_ranges__WEBPACK_IMPORTED_MODULE_19__.Ranges.isUserId(_.user_id)&&_.photo_id?_.user_id+"_"+_.photo_id:"",!l&&!_.share_own_image&&_.images&&_.images.length&&_.images.some((function(e){return(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.isString)(e)&&e.length})))return e.uploadShare(Wall.sendPost),t=!0,!1;_.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(o)==_.initialPattern&&(r.message=""),_.is_vk_mini_app&&(r.is_vk_mini_app=!0,r.is_photo_edit=_.isPhotoEdit,r.image_offset=cur.shareShowImg),r=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(r,{url:_.url,module:cur.module,title:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.replaceEntities)(_.title),description:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.replaceEntities)(_.description),extra:_.extra,extra_data:_.extraData,mode:_.mode,photo_url:_.noPhoto?"":(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.replaceEntities)(_.photo_url),open_graph_data:(_.openGraph||{}).data,open_graph_hash:(_.openGraph||{}).hash});break;case"page":_.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(o)==_.initialPattern&&(r.message="");break;case"postpone":let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.val)("postpone_date"+e.lnkId);return r=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(r,{postpone:s}),void(cur.postponedLastDate=s)}this[3]&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(o)==this[3]&&(r.message=""),r["attach"+(a+1)+"_type"]=n,r["attach"+(a+1)]=l,a++})),t)return}if(!a&&!o)return void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.elfocus)("post_field");let n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("send_post");n&&buttonLocked(n)||(cur.postAutosave&&clearTimeout(cur.postAutosave),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("submit_post_error"),cur.postSent=!0,setTimeout((function(){WComments.eventsPause(),ajax.post("al_wall.php",Wall.fixPostParams(r),{onDone:function(e){if(e){let t={act:"a_post",post:e,width:cur.options.width,startWidth:cur.options.startWidth,hash:cur.options.post_hash,app:cur.options.app,limit:cur.options.limit,export:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_5__.isChecked)("wcomments_export")};ajax.post("al_widget_comments.php",t,{onDone:function(e,t){"posts"==cur.section&&cur.Rpc&&cur.Rpc.callMethod("publish","widgets.comments.new_comment",e.count,e.last_comment,e.date,e.full_hash,e.pageId),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.val)("wcomments_posts",t),WComments.contentUpdated(e),Wall.updateMentionsIndex(),WComments.eventsProceed()},onFail(){WComments.eventsProceed()},showProgress(){lockButton((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("send_post"))},hideProgress(){Wall.clearInput(),cur.postSent=!1;let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("post_field");if(cur.withMentions){let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.data)(e,"mention");t&&(t.rtaEl.innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(t.cont),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)(e))}e.value="",e.blur(),e.phonblur(),Wall.hideEditPost(!0),cur.wallAddMedia&&cur.wallAddMedia.unchooseMedia(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("post_warn"),cur.onWallSendPost&&cur.onWallSendPost(),unlockButton((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("send_post"))}})}},onFail:function(e){return cur.postSent=!1,!e||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("submit_post_error").innerHTML=e.length>60?'<div class="msg_text">'+e+"</div>":e,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.isVisible)("submit_post_error")||(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_11__.slideDown)("submit_post_error",100),!0)},showProgress:function(){lockButton(n)},hideProgress:function(){unlockButton(n)}})}),0))},sendReply:function(e,t,i){if(i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({},i),window.mvcur&&mvcur.post==e)return Videoview.sendComment(e,t,i);let _,o,s=window.cur.wallLayer==e,r=s?wkcur:window.cur,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("reply_field"+e),n=a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.data)(a,"composer"),l=r.reply_to&&Wall.getReplyName(r.reply_to[0]),d=a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.data)(a,"send");if(d&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(d))return d(e,t,i);if(i.stickerId)o={message:"",attach1_type:"sticker",attach1:i.stickerId,sticker_referrer:i.sticker_referrer};else{if(o=n?Composer.getSendParams(n,Wall.sendReply.pbind(e)):{message:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(Emoji.editableVal(a))},o.delayed)return;if(!o.attach1_type&&(!o.message||(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_9__.isArray)(l)&&!l[1].indexOf(o.message)))return void Emoji.editableFocus((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("reply_field"+e),!1,!0);n?_=Composer.reset(n):window.Emoji&&Emoji.val(a,""),a.autosize&&a.autosize.update()}r.wallMyOpened=r.wallMyOpened||{},r.wallMyReplied[e]=1,r.wallMyOpened[e]=1;let c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("post_hash"+e)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("post_hash"+e).value:r.options.post_hash,p=null;if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(o,{act:"post",type:"widget",width:r.options.width,startWidth:r.options.startWidth,reply_to:e,reply_to_msg:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.val)("reply_to"+e),reply_to_user:r.reply_to&&r.reply_to[0]||0,start_id:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.val)("start_reply"+e),from:"widget",hash:c}),r.reverse&&(o.rev=1),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_3__.browser.mobile?Wall.hideEditReply(e):(Emoji.editableFocus(a,!1,!0),Wall.cancelReplyTo(e,t)),ajax.post("al_wall.php",Wall.fixPostParams(o),{onDone:function(t,i,_,o){if("full"==r.wallType)return FullWall.onReplySent.apply(window,arguments);r.wallMyReplied[e]=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.re)("reply_link"+e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)("reply_warn"+e),Wall._repliesLoaded(e,!1,i,_,o)},onFail:function(){p&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.re)(p),n?_=Composer.restore(n,_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.val)(a,o.message),a.autosize&&a.autosize.update()},showProgress:lockButton.pbind((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("reply_button"+e)),hideProgress:unlockButton.pbind((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("reply_button"+e))}),o.from_oid||!o.message)return;let u,h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("replies"+e),m=-++r.wallMyRepliesCnt,E=Emoji.emojiToHTML((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clean)(o.message),!0);u=_shared_ranges__WEBPACK_IMPORTED_MODULE_19__.Ranges.isGroupId(o.reply_to_user)?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_8__.getLang)("wall_replied_to_group"):_shared_ranges__WEBPACK_IMPORTED_MODULE_19__.Ranges.isUserId(o.reply_to_user)?r.options.reply_names[o.reply_to_user]&&r.options.reply_names[o.reply_to_user][0]:null;let b=u?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.rs)(r.wallTpl.reply_link_to,{to_user:u}):"";if(p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.rs)(r.wallTpl.reply_fast,{reply_id:"0_"+m,message:E.replace(/\n/g,"<br/>"),to_link:b,date:Wall.getNowRelTime(r)})),h&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.isVisible)(h)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("reply_link"+e))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.re)("reply_link"+e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)("replies_wrap"+e);else if(!r.onepost){let t=h.nextSibling;if(t&&"replies_open"==t.className&&Wall.openNewComments(e),!s){let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("wr_header",h,"a"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass)("reply",h,"div").length+1,_=i;t&&(_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(t.getAttribute("offs").split("/")[1])+1),(_>5||i<_)&&(t||h.insertBefore(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ce)("a",{className:"wr_header"}),h.firstChild),Wall.updateRepliesHeader(e,t,i,_))}}r.reverse?h.insertBefore(p,h.firstChild):h.appendChild(p)},deletePost:function(e,t,i,_,o){(cur.wallLayer?wkcur:cur).wallMyDeleted[t]=1;let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("post"+t),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("post_actions",s);ajax.post("al_wall.php",{act:"delete",post:t,hash:i,root:_?1:0,confirm:o?1:0,from:"widget"},{onDone:function(e,o,r){if(r){let o=showFastBox(e,r,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_8__.getLang)("global_delete"),(function(){o.hide(),wall.deletePost(t,i,_,1)}),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_8__.getLang)("box_cancel"));return}o&&"posts"==cur.section&&cur.Rpc&&cur.Rpc.callMethod("publish","widgets.comments.delete_comment",o.count,o.last_comment,o.date,o.full_hash,o.pageId);let a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_post_content",s)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("feedback_row_t",s);(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_4__.revertLastInlineVideo)(a);let n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("post_del"+t);n?(n.innerHTML='<span class="dld_inner">'+e+"</span>",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)(n)):s.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ce)("div",{id:"post_del"+t,className:"dld",innerHTML:'<span class="dld_inner">'+e+"</span>"})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(a),"post_publish"==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.domNS)(a).className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.domNS)(a)),"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(s,"reply")&&(cur.pgOffset--,cur.pgCount--,FullWall.repliesSummary(cur.pgCount)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(s,"suggest")?Wall.suggestUpdate(-1):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(s,"postponed")||"own"!=cur.wallType&&"all"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(s,"own")&&++cur.deletedCnts.own,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(s,"all")&&++cur.deletedCnts.all,Wall.update()),WComments.contentUpdated()},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(e,"ui_actions_menu_item")?lockActionsMenuItem(e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(e,"flat_button")?lockButton(e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.addClass)(r,"post_actions_progress")},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(e,"ui_actions_menu_item")?unlockActionsMenuItem(e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(e,"flat_button")?unlockButton(e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(r,"post_actions_progress")}});let a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("delete_post"+t);a&&a.tt&&a.tt.el&&a.tt.destroy()},restorePost:function(e,t,i){return(cur.wallLayer?wkcur:cur).wallMyDeleted[e]=0,ajax.post("al_wall.php",{act:"restore",post:e,hash:t,root:i?1:0,from:"widget"},{onDone:function(){let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("post_del"+e);if(!t)return;let i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("post"+e),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("_post_content",i)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("feedback_row_t",i);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)(_),"post_publish"==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.domNS)(_).className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.domNS)(_)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hide)(t),"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(i,"reply")&&(cur.pgOffset++,cur.pgCount++,FullWall.repliesSummary(cur.pgCount)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(i,"suggest")?Wall.suggestUpdate(1):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(i,"postponed")||"own"!=cur.wallType&&"all"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(i,"own")&&--cur.deletedCnts.own,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)(i,"all")&&--cur.deletedCnts.all,Wall.update()),WComments.contentUpdated()}}),!1},postClick:function(e,t,i){let _,o=(e||"").match(/^(-?\d+)_(wall)?(\d+)$/),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("post"+e);if(_=!(!i||!i.skipCheck)||Wall.checkPostClick(s,t),_){if(!0!==_){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.geByClass1)("wall_post_more",_,"a");if(e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.isVisible)(e))return e.onclick(),void(o||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.removeClass)(s,"wall_post_over"))}o&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("wcomments_posts"),"no_post_click")||window.open("wall"+o[1]+"_"+o[3],"_blank"))}},_repliesLoaded:function(e,t,i,_){let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("replies"+e);if(!o)return;t?(cur.options.fixed_height&&cur.scrollbar?cur.scrollbar.updateAbove((function(){o.innerHTML=i})):o.innerHTML=i,setTimeout(Wall.scrollHighlightReply.pbind("post"+t),0)):o.innerHTML=i;let s=o.nextSibling;s&&"replies_open"==s.className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.re)(s),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(cur.options.reply_names||{},_),Wall.updateMentionsIndex()},checkTextLen:function(){},checkPostLen:function(){},replySubmitTooltip:function(){},repliesSideSetup:function(){},repliesSideClick:function(){},likesShow:function(e,t,i){i=i||{};let _=wall.parsePostId(t),o=_.type,s=_.id,r=o+s,a=e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.gpeByClass)("_post_content",e)||wall.domPost(s),n=i.share?"_share_wrap":"_like_wrap",l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.domByClass)(a,n),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.domByClass)(l,"_icon"),c=a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.domByClass)(a,"_share_wrap");if(!d||cur.viewAsBox)return;let p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.getXY)(l)[0],u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.getXY)(d)[0]+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.getSize)(d,!0)[0]/2-p-56;(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_10__.showTooltip)(d.parentNode,{url:"/like.php",params:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({act:"a_get_stats",object:r,has_share:c?1:""},i.share?{published:1}:{}),slide:15,shift:[-u,-3],ajaxdt:100,showdt:400,hidedt:200,dir:"auto",checkLeft:!0,reverseOffset:80,appendEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_14__.ge)("page_wrap"),tip:{over:function(){Wall.likesShow(e,t,i)}},typeClass:"like_tt wcomments_like_tt",className:i.cl||""})},showReplies:function(e,t,i,_){if(!(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_12__.checkEvent)(_||window.event))return cur.viewAsBox?cur.viewAsBox():(cur.wallMyOpened[e]=3!=t,ajax.post("al_wall.php",{act:"get_replies",width:cur.options.width,startWidth:cur.options.startWidth,post:e,count:t,from:"widget"},{onDone:function(){let t=[].slice.call(arguments);t.unshift(e,i),Wall._repliesLoaded.apply(Wall,t),WComments.resizeWidget()},showProgress:lockButton.pbind("wrh"+e),hideProgress:unlockButton.pbind("wrh"+e)}),!1)}}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(["showEditReply","markAsSpam","stickerClick","likeIt"],(function(e,t){var i;Wall[t]=(i=Wall[t],function(){if(_shared_ranges__WEBPACK_IMPORTED_MODULE_19__.Ranges.isUserId(vk.id))return i.apply(Wall,[].slice.call(arguments));Widgets.oauth()})}))}}};try{window.stManager.done(window.jsc("api/widgets/comments.js"))}catch(e){}requestIdleCallback((()=>{try{(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_0__.statlogsValueEvent)("entries_requests",1,"comments","widgets")}catch{}}),{timeout:5e3})},67212:(e,t,i)=>{i.d(t,{apiAudioToAudioTuple:()=>n});var _=i(77004),o=i(8520),s=i(77166),r=i(98790);const a=new WeakMap,n=(e,{useCache:t=!1}={})=>{if(!e)return null;if(t){const t=a.get(e);if(t)return t}const i=[e.id,e.owner_id,e.url||"",(0,_.clean)(e.title),(0,_.clean)(e.artist||e.performer||""),e.duration,e.album_id||0,0,"",e.lyrics_id||0,0,"",l(e),(0,s.getAudioHashesString)({addHash:e.access_key,editHash:e.access_key,actionHash:e.access_key,deleteHash:e.access_key,replaceHash:e.access_key,urlHash:e.access_key,restoreHash:e.access_key}),e.album?.thumb?.sizes?(0,o.getPhotoSize)(e.album?.thumb?.sizes||[],(0,r.getImageMinWidth)(200))?.url||"":`${e.album?.thumb?.photo_300},${e.album?.thumb?.photo_135}`||"",e.ads||{},(0,_.clean)(e.subtitle||""),e.main_artists||"",e.featured_artists||"",!!e.album&&[e.album?.owner_id,e.album?.id,e.album?.access_key],e.track_code||"",e.content_restricted||0,e.album_part_number||0,!0,e.access_key||"",e.audio_chart_info||!1,e.release_audio_id||""];return t&&a.set(e,i),i};function l(e){return{dislike:e.dislike}}},61424:(e,t,i)=>{i.d(t,{AUDIO_PLAYER_ADAPTER_HASHES_SEPARATOR:()=>_});const _="/"},77166:(e,t,i)=>{i.d(t,{getAudioHashesString:()=>o});var _=i(61424);const o=({addHash:e,editHash:t,actionHash:i,deleteHash:o,replaceHash:s,urlHash:r,restoreHash:a})=>[e||"",t||"",i||"",o||"",s||"",r||"",a||""].join(_.AUDIO_PLAYER_ADAPTER_HASHES_SEPARATOR)},97905:(e,t,i)=>{i.d(t,{connectTrackTmrGroupsJoin:()=>n});var _=i(62935),o=(i(31498),i(32489)),s=i(48370);const r=()=>{(0,s.partConfigEnabled)("group_join_track_event_count")&&(0,_.tmrSendTimespentEvent)(_.MY_TRACKER_COUNT_EVENT_IDS.COMMUNITY_SUBSCRIBE)},a=(0,o.createEffect)({name:"fx/track_group_join",handler:r}),n=e=>(0,o.sample)({clock:e.done,target:a})},77871:(e,t,i)=>{i.d(t,{connectTrackTmrGroupsJoin:()=>_.connectTrackTmrGroupsJoin});var _=i(97905)},35356:(e,t,i)=>{i.d(t,{createCacheService:()=>o});var _=i(46867);const o=e=>{const t=(0,_.getEffectorServiceDomain)(e),i=Object.create(null),o=t.createStore(Object.create(null)),s=t.createEvent("add"),r=t.createEvent("delete");return o.on(s,((e,{key:t,data:i})=>(e[t]=i,e))).on(r,((e,t)=>(delete e[t],e))),{$cache:o,add:s,delete:r,get:e=>o.getState()[e]||null,isWaited:e=>void 0!==i[e],getWaited:e=>i[e],setWaited:(e,t)=>{i[e]=t},deleteWaited:e=>{delete i[e]}}}},3343:(e,t,i)=>{i.d(t,{createUserService:()=>_.createUserService});var _=i(48474);i(15412)},15412:(e,t,i)=>{i(32489),i(31498),i(4884);var _=i(35356);i(46867),i(99740);(0,_.createCacheService)()},48474:(e,t,i)=>{i.d(t,{createUserService:()=>s});var _=i(32489),o=i(31498);const s=({domain:e})=>{const t=(e,t)=>!(!e||e.id!==t.userId),i=e.createStore(null),s=e.createEffect((({params:e})=>(0,o.apiWithPrefetch)("users.get",e))),r=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,o.api)("wall.subscribe",e.params)}))),a=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,o.api)("wall.unsubscribe",e.params)}))),n=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,o.api)("video.liveSubscribe",e.params)}))),l=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,o.api)("video.liveUnsubscribe",e.params)}))),d=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,o.api)("fave.addUser",e.params)}))),c=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,o.api)("fave.removeUser",e.params)}))),p=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,o.api)("account.ban",e.params)}))),u=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,o.api)("account.unban",e.params)}))),h=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,o.api)("bestFriends.add",e.params)}))),m=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,o.api)("bestFriends.delete",e.params)})));return(0,_.sample)({clock:s.doneData,fn:e=>e[0]||null,target:i}),(0,_.sample)({clock:r.doneData,source:i,filter:t,fn:e=>({...e,is_subscribed:1}),target:i}),(0,_.sample)({clock:a.doneData,source:i,filter:t,fn:e=>({...e,is_subscribed:0}),target:i}),(0,_.sample)({clock:n.doneData,source:i,filter:t,fn:e=>({...e,video_live:e.video_live?{...e.video_live,is_notifications_blocked:0}:void 0}),target:i}),(0,_.sample)({clock:l.doneData,source:i,filter:t,fn:e=>({...e,video_live:e.video_live?{...e.video_live,is_notifications_blocked:1}:void 0}),target:i}),(0,_.sample)({clock:d.doneData,source:i,filter:t,fn:e=>({...e,is_favorite:1}),target:i}),(0,_.sample)({clock:c.doneData,source:i,filter:t,fn:e=>({...e,is_favorite:0}),target:i}),(0,_.sample)({clock:p.doneData,source:i,filter:t,fn:e=>({...e,blacklisted_by_me:1}),target:i}),(0,_.sample)({clock:u.doneData,source:i,filter:t,fn:e=>({...e,blacklisted_by_me:0}),target:i}),(0,_.sample)({clock:h.doneData,source:i,filter:t,fn:e=>({...e,is_best_friend:!0}),target:i}),(0,_.sample)({clock:m.doneData,source:i,filter:t,fn:e=>({...e,is_best_friend:!1}),target:i}),{fetchUserFx:s,subscribeToPostsFx:r,unsubscribeFromPostsFx:a,subscribeToVideoLiveFx:n,unsubscribeFromVideoLiveFx:l,faveAddUserFx:d,faveRemoveUserFx:c,accountBanFx:p,accountUnbanFx:u,bestFriendAddFx:h,bestFriendDeleteFx:m,$user:i,domain:e}}},32686:(e,t,i)=>{i.d(t,{apiFaveAddNarrative:()=>o,apiFaveRemoveNarrative:()=>s});var _=i(31498);function o(e){return(0,_.api)("fave.addNarrative",e)}function s(e){return(0,_.api)("fave.removeNarrative",e)}},50770:(e,t,i)=>{i.d(t,{createFaveService:()=>_.createFaveService});i(32686);var _=i(51701)},51701:(e,t,i)=>{i.d(t,{createFaveService:()=>s});var _=i(32489),o=i(32686);const s=({domain:e})=>{const t=e.createEvent("fire/faveAddNarrative"),i=e.createEvent("fire/faveRemoveNarrative"),s=e.createEffect("fx/faveAddNarrative"),r=e.createEffect("fx/faveRemoveNarrative");return s.use(o.apiFaveAddNarrative),r.use(o.apiFaveRemoveNarrative),(0,_.sample)({clock:t,target:s}),(0,_.sample)({clock:i,target:r}),{fireAddNarrative:t,fireRemoveNarrative:i,addNarrativeFx:s,removeNarrativeFx:r}}},97694:(e,t,i)=>{i.d(t,{findOwnerById:()=>o});var _=i(8615);const o=(e=0,t=[],i=[])=>{if(e)return _.Ranges.isUserId(e)?t.find((t=>t?.id===e)):i.find((t=>t?.id===Math.abs(e)))}},25754:(e,t,i)=>{var _,o,s,r,a;i.d(t,{DynamicStickersTypes:()=>l,StickerTypes:()=>n,StoryBlockType:()=>r,StoryListName:()=>a,StoryPollBackgroundType:()=>c,StoryStickerSubtype:()=>d,StoryType:()=>_}),function(e){e.PHOTO="photo",e.VIDEO="video",e.LIVE="live"}(_||(_={})),function(e){e.SWIPE="swipe",e.NAVIGATION_BUTTON="navigation_button",e.SIT_POSTING="sit_posting",e.LINK="link",e.STORY_REPLY="story_reply",e.STORY_REPOST="story_repost",e.CATALOG_ADD="catalog_add",e.DIALOG="dialog",e.STORY_LIVE_FINISHED="story_live_finished",e.DIALOG_VKME="dialog_vkme",e.STORY_VIEWER_FINISHED="story_viewer_finished",e.PUSH_TRY_MASK="push_try_mask",e.STORY_VIEWER_TRY_MASK="story_viewer_try_mask",e.LINK_MASK="link_mask",e.POSTING="posting",e.NEW_STORY_AVATAR="new_story_avatar",e.STORY_REPLIES_LIST="story_replies_list",e.STORIES_FEED="stories_feed",e.STORIES_SEARCH_NEWS="stories_search_news",e.QUESTION_STICKER="question_sticker",e.LIST_MIDDLE="list_middle",e.ARCHIVE_EMPTY_BUTTON="archive_empty_button",e.ARCHIVE_MENU_BUTTON="archive_menu_button",e.IM="im",e.PROFILE_BUTTON="profile_button",e.SHARE="share",e.MINI_APP="mini_app",e.SYSTEM_SHARING="system_sharing",e.SHORTCUT="shortcut",e.ARCHIVE_SHARING="archive_sharing",e.STORY_VIEWER_CAMERA_BUTTON="story_viewer_camera_button",e.STORY_VIEWER_MUSIC="story_viewer_music",e.STORY_VIEWER_MUSIC_SHEET="story_viewer_music_sheet",e.REPOST_TO_STORY_ACTIVITY="repost_to_story_activity",e.CHANGE_AVATAR="change_avatar"}(o||(o={})),function(e){e.FEED="feed",e.FEED_MIDDLE="feed_middle",e.LINK="link",e.PROFILE="profile",e.IM_DIALOGS="im_dialogs",e.IM_DIALOG_HEADER="im_dialog_header",e.SNIPPET="snippet",e.REPLY="reply",e.REPLIES_LIST="replies_list",e.REPLY_STORY="reply_story",e.DISCOVER="discover",e.STORIES_MANAGE="stories_manage",e.USER_PERSONAL_CARD="user_personal_card",e.GROUP_PERSONAL_CARD="group_personal_card",e.NARRATIVE_SNIPPET="narrative_snippet",e.NARRATIVE_STORY="narrative_story",e.NARRATIVE_LINK="narrative_link",e.NARRATIVE_RECOMMENDATIONS="narrative_recommendations",e.NARRATIVE_SECTION="narrative_section",e.FAVE="fave",e.SPAMFEED="sf",e.ADS_PREVIEW="ads_preview",e.LIST_MIDDLE="list_middle",e.PLACE_STORY_LIST="place_story_list",e.SEARCH_STORY_LIST="search_story_list",e.STORY_ARCHIVE="story_archive",e.IM_MSG_LIST="im_msg_list",e.NOSPAM="nospam",e.PROFILE_SNACKBAR="profile_snackbar",e.MY_QUESTIONS="question_story"}(s||(s={})),function(e){e.stories="stories",e.appGroupedStories="app_grouped_stories",e.promoStories="promo_stories",e.discover="discover",e.liveActive="live_active",e.liveFinished="live_finished"}(r||(r={})),function(e){e.feed="feed",e.apps="apps",e.discover="discover"}(a||(a={}));const n={hashtag:1,mention:2,question:3,place:4,music:5,storyReply:6,owner:7,link:8,marketItem:9,post:10,poll:11,sticker:12,app:13,situationalTheme:14,playlist:15,videoButton:16,situationalTemplate:17,spoiler:18},l={situationalTemplate:n.situationalTemplate};var d,c;!function(e){e.aliexpress="aliexpress_product",e.market="market_item"}(d||(d={})),function(e){e.photo="photo",e.gradient="gradient",e.default="default"}(c||(c={}))},23126:(e,t,i)=>{i.d(t,{apiLikesAdd:()=>o,apiLikesDelete:()=>s});var _=i(31498);function o(e){return(0,_.api)("likes.add",e)}function s(e){return(0,_.api)("likes.delete",e)}},75875:(e,t,i)=>{var _;!function(e){e.Story="story"}(_||(_={}))},69946:(e,t,i)=>{i.d(t,{createLikesService:()=>_.createLikesService});var _=i(8861);i(23126),i(75875)},8861:(e,t,i)=>{i.d(t,{createLikesService:()=>s});var _=i(32489),o=i(23126);const s=({domain:e})=>{const t=e.createEvent("fire/likesAdd"),i=e.createEvent("fire/likesDelete"),s=e.createEffect("fx/likesAdd"),r=e.createEffect("fx/likesDelete");return s.use(o.apiLikesAdd),r.use(o.apiLikesDelete),(0,_.sample)({clock:t,target:s}),(0,_.sample)({clock:i,target:r}),{fireAdd:t,fireDelete:i,addFx:s,deleteFx:r}}},6874:(e,t,i)=>{i.d(t,{apiMessagesSend:()=>o});var _=i(31498);function o(e){return(0,_.api)("messages.send",e)}},95030:(e,t,i)=>{i.d(t,{createMessagesService:()=>_.createMessagesService});i(6874);var _=i(33817)},33817:(e,t,i)=>{i.d(t,{createMessagesService:()=>s});var _=i(32489),o=i(6874);const s=({domain:e})=>{const t=e.createEvent("fire/messageSend"),i=e.createEffect("fx/messageSend");return i.use(o.apiMessagesSend),(0,_.sample)({clock:t,target:i}),{fireMessagesSend:t,sendFx:i}}},23989:(e,t,i)=>{i.d(t,{apiNarrativesBatchEdit:()=>r,apiNarrativesCreate:()=>o,apiNarrativesDelete:()=>a,apiNarrativesEdit:()=>s,apiNarrativesGetById:()=>n,apiNarrativesGetFeedBlock:()=>l,apiNarrativesGetFromOwner:()=>d,apiNarrativesReorder:()=>p,apiNarrativesSaveCustomCover:()=>c});var _=i(31498);function o(e){return(0,_.api)("narratives.create",e)}function s(e){return(0,_.api)("narratives.edit",e)}function r(e){return(0,_.api)("narratives.batchEdit",e)}function a(e){return(0,_.api)("narratives.delete",e)}function n(e){return(0,_.api)("narratives.getById",e)}function l(e={}){return(0,_.api)("narratives.getFeedBlock",e)}function d(e){return(0,_.api)("narratives.getFromOwner",e)}function c(e){return(0,_.api)("narratives.saveCustomCover",e)}function p(e){return(0,_.api)("narratives.reorder",e)}},24521:(e,t,i)=>{i.d(t,{apiNarrativesGetById:()=>o.apiNarrativesGetById,apiNarrativesGetFeedBlock:()=>o.apiNarrativesGetFeedBlock,apiNarrativesGetFromOwner:()=>o.apiNarrativesGetFromOwner,createNarrativesService:()=>_.createNarrativesService});var _=i(54070),o=i(23989)},54070:(e,t,i)=>{i.d(t,{createNarrativesService:()=>s});var _=i(32489),o=i(23989);const s=({domain:e})=>{const t=e.createEvent("fire/narrativesGetById"),i=e.createEvent("fire/narrativesGetFromOwner"),s=e.createEvent("fire/narrativesGetFeedBlock"),r=e.createEvent("fire/narrativesCreate"),a=e.createEvent("fire/narrativesEdit"),n=e.createEvent("fire/narrativesBatchEdit"),l=e.createEvent("fire/narrativesDelete"),d=e.createEvent("fire/narrativesSaveCustomCover"),c=e.createEvent("fire/narrativesReorder"),p=e.createEffect("fx/narrativesGetById"),u=e.createEffect("fx/narrativesGetFromOwner"),h=e.createEffect("fx/narrativesGetFeedBlock"),m=e.createEffect("fx/narrativesCreate"),E=e.createEffect("fx/narrativesEdit"),b=e.createEffect("fx/narrativesBatchEdit"),w=e.createEffect("fx/narrativesDelete"),g=e.createEffect("fx/narrativesSaveCustomCover"),f=e.createEffect("fx/narrativesReorder");return p.use(o.apiNarrativesGetById),u.use(o.apiNarrativesGetFromOwner),h.use(o.apiNarrativesGetFeedBlock),m.use(o.apiNarrativesCreate),E.use(o.apiNarrativesEdit),b.use(o.apiNarrativesBatchEdit),w.use(o.apiNarrativesDelete),g.use(o.apiNarrativesSaveCustomCover),f.use(o.apiNarrativesReorder),(0,_.sample)({clock:t,target:p}),(0,_.sample)({clock:i,target:u}),(0,_.sample)({clock:s,target:h}),(0,_.sample)({clock:r,target:m}),(0,_.sample)({clock:a,target:E}),(0,_.sample)({clock:n,target:b}),(0,_.sample)({clock:l,target:w}),(0,_.sample)({clock:d,target:g}),(0,_.sample)({clock:c,target:f}),{fireGetById:t,fireGetFromOwner:i,fireGetFeedBlock:s,fireCreate:r,fireEdit:a,fireBatchEdit:n,fireDelete:l,fireSaveCustomCover:d,fireReorder:c,getByIdFx:p,getFromOwnerFx:u,getFeedBlockFx:h,createFx:m,editFx:E,batchEditFx:b,deleteFx:w,saveCustomCoverFx:g,reorderFx:f}}},4e4:(e,t,i)=>{i.d(t,{getPhotoSize:()=>_});function _(e,t){if(!e?.sizes?.length)return"";const i=[...e.sizes].sort(((e,t)=>e.width-t.width));let _=i.find((e=>e.width>=t));return _?.url?_.url:(_=i.reverse().find((e=>e.width<t)),_?.url?_.url:"")}},89724:(e,t,i)=>{i.d(t,{apiPollsCreate:()=>s,apiPollsGetById:()=>o});var _=i(31498);function o(e){return(0,_.api)("polls.getById",e)}function s(e){return(0,_.api)("polls.create",e)}},51468:(e,t,i)=>{i.d(t,{createPollsService:()=>_.createPollsService});i(89724);var _=i(21083)},21083:(e,t,i)=>{i.d(t,{createPollsService:()=>s});var _=i(32489),o=i(89724);const s=({domain:e})=>{const t=e.createEvent("fire/pollsGetById"),i=e.createEvent("fire/pollsCreate"),s=e.createEffect("fx/pollsGetById"),r=e.createEffect("fx/pollsCreate");return s.use(o.apiPollsGetById),r.use(o.apiPollsCreate),(0,_.sample)({clock:t,target:s}),(0,_.sample)({clock:i,target:r}),{fireGetById:t,fireCreate:i,getByIdFx:s,createFx:r}}},85152:(e,t,i)=>{i.d(t,{ArticleTtsActionType:()=>_,articleTtsActionStatController:()=>s});var _,o=i(97669);!function(e){e.START="start",e.PAUSE="pause",e.CONTINUE="continue",e.SEEK="seek",e.CLOSE="close",e.P10="10p",e.P25="25p",e.P50="50p",e.P75="75p",e.P95="95p",e.P99="99p",e.P100="100p"}(_||(_={}));const s=new class{logEvent(e,t){const i={type:"type_marusia_reading_item",type_marusia_reading_item:e};this.actionStatCollector.logEvent(i,t)}constructor(){this.productStatCollector=new o.ProductionStatCollector,this.actionStatCollector=new o.ActionStatCollector(this.productStatCollector)}}},82475:(e,t,i)=>{i.d(t,{OPENED_REACTED_USERS_DEFAULT_REACTION_ID:()=>n,REACTION_ID_DEFAULT:()=>_,REACTION_ID_MAX:()=>o,REACTION_ID_MIN:()=>s,REACTION_ID_UNSET:()=>r,REACTION_SET_ITEMS_MIN_COUNT:()=>a});const _=0,o=7,s=0,r=void 0,a=2,n=_},1761:(e,t,i)=>{i.d(t,{reactionCountsBrandUnwrap:()=>o,reactionCountsBrandWrap:()=>s});var _=i(31818);const o=e=>(0,_.unwrap)(e),s=e=>(0,_.wrap)(e)},78096:(e,t,i)=>{i.d(t,{prepareReactionMenuSet:()=>o});i(82475),i(1761),i(8520);Number.isInteger;const _=(e,t)=>0===e.length?"":((e,t,i=!0)=>e.reduce(((e,_)=>{const o=t(_),s=t(e);return s===o?i?e:_:s<o?e:_})))(e,(e=>(t.width-e.width)**2+(t.height-e.height)**2),!1).url,o=(e,t,i)=>{const o=t.map((({asset:e,color_sets:t,id:o,score:s,title:r})=>({animationURL:e.animation_url||void 0,backgroundColor:t?.background,id:o,imageMenuURL:_(e.images,i.imageMenuSize),imagePreviewURL:"imagePreviewSize"in i?_(e.images,i.imagePreviewSize):void 0,imageStoryPanelURL:"imageStoryPanelSize"in i?_(e.images,i.imageStoryPanelSize):void 0,imageStoryPreviewURL:"imageStoryPreviewSize"in i?_(e.images,i.imageStoryPreviewSize):void 0,score:s,title:r,titleColor:t?.foreground}))),s={};return o.forEach((e=>{s[e.id]=e})),{id:e,items:o,itemsById:s}}},31818:(e,t,i)=>{i.d(t,{unwrap:()=>_,wrap:()=>o});const _=e=>e,o=e=>e},87389:(e,t,i)=>{i.d(t,{apiStatsTrackEvents:()=>o});var _=i(31498);function o(e){return(0,_.api)("stats.trackEvents",e)}},76448:(e,t,i)=>{i.d(t,{STATS_EVENT_TYPE_STORIES_VIEWER_NAVIGATION:()=>_,STATS_EVENT_TYPE_STORIES_VIEWING_START_TIME:()=>o});const _="stories_viewer_navigation",o="stories_viewing_start_time"},40817:(e,t,i)=>{i.d(t,{createStatsService:()=>_.createStatsService});i(87389);var _=i(15294)},15294:(e,t,i)=>{i.d(t,{createStatsService:()=>s});var _=i(32489),o=i(87389);const s=({domain:e})=>{const t=e.createEvent("fire/statsTrackEvents"),i=e.createEffect("fx/statsTrackEvents");return i.use(o.apiStatsTrackEvents),(0,_.sample)({clock:t,target:i}),{fireTrackEvents:t,trackEventsFx:i}}},47020:(e,t,i)=>{i.d(t,{apiStoriesAskQuestion:()=>f,apiStoriesBanOwner:()=>S,apiStoriesBanQuestionAuthor:()=>O,apiStoriesDelete:()=>g,apiStoriesDeleteQuestion:()=>P,apiStoriesGet:()=>o,apiStoriesGetArchive:()=>n,apiStoriesGetById:()=>r,apiStoriesGetDetailedStats:()=>u,apiStoriesGetDiscover:()=>a,apiStoriesGetPhotoUploadServer:()=>T,apiStoriesGetQuestions:()=>c,apiStoriesGetReplies:()=>d,apiStoriesGetStats:()=>p,apiStoriesGetVideoUploadServer:()=>A,apiStoriesGetViewers:()=>l,apiStoriesGetWithPrefetch:()=>s,apiStoriesHideAllReplies:()=>R,apiStoriesHidePrivacyBlock:()=>w,apiStoriesHideReply:()=>k,apiStoriesMarkAppNotificationsSeen:()=>D,apiStoriesMarkNotInterested:()=>m,apiStoriesMarkSeen:()=>b,apiStoriesMarkSkipped:()=>h,apiStoriesSave:()=>I,apiStoriesSearch:()=>E,apiStoriesSetDiscoverVisible:()=>y,apiStoriesSubscribeUserToApp:()=>v,apiStoriesUnbanOwner:()=>C,apiStoriesUnbanQuestionAuthor:()=>M});var _=i(31498);function o(e){return(0,_.api)("stories.get",e)}function s(e){return(0,_.apiWithPrefetch)("stories.get",e)}function r(e){return(0,_.api)("stories.getById",e)}function a(e){return(0,_.api)("stories.getDiscover",e)}function n(e){return(0,_.api)("stories.getArchive",e)}function l(e){return(0,_.api)("stories.getViewers",e)}function d(e){return(0,_.api)("stories.getReplies",e)}function c(e){return(0,_.api)("stories.getQuestions",e)}function p(e){return(0,_.api)("stories.getStats",e)}function u(e){return(0,_.api)("stories.getDetailedStats",e)}function h(e){return(0,_.api)("stories.markSkipped",e)}function m(e){return(0,_.api)("stories.markNotInterested",e)}function E(e){return(0,_.api)("stories.search",e)}function b(e){return(0,_.api)("stories.markSeen",e)}function w(e){return(0,_.api)("stories.hidePrivacyBlock",e)}function g(e){return(0,_.api)("stories.delete",e)}function f(e){return(0,_.api)("stories.askQuestion",e)}function P(e){return(0,_.api)("stories.deleteQuestion",e)}function O(e){return(0,_.api)("stories.banQuestionAuthor",e)}function M(e){return(0,_.api)("stories.unbanQuestionAuthor",e)}function D(e){return(0,_.api)("stories.markAppNotificationsSeen",e)}function v(e){return(0,_.api)("stories.subscribeUserToApp",e)}function T(e){return(0,_.api)("stories.getPhotoUploadServer",e)}function A(e){return(0,_.api)("stories.getVideoUploadServer",e)}function I(e){return(0,_.api)("stories.save",e)}function S(e){return(0,_.api)("stories.banOwner",e)}function C(e){return(0,_.api)("stories.unbanOwner",e)}function y(e){return(0,_.api)("stories.setDiscoverVisible",e)}function k(e){return(0,_.api)("stories.hideReply",e)}function R(e){return(0,_.api)("stories.hideAllReplies",e)}},32234:(e,t,i)=>{i.d(t,{STORIES_ARCHIVE_START_TIME:()=>_});const _=1559032200},7056:(e,t,i)=>{var _,o=i(35850),s=i(7520);!function(e){e[e.getViewers=0]="getViewers",e[e.getReplies=1]="getReplies",e[e.getQuestions=2]="getQuestions",e[e.getDetailedStats=3]="getDetailedStats",e[e.getStats=4]="getStats"}(_||(_={}));o.storiesDomain.createEffect({name:"fire/storiesGetFeedback",handler:({ownerId:e,storyId:t,pollId:i})=>{const _=((e,t)=>({0:{owner_id:e,story_id:t,extended:1,count:100,fields:(0,s.makeOwnerFields)(["is_nft","photo_100","photo_50"])},1:{owner_id:e,story_id:t,extended:1,fields:(0,s.getStoryOwnerFields)()},2:{owner_id:e,story_id:t,extended:1,fields:(0,s.makeOwnerFields)(["domain","first_name_dat","first_name_ins","last_name_ins","last_name_dat","first_name_gen","last_name_gen"]),count:30},3:{owner_id:e,story_id:t},4:{owner_id:e,story_id:t}}))(e,t);return Promise.allSettled([o.storiesService.getViewersFx(_[0]),o.storiesService.getRepliesFx(_[1]),o.storiesService.getQuestionsFx(_[2]),i?o.pollsService.getByIdFx({owner_id:e,poll_id:i}):Promise.resolve(null),o.storiesService.getDetailedStatsFx(_[3]),o.storiesService.getStatsFx(_[4])]).then((e=>e.map((e=>"fulfilled"===e.status?e?.value:null))))}})},13167:(e,t,i)=>{i.d(t,{STORIES_ARCHIVE_START_TIME:()=>r.STORIES_ARCHIVE_START_TIME,apiStoriesGet:()=>s.apiStoriesGet,apiStoriesGetArchive:()=>s.apiStoriesGetArchive,apiStoriesGetById:()=>s.apiStoriesGetById,apiStoriesGetDiscover:()=>s.apiStoriesGetDiscover,apiStoriesGetReplies:()=>s.apiStoriesGetReplies,apiStoriesGetWithPrefetch:()=>s.apiStoriesGetWithPrefetch,apiStoriesSearch:()=>s.apiStoriesSearch,createStoriesService:()=>_.createStoriesService,decodeBase64:()=>o.decodeBase64});var _=i(65664),o=i(72950),s=(i(57888),i(47020)),r=i(32234);i(35850),i(7056)},8638:(e,t,i)=>{i.d(t,{FEED_STORIES_BLOCK_OWNER_FIELDS:()=>o,FEED_STORIES_BLOCK_OWNER_MINIMIZED_FIELDS:()=>_});const _=["photo_100","is_nft","is_nft_photo"],o=["first_name","last_name","first_name_gen","last_name_gen","first_name_ins","last_name_ins","screen_name","name","is_member","is_closed","is_nft","is_nft_photo","photo_50","photo_100","photo_200","friend_status","verified","sex"]},7520:(e,t,i)=>{i.d(t,{getStoryOwnerFields:()=>o,makeOwnerFields:()=>s});var _=i(8638);function o(e=!1){return s(e?_.FEED_STORIES_BLOCK_OWNER_MINIMIZED_FIELDS:_.FEED_STORIES_BLOCK_OWNER_FIELDS)}function s(e){return e.join(",")}},32655:(e,t,i)=>{i.d(t,{transformClickableStickers:()=>b});var _=i(8520),o=i(99740),s=i(48370),r=i(28829),a=i(67212),n=i(33763),l=i(4e4),d=i(97694),c=i(21667),p=i(25754);const u={hashtag:p.StickerTypes.hashtag,mention:p.StickerTypes.mention,question:p.StickerTypes.question,place:p.StickerTypes.place,music:p.StickerTypes.music,story_reply:p.StickerTypes.storyReply,owner:p.StickerTypes.owner,link:p.StickerTypes.link,market_item:p.StickerTypes.marketItem,post:p.StickerTypes.post,poll:p.StickerTypes.poll,sticker:p.StickerTypes.sticker,app:p.StickerTypes.app,situational_theme:p.StickerTypes.situationalTheme,playlist:p.StickerTypes.playlist,clip:p.StickerTypes.videoButton,situational_template:p.StickerTypes.situationalTemplate,spoiler:p.StickerTypes.spoiler},h={transparent:1,blue_gradient:2,red_gradient:3,underline:4,blue:5,green:6,white:7,question_reply:8,light:9,impressive:10,dark:11,accent_background:12,accent_text:13,dark_unique:14,light_unique:15,light_text:18,dark_text:19,black:20,dark_without_bg:21,light_without_bg:22,rectangle:23,circle:24,poop:25,heart:26,star:27},m=(e,t=6)=>isNaN(e)?NaN:Number(e.toFixed(t)),E=/^\[(id|club)(\d+)\|(.*)]$/;function b(e,t=[],i=[],b){const w=e?.clickable_stickers;if(!(w&&Object.values(w).length&&w.original_width&&w.original_height))return{original_width:0,original_height:0,stickers:[]};let g=w.original_width,f=w.original_height;Number((f/g).toFixed(2))>1.78&&(f=1.78*g);const P=(w.original_height-f)/2,O=g/100,M=f/100;return{original_width:g,original_height:f,stickers:w?.clickable_stickers?.length?w.clickable_stickers.reduce(((w,g)=>{if(!g)return w;if(b&&"situational_template"===g.type&&!(0,s.partConfigEnabled)("stories_mvk_sticker_template"))return w;if(!b&&"situational_template"===g.type&&!(0,s.partConfigEnabled)("stories_sticker_template"))return w;const{clickable_area:f=[]}=g;if(f.length<4)return w;const D=Math.sqrt(Math.pow(f[1].x-f[0].x,2)+Math.pow(f[1].y-f[0].y,2)),v=Math.sqrt(Math.pow(f[1].x-f[2].x,2)+Math.pow(f[1].y-f[2].y,2));if(!D||!v)return w;const T=f[1].x-f[0].x;let A=180*Math.acos(T/D)/Math.PI;isNaN(A)&&(A=0),f[1].y<f[0].y&&(A=-A);const I=u[g.type],S={id:g.id,type:I,top:m((f[0].y-P)/M/100),left:m(f[0].x/O/100),width:m(D/O/100),height:m(v/M/100),rotate:m(A)};g.style&&(S.style=h[g.style]);let C=!1;switch(I){case p.StickerTypes.hashtag:g.hashtag?S.hashtag=g.hashtag:C=!0;break;case p.StickerTypes.mention:{const e=g.mention?.match(E),_=e?.[1],s=Number(e?.[2]);if(!s||isNaN(s)){C=!0;break}const r="id"===_&&t.find((({id:e})=>e===s)),a=!r&&"club"===_&&i.find((({id:e})=>e===s));r?(S.mentionedPhotoUrl=r.photo_100||r.photo_50||"",S.mentionedOwnerHref=(0,o.getOwnerHref)(r),S.mentionedText=(0,o.getOwnerFullName)(r)):a?(S.mentionedText=a.name||"",S.mentionedPhotoUrl=a.photo_100||a.photo_50||"",S.mentionedOwnerHref=(0,o.getOwnerHref)(a)):C=!0;break}case p.StickerTypes.question:S.question=g.question||"";break;case p.StickerTypes.place:g.place_id?S.placeId=g.place_id:C=!0;break;case p.StickerTypes.music:if(!g.audio){C=!0;break}S.audioId=`${g.audio.owner_id}_${g.audio.id}`,S.audioData=JSON.stringify((0,a.apiAudioToAudioTuple)(g.audio)),g.audio_restrictions&&(S.audioRestriction={code:g.audio_restrictions.id,title:g.audio_restrictions.title,buttonText:g.audio_restrictions.button?.title||"",buttonUrl:g.audio_restrictions.button?.action?.url||""});break;case p.StickerTypes.playlist:if(!g.playlist){C=!0;break}S.playlistOwnerId=g.playlist.owner_id,S.playlistId=g.playlist.id,S.playlistFollowed=Boolean(g.playlist.followed);break;case p.StickerTypes.storyReply:g.owner_id&&(S.ownerId=g.owner_id),S.link=(0,o.getOwnerHref)((0,d.findOwnerById)(g.owner_id,t,i)),g.story_id?S.storyId=g.story_id:S.isExpired=!0;break;case p.StickerTypes.owner:g.owner_id&&(S.ownerId=g.owner_id),S.link=(0,o.getOwnerHref)((0,d.findOwnerById)(g.owner_id,t,i));break;case p.StickerTypes.link:g.link_object?(S.link=g.link_object.url?(0,c.wrapAwayIfExternal)(g.link_object.url):"",S.tooltipText=g.tooltip_text||""):C=!0;break;case p.StickerTypes.marketItem:if(g.subtype===p.StoryStickerSubtype.aliexpress)S.link=g.link_object?.url?(0,c.wrapAwayIfExternal)(g.link_object.url):"",S.photoUrl=g.link_object&&(0,l.getPhotoSize)(g.link_object.photo,50*devicePixelRatio)||"";else if(g.subtype===p.StoryStickerSubtype.market&&g.market_item)if(S.photoUrl=g.market_item.thumb&&(0,_.getPhotoSize)(g.market_item.thumb,50*devicePixelRatio)?.url||"",S.isRestricted=!1,b)S.link=`/product${g.market_item.owner_id}_${g.market_item.id}`;else{const e=(0,o.getOwnerHref)((0,d.findOwnerById)(g.market_item.owner_id,t,i));S.link=`${e}?w=product${g.market_item.owner_id}_${g.market_item.id}`,S.seoSlug=g.market_item.seo_slug}else C=!0;break;case p.StickerTypes.post:g.post_owner_id&&(S.postOwnerId=g.post_owner_id),g.post_id?S.postId=g.post_id:C=!0;break;case p.StickerTypes.poll:g.poll?(S.pollId=g.poll.id,S.pollOwnerId=g.poll.owner_id):C=!0;break;case p.StickerTypes.app:if(g.app){S.appId=g.app.id,S.hasNewInteractions=Boolean(g.has_new_interactions);const t=[e.owner_id,e.id,"story",g.id];g.app_context&&t.push(btoa(g.app_context)),S.appRef=`story${t.join("_")}`}else C=!0;break;case p.StickerTypes.sticker:g.sticker_pack_id?(S.stickerPackId=g.sticker_pack_id,g.sticker_id&&(S.stickerId=g.sticker_id),S.tooltipText=(0,n.getLang)("stories_view_sticker_pack")):C=!0;break;case p.StickerTypes.situationalTheme:g.situational_theme_id?(S.situationalAppId=r.SITPOSTING_APP_ID,S.situationalThemeId=g.situational_theme_id):C=!0;break;case p.StickerTypes.videoButton:g.clip_id?(g.owner_id&&(S.videoOwnerId=g.owner_id),S.videoId=g.clip_id,S.videoType=g.type,S.tooltipText=(0,n.getLang)("stories_link_attach_clip")):C=!0;break;case p.StickerTypes.situationalTemplate:g.situational_theme_id?(S.situationalAppId=r.SITPOSTING_APP_ID,S.situationalThemeId=g.situational_theme_id,g.situational_replied_users&&(S.situationalRepliedUsers=g.situational_replied_users,S.situationalRepliedAvatars=g.situational_replied_users?.items?.map((e=>{const{photo_100:_}=t.find((t=>t.id===e))||{},{photo_100:o}=i.find((t=>t.id===e))||{},s=_||o;if(s)return{photo_100:s}})).filter((e=>Boolean(e)))||[])):C=!0;break;default:C=!0}return C||w.push(S),w}),[]):[]}}},26073:(e,t,i)=>{i(33763),i(8520),i(99740),i(25754)},45552:(e,t,i)=>{i.d(t,{transformNarrativeGetApiResponseToLegacyFormat:()=>_.transformNarrativeGetApiResponseToLegacyFormat,transformStoriesToLegacy:()=>_.transformStoriesToLegacy,transformStoryGetApiResponseToLegacyFormat:()=>_.transformStoryGetApiResponseToLegacyFormat});i(32655),i(89086),i(87356);var _=i(62267);i(26073)},62267:(e,t,i)=>{i.d(t,{getVideoSize:()=>I,transformNarrativeGetApiResponseToLegacyFormat:()=>E,transformStoriesToLegacy:()=>f,transformStoryGetApiResponseToLegacyFormat:()=>m});var _=i(94768),o=i(18562),s=i(99740),r=i(83376),a=i(25754),n=i(33763),l=i(8520),d=i(77004),c=i(97694),p=i(32655),u=i(89086),h=i(78096);function m(e,t,i){const{items:_,profiles:s=[],groups:r=[],reaction_sets:n}=e,l=_.map((e=>{const _=e.owner_id||e.stories?.[0]?.owner_id||0,l=(0,c.findOwnerById)(_,s,r)||{id:_},d=e.stories?.filter(Boolean)||[],p=t===a.StoryListName.feed||t===a.StoryListName.discover||t===a.StoryListName.apps,u={id:e.id||(0,o.default)(),author:w(l,s,d[0]?.also_subscribed),has_unseen:e.has_unseen,items:d.map((e=>g(e,l,s,r,i,t))),track_code:e.track_code,can_blacklist:p,app:e.app&&b(e.app),type:e.type,send_mask_hash:"",remove_from_blacklist_hash:"",is_narrative:!1,is_apps:e.type===a.StoryBlockType.appGroupedStories,next_from:""};if(e.grouped?.length&&(u.grouped=m({items:e.grouped,profiles:s,groups:r},t,i)),n&&(u.reaction_set=P(n)),i){const _=function(e,t,i,_,o,s){const r=e.stories?.[0],a=e.app;if("app_grouped_stories"!==e.type||!r)return;const n=g(r,t,i,_,o,s);n.raw_id=n.raw_id+"&meta",n.is_apps_meta_story=!0,a&&(n.app=b(a));return n}(e,l,s,r,i,t);_&&u.items.push(_)}return u}));return l}function E(e,t,i){const{items:_,profiles:s=[],groups:r=[]}=e;return _.map((e=>{const _=e.owner_id||e.stories?.[0]?.owner_id||0,n=(0,c.findOwnerById)(_,s,r)||{id:_},l=e.stories?.filter(Boolean)||[];return{id:(0,o.default)(),author:w(n,s,l[0]?.also_subscribed),items:l.map((e=>g(e,n,s,r,i,t))),can_blacklist:!1,type:a.StoryBlockType.stories,send_mask_hash:"",remove_from_blacklist_hash:"",is_apps:!1,next_from:"",is_narrative:!0,narrative:(0,u.transformNarrative)(e,n)}}))}function b(e){return{url:`/app${e.id}`,name:e.title,photoUrl:e.icon_139||e.icon_150||e.icon_75||""}}function w(e,t=[],i){const _=e.verified?'<div class="page_verified"></div>':"",o=function(e,t=[]){if(!e)return;const i=[],_=e.user_ids||[];return _.forEach((e=>{const _=t.find((t=>t.id===e));_&&i.push({photo_url:_.photo_50||_.photo_100||"",href:(0,s.getOwnerHref)(_),name:_.first_name||"",sex:_.sex||0})})),{total_count:e.count||0,owners:i}}(i,t);if((0,s.isOwnerUser)(e)){const t=e.id,i=e.first_name||"",r=e.last_name||"",a=e.first_name_gen||"",n=e.last_name_gen||"",d=e.first_name_ins||"",c=(0,s.getOwnerFullName)(e),p=r?`${a} ${n}`:a;return{id:t,name:(0,l.escape)(c),name_get:(0,l.escape)(p),firstName:(0,l.escape)(i),first_name_gen:(0,l.escape)(a),first_name_ins:(0,l.escape)(d),photo:e.photo_100||e.photo_50||"",href:(0,s.getOwnerHref)(e),verify:_,gender:e.sex||0,can_follow:M(e),nft:Boolean(e.is_nft),also_subscribed:o}}const r=-e.id,a=(0,l.escape)(e.name||"");return{id:r,name:a,name_get:a,firstName:a,first_name_gen:a,first_name_ins:a,photo:e.photo_100||e.photo_50||"",href:(0,s.getOwnerHref)(e),verify:_,gender:0,can_follow:M(e),nft:Boolean(e.is_nft_photo),also_subscribed:o}}function g(e,t,i,_,o,u){let h,m;if(e.mask?.owner_id){const t=(0,c.findOwnerById)(e.mask?.owner_id,i,_);t&&(h=t.screen_name,(0,s.isOwnerUser)(t)&&(m=t.sex))}const E=D(t,e),b=!E&&(u===a.StoryListName.feed||u===a.StoryListName.apps||u===a.StoryListName.discover);return{owner_id:e.owner_id,raw_id:`${e.owner_id}_${e.id}`,date:(0,n.getSmDate)(e.date||0),time:e.date||0,type:S(e),unread:!e.seen,canLike:Boolean(e.can_like),can_comment:v(e),can_share:Boolean(e.can_share),can_remove:T(e,t),can_delete_with_reason:Boolean(e.can_delete_with_reason),can_manage:E,can_ask:Boolean(e.can_ask),can_ask_anonymous:Boolean(e.can_ask_anonymous),canAddToNarrative:e.can_use_in_narrative,stats:{follow:{event_type:"subscribe",rhash:""},url_view:{event_type:"url_view",rhash:""}},isLiked:Boolean(e.is_liked),likeHash:"",reaction_set_id:e.reaction_set_id||"",user_reaction_id:e.user_reaction_id||0,preview_url:"",needMute:Boolean(e.need_mute),muteReply:Boolean(e.mute_reply),isPromo:Boolean(e.is_promo),isProfileQuestion:Boolean(e.is_profile_question),promoCaption:e.is_promo&&e.caption||"",track_code:e.track_code||"",video:{owner_id:e.owner_id,video_id:e.video?.id||0},link:e.link?{text:e.link.text||"",url:e.link.url||""}:void 0,isPartOfNarrative:Boolean(e.narratives_count),report_hash:"",maskOwnerDomain:h,maskOwnerSex:m,can_hide_reply:A(e,i,_),noSound:Boolean(e.no_sound),isNewQuestions:E&&Boolean(e.questions?.new),views:Boolean(e.views)?(0,r.formatCount)(e.views||0):"",needShowEmptyStats:Boolean(e.need_show_empty_stats),is_expired:Boolean(e.is_expired),is_deleted:Boolean(e.is_deleted),is_private:!Boolean(e.can_see),isAds:Boolean(e.is_ads),isOneTime:Boolean(e.is_one_time),isOneTimeSeen:Boolean(e.is_one_time)&&!Boolean(e.can_see),seenProgress:0,replies:e.replies?.count?(0,r.formatCount)(e.replies.count):"",replies_new_counter:e.replies?.new||0,clickable_stickers:(0,p.transformClickableStickers)(e,i,_,o),askQuestionHash:"",canMarkNotInterested:b,photo_url:e.photo?.sizes&&(0,l.getPhotoSize)(e.photo.sizes,(0,d.isRetina)()?1200:600)?.url||"",small_preview:O(e,o),video_url:e.video?.files?I(e.video.files):"",first_frame:e.video?.first_frame&&(0,l.getPhotoSize)(e.video?.first_frame,800)?.url||"",is_apps_meta_story:!1,repliesCountText:"",authorId:0,isMusicCover:!1,is_authors_ads:e.is_authors_ads,advertiser_info_url:e.advertiser_info_url,ad_marker:e.ad_marker,caption:e.caption,is_best_friends_privacy:e.is_best_friends_privacy}}function f(e,t,i){const{items:_,profiles:s,groups:r,reaction_sets:n}=e,l=_[0]?.owner_id||0,d=(0,c.findOwnerById)(l,s,r)||{id:l},p=t===a.StoryListName.feed||t===a.StoryListName.discover||t===a.StoryListName.apps,u=_.some((e=>!e.seen)),h={id:(0,o.default)(),author:w(d,s,_[0]?.also_subscribed),has_unseen:u,items:_.map((e=>g(e,d,s,r,i,t))),track_code:"",can_blacklist:p,type:a.StoryBlockType.stories,send_mask_hash:"",remove_from_blacklist_hash:"",is_narrative:!1,is_apps:!1,next_from:""};return n&&(h.reaction_set=P(n)),[h]}function P(e){return e.map((({id:e,items:t})=>(0,h.prepareReactionMenuSet)(e,t.map((e=>({...e,id:e.id}))),{imageMenuSize:{width:96,height:96},imagePreviewSize:{width:32,height:32},imageStoryPanelSize:{width:128,height:128},imageStoryPreviewSize:{width:40,height:40}})))}function O(e,t=!1){const i=e.photo?.sizes;if(i)return(0,l.getPhotoSize)(i,t?10:(0,d.isRetina)()?600:300)?.url||"";const _=e.video?.first_frame;return _&&(0,l.getPhotoSize)(_,t?10:320)?.url||""}function M(e){return(0,s.isOwnerUser)(e)?window.vk.id!==e.id&&(e.friend_status===_.FriendsFriendStatusStatusEnumNames.NOT_A_FRIEND||e.friend_status===_.FriendsFriendStatusStatusEnumNames.INCOMING_REQUEST):!e.is_member&&!e.is_closed}function D(e,t){return(0,s.isOwnerUser)(e)?t.owner_id===e.id&&window.vk.id===e.id:t.owner_id===-e.id&&(t.is_ads?Boolean(e.is_advertiser):Boolean(e.is_admin))}function v(e){return e.can_comment?Boolean(e.can_comment):"live_active"===e.type&&Boolean(e.video?.can_comment)}function T(e,t){return!e.is_deleted&&(!e.can_delete_with_reason&&(!!e.can_delete||D(t,e)&&("photo"===e.type||"video"===e.type)))}function A(e,t,i){if(!e.parent_story_owner_id||!e.parent_story_id)return!1;const _=window.vk.id,o=e.parent_story_owner_id;if(o===_)return!0;const r=(0,c.findOwnerById)(o,t,i);return!!(r&&(0,s.isOwnerGroup)(r)&&r.is_admin)}function I(e){const t=["mp4_2160","mp4_1440","mp4_1080","mp4_720","mp4_480","mp4_360","mp4_240","mp4_144"].find((t=>Boolean(e[t])));return t&&e[t]?String(e[t]):""}function S(e){return"photo"===e.type?a.StoryType.PHOTO:"video"===e.type?a.StoryType.VIDEO:"live_active"===e.type||"live_finished"===e.type?a.StoryType.LIVE:a.StoryType.PHOTO}},89086:(e,t,i)=>{i.d(t,{transformNarrative:()=>r});var _=i(8520),o=i(99740),s=(i(97694),i(87356));function r(e,t){const i=`${e.owner_id}_${e.id}`,r=(0,o.isOwnerGroup)(t),a=r&&Boolean(t.is_closed),n={id:e.id,rawId:i,ownerId:e.owner_id,ownerName:(0,_.escape)((r?t.name:(0,o.getOwnerFullName)(t))||""),ownerShortName:(0,_.escape)((r?t.name:(0,o.getOwnerShortName)(t))||""),ownerUrl:(0,o.getOwnerHref)(t),ownerPath:`${r?"club":"id"}${e.owner_id}`,ownerAvatarUrl:t.photo_100||t.photo_50||"",title:(0,_.escape)(e.title),isBookmarked:e.is_favorite,bookmarkHash:"",reportHash:"",canEdit:Boolean(e.can_delete),editHash:"",canView:e.can_see,storiesCount:e.story_ids?.length||0,isOwnerClosedGroup:a,isGroupEditor:a&&Boolean(t.is_admin),url:`${window.location.origin}/narrative${i}`,stories:e.stories?.map(s.transformStoryArchive)||[],isDeleted:e.is_delete,date:"",coverUrl:""};if(e.cover){Object.assign(n,{coverUrl:e.cover.cropped_sizes&&(0,_.getPhotoSize)(e.cover.cropped_sizes,300)?.url||"",coverCrop:{x:e.cover.crop_x||0,y:e.cover.crop_y||0,width:e.cover.crop_width||0,height:e.cover.crop_height||0}}),e.cover.custom_photo&&(n.customCover=function(e,t=[]){if(!e)return;return{photoId:e.id,originalPhotoUrl:e.orig_photo?.url||e.sizes&&(0,_.getPhotoSize)(e.sizes,600)?.url||"",previewUrl:t&&(0,_.getPhotoSize)(t,300)?.url||e.sizes&&(0,_.getPhotoSize)(e.sizes,300)?.url||""}}(e.cover.custom_photo,e.cover.cropped_sizes));const t=e.cover.cover_story_id;if(t){Object.assign(n,{coverStoryId:t,coverStoryRawId:`${e.owner_id}_${t}`});const i=e.stories?.find((e=>e?.id===t));i&&(n.coverStory=(0,s.transformStoryArchive)(i))}}return n}},87356:(e,t,i)=>{i.d(t,{transformStoryArchive:()=>a});var _=i(8520),o=i(13167),s=i(62267),r=i(21667);function a(e){const t=Math.max(e.date?Math.ceil(new Date(1e3*e.date).setUTCHours(0,0,0,0)/1e3):0,o.STORIES_ARCHIVE_START_TIME),i=e.photo?.sizes||e.video?.image,a={id:e.id,rawId:`${e.owner_id}_${e.id}`,listId:`archive${e.owner_id}_${t}`,time:Number(e.date),preview:i&&(0,_.getPhotoSize)(i,350)?.url||"",originalPreviewUrl:i&&(0,_.getPhotoSize)(i,600)?.url||""};return"video"===e.type&&e.video&&Object.assign(a,{videoUrl:e.video.files&&(0,s.getVideoSize)(e.video.files)||"",duration:e.video.duration}),e.link&&Object.assign(a,{linkUrl:(0,r.wrapAwayIfExternal)(e.link.url)||"",linkText:e.link.text||"",linkType:""}),a}},65664:(e,t,i)=>{i.d(t,{createStoriesService:()=>n});var _=i(32489),o=i(47020),s=i(63349),r=i(46118),a=i(77871);const n=({domain:e})=>{const t=e.createEvent("fire/storiesGet"),i=e.createEvent("fire/storiesGetById"),n=e.createEvent("fire/storiesGetArchive"),l=e.createEvent("fire/storiesGetViewers"),d=e.createEvent("fire/storiesGetReplies"),c=e.createEvent("fire/storiesGetQuestions"),p=e.createEvent("fire/storiesGetStats"),u=e.createEvent("fire/storiesGetDetailedStats"),h=e.createEvent("fire/storiesMarkSkipped"),m=e.createEvent("fire/storiesMarkNotInterested"),E=e.createEvent("fire/storiesMarkSeen"),b=e.createEvent("fire/storiesHidePrivacyBlock"),w=e.createEvent("fire/storiesDelete"),g=e.createEvent("fire/storiesAskQuestion"),f=e.createEvent("fire/storiesDeleteQuestion"),P=e.createEvent("fire/storiesBanQuestionAuthor"),O=e.createEvent("fire/storiesUnbanQuestionAuthor"),M=e.createEvent("fire/storiesMarkAppNotificationsSeen"),D=e.createEvent("fire/storiesSubscribeUserToApp"),v=e.createEvent("fire/storiesGetPhotoUploadServer"),T=e.createEvent("fire/storiesGetVideoUploadServer"),A=e.createEvent("fire/storiesSave"),I=e.createEvent("fire/storiesSearch"),S=e.createEvent("fire/storiesUnbanOwner"),C=e.createEvent("fire/storiesBanOwner"),y=e.createEvent("fire/storiesSetDiscoverVisible"),k=e.createEvent("fire/storiesHideReply"),R=e.createEvent("fire/storieHideAllReplies"),B=e.createEffect("fx/storiesGet"),U=e.createEffect("fx/storiesGetById"),L=e.createEffect("fx/storiesGetArchive"),W=e.createEffect("fx/storiesGetViewers"),K=e.createEffect("fx/storiesGetReplies"),N=e.createEffect("fx/storiesGetQuestions"),x=e.createEffect("fx/storiesGetStats"),F=e.createEffect("fx/storiesGetDetailedStats"),H=e.createEffect("fx/storiesMarkSkipped"),G=e.createEffect("fx/storiesMarkNotInterested"),V=e.createEffect("fx/storiesMarkSeen"),z=e.createEffect("fx/storiesHidePrivacyBlock"),j=e.createEffect("fx/storiesDelete"),q=e.createEffect("fx/storiesAskQuestion"),Y=e.createEffect("fx/storiesDeleteQuestion"),Q=e.createEffect("fx/storiesBanQuestionAuthor"),$=e.createEffect("fx/storiesUnbanQuestionAuthor"),X=e.createEffect("fx/storiesMarkAppNotificationsSeen"),J=e.createEffect("fx/storiesSubscribeUserToApp"),Z=e.createEffect("fx/storiesGetPhotoUploadServer"),ee=e.createEffect("fx/storiesGetVideoUploadServer"),te=e.createEffect("fx/storiesSave"),ie=e.createEffect("fx/storiesSearch"),_e=e.createEffect("fx/storiesUnbanOwner"),oe=e.createEffect("fx/storiesBanOwner"),se=e.createEffect("fx/storiesSetDiscoverVisible"),re=e.createEffect("fx/storiesHideReply"),ae=e.createEffect("fx/storiesHideAllReplies"),ne=(0,s.createFriendsAddFx)({domain:e}),le=(0,s.createFriendsDeleteFx)({domain:e}),de=(0,r.createGroupsJoinFx)({domain:e}),ce=(0,r.createGroupsLeaveFx)({domain:e});return B.use(o.apiStoriesGet),U.use(o.apiStoriesGetById),L.use(o.apiStoriesGetArchive),W.use(o.apiStoriesGetViewers),K.use(o.apiStoriesGetReplies),N.use(o.apiStoriesGetQuestions),x.use(o.apiStoriesGetStats),F.use(o.apiStoriesGetDetailedStats),H.use(o.apiStoriesMarkSkipped),G.use(o.apiStoriesMarkNotInterested),V.use(o.apiStoriesMarkSeen),z.use(o.apiStoriesHidePrivacyBlock),j.use(o.apiStoriesDelete),q.use(o.apiStoriesAskQuestion),Y.use(o.apiStoriesDeleteQuestion),Q.use(o.apiStoriesBanQuestionAuthor),$.use(o.apiStoriesUnbanQuestionAuthor),X.use(o.apiStoriesMarkAppNotificationsSeen),J.use(o.apiStoriesSubscribeUserToApp),Z.use(o.apiStoriesGetPhotoUploadServer),ee.use(o.apiStoriesGetVideoUploadServer),te.use(o.apiStoriesSave),ie.use(o.apiStoriesSearch),oe.use(o.apiStoriesBanOwner),_e.use(o.apiStoriesUnbanOwner),se.use(o.apiStoriesSetDiscoverVisible),re.use(o.apiStoriesHideReply),ae.use(o.apiStoriesHideAllReplies),(0,a.connectTrackTmrGroupsJoin)(de),(0,_.sample)({clock:t,target:B}),(0,_.sample)({clock:i,target:U}),(0,_.sample)({clock:n,target:L}),(0,_.sample)({clock:l,target:W}),(0,_.sample)({clock:d,target:K}),(0,_.sample)({clock:c,target:N}),(0,_.sample)({clock:p,target:x}),(0,_.sample)({clock:u,target:F}),(0,_.sample)({clock:h,target:H}),(0,_.sample)({clock:m,target:G}),(0,_.sample)({clock:E,target:V}),(0,_.sample)({clock:b,target:z}),(0,_.sample)({clock:w,target:j}),(0,_.sample)({clock:g,target:q}),(0,_.sample)({clock:f,target:Y}),(0,_.sample)({clock:P,target:Q}),(0,_.sample)({clock:O,target:$}),(0,_.sample)({clock:M,target:X}),(0,_.sample)({clock:D,target:J}),(0,_.sample)({clock:v,target:Z}),(0,_.sample)({clock:T,target:ee}),(0,_.sample)({clock:A,target:te}),(0,_.sample)({clock:I,target:ie}),(0,_.sample)({clock:S,target:_e}),(0,_.sample)({clock:C,target:oe}),(0,_.sample)({clock:y,target:se}),(0,_.sample)({clock:k,target:re}),(0,_.sample)({clock:R,target:ae}),{fireGet:t,fireGetById:i,fireGetArchive:n,fireGetViewers:l,fireGetReplies:d,fireGetQuestions:c,fireGetStats:p,fireGetDetailedStats:u,fireMarkSkipped:h,fireMarkNotInterested:m,fireMarkSeen:E,fireHidePrivacyBlock:b,fireDelete:w,fireAskQuestion:g,fireDeleteQuestion:f,fireBanQuestionAuthor:P,fireUnbanQuestionAuthor:O,fireMarkAppNotificationsSeen:M,fireSubscribeUserToApp:D,fireGetPhotoUploadServer:v,fireGetVideoUploadServer:T,fireSave:A,fireSearch:I,fireUnbanOwner:S,fireBanOwner:C,fireSetDiscoverVisible:y,fireHideReply:k,fireHideAllReplies:R,getFx:B,getByIdFx:U,getArchiveFx:L,getViewersFx:W,getRepliesFx:K,getQuestionsFx:N,getStatsFx:x,getDetailedStatsFx:F,markSkippedFx:H,markNotInterestedFx:G,markSeenFx:V,hidePrivacyBlockFx:z,deleteFx:j,askQuestionFx:q,deleteQuestionFx:Y,banQuestionAuthorFx:Q,unbanQuestionAuthorFx:$,markAppNotificationsSeenFx:X,subscribeUserToAppFx:J,getPhotoUploadServerFx:Z,getVideoUploadServerFx:ee,saveFx:te,searchFx:ie,unbanOwnerFx:_e,banOwnerFx:oe,setDiscoverVisibleFx:se,hideReplyFx:re,hideAllRepliesFx:ae,friendsAddFx:ne,friendsDeleteFx:le,groupsJoinFx:de,groupsLeaveFx:ce}}},35850:(e,t,i)=>{i.d(t,{pollsService:()=>h,storiesDomain:()=>p,storiesService:()=>u});var _=i(32489),o=i(13167),s=i(40817),r=i(24521),a=i(69946),n=i(95030),l=i(50770),d=i(51468),c=i(3343);const p=(0,_.createDomain)("stories"),u=(0,o.createStoriesService)({domain:p}),h=((0,s.createStatsService)({domain:p}),(0,r.createNarrativesService)({domain:p}),(0,a.createLikesService)({domain:p}),(0,n.createMessagesService)({domain:p}),(0,l.createFaveService)({domain:p}),(0,d.createPollsService)({domain:p}));(0,c.createUserService)({domain:p})},72950:(e,t,i)=>{function _(e){return(e?.split("_")??[]).map(Number)}function o(e,t="windows-1251"){return new TextDecoder(t).decode(function(e){const t=atob(e);return Uint8Array.from(t,(e=>e.codePointAt(0)||0))}(e))}i.d(t,{decodeBase64:()=>o,splitStoryRawId:()=>_})},15220:(e,t,i)=>{i.d(t,{updateArticleSnippetsFromQueueByPost:()=>a});var _=i(59926),o=i(77004),s=i(48370);i(77608),i(68078),i(49988),i(49794),i(58172),i(95910),i(84255),i(33763);const r="article_snippet";function a(e){if(!window.vk.id)return;if(!(0,s.partConfigEnabled)("update_private_snippets_by_queue"))return;const t=Array.from(e.querySelectorAll(`.${r}`));if(!t.length)return;const i=[];t.forEach((e=>{if(!window.vk.id||!e.dataset.needUpdate)return;const t=e.dataset.articleRawId;t&&i.push({article_raw_id:t,post_raw_id:e.dataset.postId,is_mini_snippet:(0,o.intval)(e.dataset.isMiniSnippet)})})),i.length&&window.ajax.post("al_articles.php",{act:"get_snippets",article_snippets:JSON.stringify(i)},{onDone:e=>{t.forEach((t=>{t.dataset.articleRawId&&e[t.dataset.articleRawId]&&(t.outerHTML=e[t.dataset.articleRawId])}))},onFail:()=>((0,_.logError)(new Error("Fail: updateArticleSnippetsFromQueueByPost")),!0)})}},92322:(e,t,i)=>{i.d(t,{init:()=>l});var _=i(74777),o=i(97403),s=i(30185),r=i(87558),a=i(9383),n=i(59926);const l=()=>{(0,_.init)(),(0,o.tqi)().setHandler("Common/nav_go",(e=>{e.payload.event?.target&&window.nav.go(e.payload.event.target,e.payload.event,JSON.parse(e.payload.dataAttrs?.options||"{}"))}),!1),(0,o.tqi)().setHandler("Common/cur_box_hide",(()=>{(0,s.curBox)()?.hide()}),!1),(0,o.tqi)().setHandler("Common/show_menu_settings",(e=>{const t=e.payload.dataAttrs?.type?Number(e.payload.dataAttrs.type):void 0;(0,r.loadMenuSettingsBox)(t)}),!1),(0,o.tqs)().setHandler("HelpHints/init",(({payload:{target:e}})=>{e?.remove(),(0,a.ensureAccountHelpHintsService)().initialize({viewerId:window.vk?.id,logErrorFn:n.logError})}),!0)}},30227:(e,t,i)=>{i.d(t,{highlightModule:()=>d});var _=i(55860),o=i(25256),s=i(825),r=i(51998),a=i(9314);let n,l;function d(e){const t=document.getElementById(e.module);if(!t||!t.classList.contains("module"))return;window.cur.__narrowBarForceNotFixed=!0;const i=e.speed?e.speed:300;(0,s.scrollToY)((0,r.getXY)(t)[1]-100,i);const d=()=>{n&&(n.hideTT(),(0,s.enableBodyScroll)(),delete window.cur.__narrowBarForceNotFixed,(0,o.updateNarrow)(),e.onClose&&e.onClose())};n=new _.default(t,e.text,{highlight:!0,width:250,offset:[0,-17],side:"bottom",withCloseButton:!0,onBGClick:d,onCloseButtonClick:d}),n.show(),(0,s.disableBodyScroll)(),e.autoCancelDelay&&(l=setTimeout((()=>{d(),l=null}),e.autoCancelDelay),(0,a.pushNavDestroy)((()=>{l&&clearTimeout(l)})))}},39521:(e,t,i)=>{i.d(t,{getStoryList:()=>s,removeStoryList:()=>r,setApiStoryList:()=>a,setStoryList:()=>o,transformApiStoryList:()=>n});var _=i(45552);function o(e,t){window.cur[`stories_list_${e}`]=t}function s(e){return window.cur[`stories_list_${e}`]}function r(e){delete window.cur[`stories_list_${e}`]}function a(e,t){o(e,n(e,t))}function n(e,t){return(0,_.transformStoryGetApiResponseToLegacyFormat)(t,e,!1)}},94468:(e,t,i)=>{i.d(t,{updateNarrativeSnippetsFromQueueByPost:()=>r});i(51998),i(30185),i(30227),i(33763),i(77004);var _=i(59926),o=i(48370);i(4884),i(39521);const s="NarrativeSnippet";function r(e){if(!window.vk.id)return;if(!(0,o.partConfigEnabled)("update_private_snippets_by_queue"))return;const t=Array.from(e.querySelectorAll(`.${s}`));if(!t.length)return;const i=[];t.forEach((e=>{if(!window.vk.id||!e.dataset.needUpdate)return;const t=e.dataset.narrativeRawId;t&&i.push({narrative_raw_id:t,snippet_type:e.dataset.snippetType,from:e.dataset.from})})),i.length&&window.ajax.post("al_stories.php",{act:"get_narrative_snippets",narrative_snippets:JSON.stringify(i)},{onDone:e=>{t.forEach((t=>{t.dataset.narrativeRawId&&e[t.dataset.narrativeRawId]&&(t.outerHTML=e[t.dataset.narrativeRawId])}))},onFail:()=>((0,_.logError)(new Error("Fail: updateNarrativeSnippetFromQueueByPost")),!0)})}},58172:(e,t,i)=>{e.exports=i.p+"icons/d7ccdb168db391d6a891.png"}},__webpack_module_cache__={},deferred,leafPrototypes,getProto,inProgress,loadStylesheet,installedCssChunks;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__webpack_require__),i.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=(e,t,i,_)=>{if(!t){var o=1/0;for(n=0;n<deferred.length;n++){for(var[t,i,_]=deferred[n],s=!0,r=0;r<t.length;r++)(!1&_||o>=_)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[r])))?t.splice(r--,1):(s=!1,_<o&&(o=_));if(s){deferred.splice(n--,1);var a=i();void 0!==a&&(e=a)}}return e}_=_||0;for(var n=deferred.length;n>0&&deferred[n-1][2]>_;n--)deferred[n]=deferred[n-1];deferred[n]=[t,i,_]},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var i=Object.create(null);__webpack_require__.r(i);var _={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var o=2&t&&e;"object"==typeof o&&!~leafPrototypes.indexOf(o);o=getProto(o))Object.getOwnPropertyNames(o).forEach((t=>_[t]=()=>e[t]));return _.default=()=>e,__webpack_require__.d(i,_),i},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,i)=>(__webpack_require__.f[i](e,t),t)),[])),__webpack_require__.u=e=>5458===e?"api/widgets/chunks/hls.a261ab69.js":3214===e?"api/widgets/chunks/SilentModeForms.1bbef692.js":1830===e?"api/widgets/chunks/65672ab0.async.8d5863e8.js":4835===e?"api/widgets/chunks/unauth_action_box.c44341cb.js":6929===e?"api/widgets/chunks/40fc1172.async.2c6ab2c9.js":1943===e?"api/widgets/chunks/VideoUpload.78654fa1.js":9886===e?"api/widgets/chunks/StoryPublisherV2.1c97e755.js":6694===e?"api/widgets/chunks/menu_settings.5f383319.js":9311===e?"api/widgets/chunks/feed-client-nav-skeleton.96226646.js":6091===e?"api/widgets/chunks/feed-client-nav-async-right-block.b4276484.js":1715===e?"api/widgets/chunks/AudioLongtapModal.2899532d.js":1713===e?"api/widgets/chunks/voice_message_player.229c43fb.js":9925===e?"api/widgets/chunks/speech.12e33f06.js":5805===e?"api/widgets/chunks/PublishClipToVideoModal.9a2c1fcb.js":1906===e?"api/widgets/chunks/VideoUploadModal.e220eaaf.js":4205===e?"api/widgets/chunks/VideoExternalUploadModal.f048414c.js":6637===e?"api/widgets/chunks/ClipUploadModal.2f05f9d5.js":9370===e?"api/widgets/chunks/VideoEditorModal.81924144.js":8493===e?"api/widgets/chunks/AddClipToVideoBlock.6e503edb.js":504===e?"api/widgets/chunks/StoriesCreatorVKApp.4611981f.js":4833===e?"api/widgets/chunks/performance-stats.bf4160f3.js":2643===e?"api/widgets/chunks/story_blocks.957e90e8.js":264===e?"api/widgets/chunks/videoplayer-interactive.a8e013e8.js":953===e?"api/widgets/chunks/AddClipToVideoModal.40eb8932.js":274===e?"api/widgets/chunks/ClipPlayerModule.1b4f6189.js":7520===e?"chunks/7520.b04816fb.js":2211===e?"chunks/2211.c2a12169.js":2974===e?"chunks/2974.b0547f48.js":void 0,__webpack_require__.miniCssF=e=>3214===e?"api/widgets/chunks/122e7a6e.css":9886===e?"api/widgets/chunks/2ca69ba8.css":6694===e?"api/widgets/chunks/9c700d95.css":1715===e?"api/widgets/chunks/6c6b10bc.css":5805===e?"api/widgets/chunks/70c35bc4.css":{1906:1,4205:1,6637:1}[e]?"api/widgets/chunks/a26bdf61.css":9370===e?"api/widgets/chunks/96685c4b.css":8493===e?"api/widgets/chunks/85bd25a0.css":2643===e?"api/widgets/chunks/9ca0c429.css":953===e?"api/widgets/chunks/d66415b4.css":274===e?"api/widgets/chunks/a9cca8ef.css":void 0,__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},__webpack_require__.l=(e,t,i,_)=>{if(inProgress[e])inProgress[e].push(t);else{var o,s;if(void 0!==i)for(var r=document.getElementsByTagName("script"),a=0;a<r.length;a++){var n=r[a];if(n.getAttribute("src")==e||n.getAttribute("data-webpack")=="vk:"+i){o=n;break}}o||(s=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,__webpack_require__.nc&&o.setAttribute("nonce",__webpack_require__.nc),o.setAttribute("data-webpack","vk:"+i),o.src=e),inProgress[e]=[t];var l=(t,i)=>{o.onerror=o.onload=null,clearTimeout(d);var _=inProgress[e];if(delete inProgress[e],o.parentNode&&o.parentNode.removeChild(o),_&&_.forEach((e=>e(i))),t)return t(i)},d=setTimeout(l.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=l.bind(null,o.onerror),o.onload=l.bind(null,o.onload),s&&document.head.appendChild(o)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="/dist/",loadStylesheet=e=>new Promise(((t,i)=>{var _=__webpack_require__.miniCssF(e),o=__webpack_require__.p+_;if(((e,t)=>{for(var i=document.getElementsByTagName("link"),_=0;_<i.length;_++){var o=(r=i[_]).getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(o===e||o===t))return r}var s=document.getElementsByTagName("style");for(_=0;_<s.length;_++){var r;if((o=(r=s[_]).getAttribute("data-href"))===e||o===t)return r}})(_,o))return t();((e,t,i,_)=>{var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.onerror=o.onload=s=>{if(o.onerror=o.onload=null,"load"===s.type)i();else{var r=s&&("load"===s.type?"missing":s.type),a=s&&s.target&&s.target.href||t,n=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");n.code="CSS_CHUNK_LOAD_FAILED",n.type=r,n.request=a,o.parentNode.removeChild(o),_(n)}},o.href=t,document.head.appendChild(o)})(e,o,t,i)})),installedCssChunks={4592:0},__webpack_require__.f.miniCss=(e,t)=>{installedCssChunks[e]?t.push(installedCssChunks[e]):0!==installedCssChunks[e]&&{274:1,953:1,1715:1,1906:1,2643:1,3214:1,4205:1,5805:1,6637:1,6694:1,8493:1,9370:1,9886:1}[e]&&t.push(installedCssChunks[e]=loadStylesheet(e).then((()=>{installedCssChunks[e]=0}),(t=>{throw delete installedCssChunks[e],t})))},(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={4592:0};__webpack_require__.f.j=(t,i)=>{var _=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==_)if(_)i.push(_[2]);else{var o=new Promise(((i,o)=>_=e[t]=[i,o]));i.push(_[2]=o);var s=__webpack_require__.p+__webpack_require__.u(t),r=new Error;__webpack_require__.l(s,(i=>{if(__webpack_require__.o(e,t)&&(0!==(_=e[t])&&(e[t]=void 0),_)){var o=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;r.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",r.name="ChunkLoadError",r.type=o,r.request=s,_[1](r)}}),"chunk-"+t,t)}},__webpack_require__.O.j=t=>0===e[t];var t=(t,i)=>{var _,o,[s,r,a]=i,n=0;if(s.some((t=>0!==e[t]))){for(_ in r)__webpack_require__.o(r,_)&&(__webpack_require__.m[_]=r[_]);if(a)var l=a(__webpack_require__)}for(t&&t(i);n<s.length;n++)o=s[n],__webpack_require__.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return __webpack_require__.O(l)},i=self.webpackChunkvkwidgets=self.webpackChunkvkwidgets||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var __webpack_exports__=__webpack_require__.O(void 0,[8598,9204,2368,7523,6701,6550,7974,994,7032,6667,6492,7985],(()=>__webpack_require__(91959)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();