(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[80731],{962444:_=>{_.exports={reactions_preview_item:'<div class="ReactionsPreviewItem ReactionsPreviewItem--stackOverlay %class%" style="background-image: url(\'%image_url%\');" aria-label="%title%"></div>'}},144301:(_,e,t)=>{"use strict";function o(){return{icon:'<svg fill="none" height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><path d="M3.53 2.46a.75.75 0 0 0-1.07 1.07L4.94 6 2.46 8.47a.75.75 0 1 0 1.07 1.07L6 7.06l2.47 2.48a.75.75 0 0 0 1.07-1.07L7.06 6l2.48-2.47a.75.75 0 1 0-1.07-1.07L6 4.94z" fill="currentColor"/></svg>',name:"cancel_12"}}t.d(e,{getIcon12Cancel:()=>o})},376331:(_,e,t)=>{"use strict";function o(){return{icon:'<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><g id="user_outline_20__Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="user_outline_20__Icons-20/user_outline_20"><g id="user_outline_20__user_outline_20"><path opacity=".1" d="M0 0h20v20H0z"/><path d="M12.5 5a2.5 2.5 0 1 0-5 0 2.5 2.5 0 0 0 5 0ZM14 5a4 4 0 1 1-8 0 4 4 0 0 1 8 0ZM4 15.5c0 .72.36 1 1 1h10c.64 0 1-.28 1-1 0-2.33-2.57-3.5-6-3.5s-6 1.17-6 3.5Zm-1.5 0c0-3.48 3.33-5 7.5-5s7.5 1.52 7.5 5c0 1.63-1.1 2.5-2.5 2.5H5c-1.4 0-2.5-.87-2.5-2.5Z" id="user_outline_20__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></g></svg>',name:"user_outline_20"}}t.d(e,{getIcon20UserOutline:()=>o})},161360:(_,e,t)=>{"use strict";function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M12.73 11.48a.75.75 0 0 1 .94-.5 7.26 7.26 0 0 1 1.64.71 4.22 4.22 0 0 1 2.15 3.2.75.75 0 0 1-1.49.19 2.72 2.72 0 0 0-1.43-2.1 5.76 5.76 0 0 0-1.3-.56.75.75 0 0 1-.5-.94ZM6 5a4 4 0 1 1 4 4 .75.75 0 0 1 0-1.5A2.5 2.5 0 1 0 7.5 5 .75.75 0 0 1 6 5ZM3.22 17.36c.45.42 1.08.64 1.78.64h9.44l.78.78a.75.75 0 1 0 1.06-1.06L3.78 5.22a.75.75 0 0 0-1.06 1.06l4.48 4.48c-.95.2-1.8.5-2.51.93A4.23 4.23 0 0 0 2.5 15.5c0 .81.27 1.44.72 1.86Zm2.24-4.38A2.74 2.74 0 0 0 4 15.5c0 .46.14.67.25.77.12.11.35.23.75.23h7.94l-4.42-4.42c-1.27.13-2.31.45-3.06.9Z" clip-rule="evenodd"/></svg>',name:"user_slash_outline_20"}}t.d(e,{getIcon20UserSlashOutline:()=>o})},716578:(_,e,t)=>{"use strict";function o(){return{icon:'<svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M16.87 2c1.79 0 2.43.19 3.08.53.66.35 1.17.86 1.52 1.52s.53 1.3.53 3.08v9.74c0 1.79-.19 2.43-.53 3.08a3.63 3.63 0 0 1-1.52 1.52c-.65.34-1.3.53-3.08.53H7.13c-1.79 0-2.43-.19-3.08-.53s-1.17-.86-1.52-1.52C2.2 19.3 2 18.65 2 16.87V7.13c0-1.79.19-2.43.53-3.08.35-.66.86-1.17 1.52-1.52C4.7 2.2 5.35 2 7.13 2zm.57 2H6.56c-.89 0-1.21.1-1.54.27-.32.17-.58.43-.75.75-.18.33-.27.65-.27 1.54v10.88c0 .89.1 1.21.27 1.54.17.32.43.58.75.75.33.18.65.27 1.54.27h10.88c.89 0 1.21-.1 1.54-.27.32-.17.58-.43.75-.75.18-.33.27-.65.27-1.54V6.56c0-.89-.1-1.21-.27-1.54a1.82 1.82 0 0 0-.75-.75c-.33-.18-.65-.27-1.54-.27z" fill="currentColor"/></svg>',name:"check_box_off_24"}}t.d(e,{getIcon24CheckBoxOff:()=>o})},193086:(_,e,t)=>{"use strict";function o(){return{icon:'<svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M2.44 4.18C2 5.04 2 6.16 2 8.4v7.2c0 2.24 0 3.36.44 4.22a4 4 0 0 0 1.74 1.74c.86.44 1.98.44 4.22.44h7.2c2.24 0 3.36 0 4.22-.44a4 4 0 0 0 1.74-1.74c.44-.86.44-1.98.44-4.22V8.4c0-2.24 0-3.36-.44-4.22a4 4 0 0 0-1.74-1.74C18.96 2 17.84 2 15.6 2H8.4c-2.24 0-3.36 0-4.22.44a4 4 0 0 0-1.74 1.74zM18.2 9.21a1 1 0 0 0-1.42-1.42L10 14.6l-2.8-2.8a1 1 0 0 0-1.4 1.42l3.5 3.5a1 1 0 0 0 1.4 0z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"check_box_on_24"}}t.d(e,{getIcon24CheckBoxOn:()=>o})},391016:(_,e,t)=>{"use strict";t.d(e,{Handler:()=>c});var o=t(961019),i=t(499061),s=t(288326),l=t(340257),a=t(705744),n=t(7144),r=t(581903),d=t(407033),E=t(476726);class c{get successDescriptor(){return`${this.params.originalHandlerName||this.params.handlerName}Result`}get errorDescriptor(){return`${this.params.originalHandlerName||this.params.handlerName}Failed`}get previousCallsCount(){return this.app?.context?.getHandlerCallsCount(this.params.handlerName)-1||0}shouldLogStat(){return!0}shouldLogCallArgumentsInStat(){return(0,E.partConfigEnabled)("mini_apps_send_stat_arguments_bridge_events")&&Array.isArray(this.app?.bridgeMethodsToBeLogged)&&this.app.bridgeMethodsToBeLogged.includes(this.params.handlerName)}getEventHash(_=!1){return cur.app.options[`${l.VK_CONNECT_EVENTS[`${this.params.handlerName}${_?"Preload":""}`]}_hash`]}getEventHashes(_=!1){return cur.app.options[`${l.VK_CONNECT_EVENTS[`${this.params.handlerName}${_?"Preload":""}`]}_hashes`]}getEventName(_=!1){return l.VK_CONNECT_EVENTS[`${this.params.handlerName}${_?"Preload":""}`]}sendNetworkError(){this.errorHandler({code:l.ERROR_CODES.UNKNOWN,error_type:l.ERROR_TYPES.CLIENT,reason:l.ERROR_REASONS.UNKNOWN_ERROR})}sendConnectionLostError(){this.errorHandler({code:l.ERROR_CODES.CONNECTION_LOST,error_type:l.ERROR_TYPES.CLIENT,reason:l.ERROR_REASONS.CONNECTION_LOST})}sendUserDeniedError(){this.errorHandler({code:l.ERROR_CODES.USER_DENIED,error_type:l.ERROR_TYPES.CLIENT,reason:l.ERROR_REASONS.USER_DENIED})}handleApiError(_){const e=_?.error,t=e?.error_msg,o=e?.error_code;if(o)switch(o){case d.API_ERROR_ACCESS:this.errorHandler({code:l.ERROR_CODES.ACCESS_DENIED,error_type:l.ERROR_TYPES.CLIENT,reason:t});break;case d.API_ERROR_PARAM:this.errorHandler({code:l.ERROR_CODES.INVALID_PARAMS,error_type:l.ERROR_TYPES.CLIENT,reason:t});break;default:this.errorHandler({code:l.ERROR_CODES.CUSTOM,error_type:l.ERROR_TYPES.CLIENT,reason:t||l.ERROR_REASONS.UNKNOWN_ERROR})}else this.errorHandler({code:l.ERROR_CODES.CONNECTION_LOST,error_type:l.ERROR_TYPES.CLIENT,reason:t||l.ERROR_REASONS.UNKNOWN_ERROR})}sendCustomError(_){this.errorHandler({code:l.ERROR_CODES.CUSTOM,reason:_||l.ERROR_REASONS.UNKNOWN_ERROR})}checkParams(_,e){for(let t=0;t<e.length;t++){const{param:o,type:i,isRequired:s,extraChecks:a}=e[t];if(!_.hasOwnProperty(o)&&s)return this.errorHandler({code:l.ERROR_CODES.MISSING_PARAM,reason:`Missing required param "${o}"`}),!1;if(_.hasOwnProperty(o)&&typeof _[o]!==i)return this.errorHandler({code:l.ERROR_CODES.INVALID_PARAMS,reason:`Param "${o}" should be ${i}`},this.callback),!1;if(_.hasOwnProperty(o)&&a&&a.length>0)for(let e=0;e<a.length;e++)if(!a[e].check(_[o]))return this.errorHandler({code:l.ERROR_CODES.INVALID_PARAMS,reason:a[e].error(o)},this.callback),!1}return!0}actionHandler(_){return this.callApi?ajax.post("apps.php",{act:"handle_vk_connect_event",hash:this.getEventHash(),event:this.getEventName(),app_id:this.app.appId,..._},{onDone:e=>{this.handleResponse(e,_,this.checkResponse)},onFail:_=>(this.errorHandler(_),!0)}):{}}checkResponse(_){1===_||0===_?this.successHandler(Boolean(_)):this.successHandler(_)}scopeStringToArray(_){return _?_.replace(/ /g,"").split(","):[]}denyUIAction(){this.errorHandler({error_type:"client_error",code:l.ERROR_CODES.USER_DENIED},null),o.default.pop(this.modal)}allowUIAction(_){this.actionHandler(_),o.default.pop(this.modal)}createDenyUIAction(_){this.params.modal.cancelAction=void 0!==_?()=>this.denyUIAction(_):this.denyUIAction}createAllowUIAction(_){this.params.modal.allowAction=void 0!==_?()=>this.allowUIAction(_):this.allowUIAction}launchUI(_){this.createDenyUIAction(),this.createAllowUIAction(),this.modal=new s.UIAction({...this.params.modal,..._}),o.default.push(this.modal)}_enhanceBtnsWithActions(){this.params.modal.buttons&&this.params.modal.buttons.forEach(((_,e)=>{"deny"===_.type?this.params.modal.buttons[e].action=this.params.modal.cancelAction:this.params.modal.buttons[e].action=this.params.modal.allowAction}))}setData(_,e,t=null){t&&(this.callback=t),_.request_id&&(this.params.request_id=_.request_id),this.params.modal||(this.params.modal={}),_.containerId&&(this.params.modal.containerId=_.containerId),_.pic&&(this.params.modal.pic=_.pic),this.app=e,this.shouldLogCallArgumentsInStat()&&(this.callArguments=_)}handleResponse(_,e,t,o){try{const o=JSON.parse(_);o.hasOwnProperty("error")?this.errorHandler(o.error):t(o,e)}catch(_){o?o(_):this.errorHandler(_)}}handler(_,e,t){if(this.setData(_,e),this.callback=t,this.isWebOnly&&(0,a.isMvk)()||this.isMobileWebOnly&&!(0,a.isMvk)())return this.errorHandler({code:l.ERROR_CODES.UNSUPPORTED_PLATFORM,error_type:l.ERROR_TYPES.CLIENT,reason:l.ERROR_REASONS.UNSUPPORTED_PLATFORM});this.useUI?this.launchUI(_):this.useUI||this.actionHandler(_)}getAppWebviewUrl(){return cur.app.frame.src}cleanCallArguments(_){const e=["request_id","handlerName","method","modal","containerId","pic"];for(const t of e)delete _[t];return _}getSerializedCallArguments(){if(!this.shouldLogCallArgumentsInStat()||!this.callArguments)return null;const _=this.cleanCallArguments({...this.callArguments});let e=JSON.stringify(_);return e.length>l.BRIDGE_STAT_CALL_ARGUMENTS_MAX_LENGTH&&(e=null),e}successHandler(_,e=void 0){if("function"==typeof e&&e(),(0,n.isObject)(_)||(_={result:_}),this.params.request_id&&_&&(_.request_id=this.params.request_id),this.callback({type:this.successDescriptor,data:_},this.params.handlerName),(0,a.isMvk)()&&cur.app.frame.focus(),this.shouldLogStat()){const _=this.getSerializedCallArguments();r.bridgeEventItemStat.logEvent(this.getAppWebviewUrl(),this.app.appId,{event_type:this.params.handlerName,is_success:!0,..._?{call_arguments:_}:{}},void 0,this.app.vkApp.sessionUuid)}}errorHandler(_,e,t){"string"==typeof _&&(_={reason:_}),this.params.request_id&&_&&(_.request_id=this.params.request_id);const o=new i.default(this.errorDescriptor,_,t),s=o.selectErrorType();if("function"==typeof e&&e(s),this.callback(s),(0,a.isMvk)()&&cur.app.frame.focus(),this.shouldLogStat()){const _=this.getSerializedCallArguments();r.bridgeEventItemStat.logEvent(this.getAppWebviewUrl(),this.app.appId,{event_type:this.params.handlerName,is_success:!1,..._?{call_arguments:_}:{}},{error_type:o.type||l.ERROR_TYPES.CLIENT,error_code:o.data.code||l.ERROR_CODES.UNKNOWN},this.app.vkApp.sessionUuid,o.getReadableMessage())}}constructor(_={}){this.params={handlerName:"handler",method:"method",..._},this.callApi=!0,this.useUI=!1,this.callback=null,this.modal=null,this.isWebOnly=!1,this.isMobileWebOnly=!1,this.callArguments=null,this.actionHandler=this.actionHandler.bind(this),this.errorHandler=this.errorHandler.bind(this),this.successHandler=this.successHandler.bind(this),this.denyUIAction=this.denyUIAction.bind(this),this.allowUIAction=this.allowUIAction.bind(this),cur.vkAppSuccessHandler=this.successHandler,cur.vkAppErrorHandler=this.errorHandler,this.checkResponse=this.checkResponse.bind(this),this.getSerializedCallArguments=this.getSerializedCallArguments.bind(this)}}},712466:(_,e,t)=>{"use strict";t.d(e,{VKWebAppCustomMessage:()=>r});var o=t(603943),i=t(391016),s=t(957081),l=t(705744),a=t(340257),n=t(76773);class r extends i.Handler{actionHandler(_){if(_.action&&_.payload){if(this.app.isTextliveApp){const e=window.Textlives?.onBridgeEvent(_);return void(e&&e.then(this.successHandler).catch(this.errorHandler))}if(this.app.appId===a.NFT_APP_ID)return this.handleSetNftAvatar(_),void this.successHandler({result:!0});if(this.app.appId===a.ORD_APP_ID)return this.handleSetOrdData(_),void this.successHandler({result:!0});if(this.app.appId===a.VMOJI_CONSTRUCTOR_APP_ID)return this.handleOpenStickerPicker(_),void this.successHandler({result:!0})}this.errorHandler("unknown error")}handleSetNftAvatar({action:_,payload:e}){"VKWebAppSetNFTAvatar"===_&&((0,l.isMvk)()?window.OwnerPhotoUpload2.setNftAvatar(e):window.ajax.post("al_page.php",{act:"owner_avatar_upload",oid:e?.oid},{onDone:(_,t)=>{window.handleVKBridgeSetNftAvatar(e,_,t)}}))}handleOpenStickerPicker({action:_,payload:e}){if("vmoji_character_recereate"!==_)return;const{promo:t,page:i}=e;t&&(0,s.isNewStickerPicker)()&&!(0,l.isMvk)()&&(window.StickerPickerViewer?.showLastPicker(o.ServicePackKey.VMOJI),i?.match("/preview")||window.stManager.add(window.jsc("web/vmoji.js")).then((()=>{window.Vmoji.showAddedToStickerSnackbar()})))}handleSetOrdData({action:_,payload:e}){"ord_data"===_&&e&&(0,n.getStore)().onOrdData({is_ad:e.isAd||!1,ord_pred_id:e.predId||"",erid:e.erId||""})}constructor(_){super(_),this.params.handlerName="VKWebAppCustomMessage"}}},334052:(_,e,t)=>{"use strict";t.d(e,{ModalStackOld:()=>o});class o{push(_){_.init(),this.checkStack(),0===cur.vkMiniAppsStack.length&&_.show(),cur.vkMiniAppsStack.push(_)}clearLayerPopups(){this.checkStack(),cur.vkMiniAppsStack.length>0&&(cur.vkMiniAppsStack=cur.vkMiniAppsStack.filter((_=>!~_.appNode.id.indexOf("container_layer"))))}pop(_){const e=cur.vkMiniAppsStack.indexOf(_);~e&&(cur.vkMiniAppsStack.splice(e,1),this.checkForNext())}shift(){cur.vkMiniAppsStack=cur.vkMiniAppsStack.slice(1),this.checkForNext()}checkForNext(){cur.vkMiniAppsStack.length>0&&cur.vkMiniAppsStack[0].show()}constructor(){this.checkStack=()=>{cur.vkMiniAppsStack||(cur.vkMiniAppsStack=[])},this.checkStack(),cur.clearVKMiniAppsLayerPopups=this.clearLayerPopups.bind(this)}}},288326:(_,e,t)=>{"use strict";t.d(e,{CLOSE_BUTTON_MODES:()=>p,UIAction:()=>M,renderCounter:()=>O,setCounter:()=>D});var o=t(705744),i=t(241936),s=t(287841),l=t(52661),a=t(626490),n=t(787576),r=t(221844),d=t(193086),E=t(716578),c=t(476726);const p={INNER:0,OUTER:1},u="success",P="deny",b="extra",O=_=>{const e=document.createElement("span");return e.classList.add("VkAppModal__buttonCounter"),e.innerText=_,e},D=(_,e)=>{const t=_.find((_=>_.hasCounter));t&&t.counterElement&&(t.counterElement.innerText=e)};class M{addScroll(){(0,i.addPopupScroll)(this.modal.children[0],this.modalParentLayer)}init(){this.containerNode&&this.containerNode.appendChild(this.modal),this.modalParentLayer=this.modal.closest(".layer_wrap"),!1!==this.props.withScroll&&(this.modalParentLayer?this.modalParentLayer.addEventListener("scroll",this.addScroll):window.addEventListener("scroll",this.addScroll))}show(){(0,o.isMvk)()&&document.body.classList.add("vk_app_fixed"),this.props.withoutAnimation?this.modal.classList.add("show"):setTimeout((()=>this.modal.classList.add("show")),300),this.initMvkCloseActions(),this.addScroll()}initMvkCloseActions(){(0,o.isMvk)()&&(window.DirectGames&&cur.app.isDirectGame&&window.DirectGames.onBoxOpen(this),this.props.onlyButtonHide||(this.modal.onclick=_=>{_.target===this.modal&&this.onAction(this.props.cancelAction)}))}close(){this.props.onlyButtonHide||this.onAction(this.props.cancelAction)}destroy(){!1!==this.props.withScroll&&(window.removeEventListener("scroll",this.addScroll),this.modalParentLayer&&this.modalParentLayer.removeEventListener("scroll",this.addScroll)),this._destroyed||((0,o.isMvk)()&&(document.body.classList.remove("vk_app_fixed"),window.DirectGames&&cur.app.isDirectGame&&(window.DirectGames.onBoxClose(this),cur.app.frame.focus())),this.modal.parentNode.removeChild(this.modal),this.callback&&this.callback(),this._destroyed=!0)}_disableButton(_,e=!0){_.disabled=e,_.element.disabled=e}_lockButton(_,e=!0){const t=(0,o.isMvk)()?(0,l.getIcon24Spinner)().icon:(0,a.getIcon16Spinner)().icon,i=`\n    <span class="vk_app_modal_btn__content">${_.title}</span>\n    <span class="vk_app_modal_btn__spinner">${t}</span>\n    `;_.loading=e,_.element.innerHTML=e?i:_.title,_.element.classList.toggle("vk_app_modal_btn--loading",e)}async onAction(_){await _(),this.destroy()}lockButtons(_=!0){const e={[u]:this._lockButton,[P]:this._disableButton,[b]:this._disableButton};this.props.buttons.forEach((t=>e[t.type](t,_)))}_setCounter(_){D(this.props.buttons,_)}_renderBtn(_){const e=document.createElement("button");if(e.setAttribute("type","button"),e.classList.add("vk_app_modal_btn"),e.classList.add(`vk_app_modal_btn--${_.type}`),e.innerText=_.title,e.addEventListener("click",(()=>_.type===b?_.action():this.onAction(_.action))),_.hasCounter){const t=O(0);e.appendChild(t),_.counterElement=t}return _.element=e,_.disabled&&this._disableButton(_),_.loading&&this._lockButton(_),e}_renderBtns(_){const e=_.querySelector(".vk_app_modal_btns"),{buttons:t}=this.props;if(e){t.forEach((_=>e.appendChild(this._renderBtn(_))));const _=t.find((_=>_.type===b));1===t.length&&e.classList.add("vk_app_modal_btns--single-btn"),_&&e.classList.add("vk_app_modal_btns--hasExtraButton")}}_renderCloseBtn(_){const e=document.createElement("button");e.setAttribute("type","button"),e.classList.add("vk_app_modal_close_btn"),(0,o.isMvk)()||this.props.closeButtonMode!==p.OUTER?e.innerHTML=(0,r.getIcon24Cancel)().icon:(e.classList.add("vk_app_modal_close_btn--outer"),e.innerHTML=(0,n.getIcon20Cancel)().icon),e.addEventListener("click",(()=>this.onAction(this.props.cancelAction))),_.children[0].appendChild(e)}_renderCheckboxFields(_,e){const t=document.createElement("div");t.classList.add("MiniAppsCheckbox__fields");const o=document.createElement("h5");if(o.classList.add("MiniAppsCheckbox__fields-title"),o.innerHTML=_,t.appendChild(o),e){const _=document.createElement("h6");_.classList.add("MiniAppsCheckbox__fields-description"),_.innerHTML=e,t.appendChild(_)}return t}_renderCheckbox(_){const{title:e,description:t,...i}=_,s=document.createElement("label");s.classList.add("MiniAppsCheckbox");const l=document.createElement("input");if(l.type="checkbox",l.classList.add("MiniAppsCheckbox__checkbox"),l.addEventListener("change",(e=>_.checked=e.target.checked)),s.appendChild(l),Object.entries(i).forEach((([_,e])=>{l[_]=e})),(0,o.isMvk)()){const _=document.createElement("div");_.classList.add("MiniAppsCheckbox__fake_checkbox","MiniAppsCheckbox__fake_checkbox--checked"),_.innerHTML=(0,d.getIcon24CheckBoxOn)().icon,s.appendChild(_);const e=document.createElement("div");e.classList.add("MiniAppsCheckbox__fake_checkbox","MiniAppsCheckbox__fake_checkbox--unchecked"),e.innerHTML=(0,E.getIcon24CheckBoxOff)().icon,s.appendChild(e)}else{const _=document.createElement("div");_.classList.add("MiniAppsCheckbox__fake_checkbox"),s.appendChild(_)}const a=this._renderCheckboxFields(e,t);return s.appendChild(a),s}_renderCheckboxWrap(_){const e=_.querySelector(".MiniAppsModalCheckbox");e&&this.props.checkbox.map((_=>e.appendChild(this._renderCheckbox(_))))}_renderOuter(){const _=document.createElement("div");return _.classList.add("vk_app_modal_outer"),_}_enhanceBtnsWithActions(){this.props.buttons&&this.props.buttons.forEach(((_,e)=>{_.type===P?this.props.buttons[e].action=this.props.cancelAction:_.type===b?this.props.buttons[e].action=this.props.extraAction:this.props.buttons[e].action=this.props.allowAction}))}_renderScopes(_){return _.map(((_,e)=>{const t=getLang(`vkapps_scope_${_}`);return 0===e?t:t.toLowerCase()})).join(", ")}prepareScopes(_){return 0===_.length?["general"]:_}prepareExtraBtn(){const _=document.createElement("button");return _.setAttribute("type","button"),_.classList.add("vk_app_modal_btn","VkAppModal__button--extra","vk_app_modal_btn--transparent"),_.innerHTML=getLang("apps_connect_modal_messages_scopes_edit"),_.addEventListener("click",this.props.extraAction),_}getThumb(){if(this.props.svgIcon)return this.props.svgIcon;const _=this.props.picClass?this.props.picClass:"";return this.props.pic?`<img src="${this.props.pic}" class="vk_app_modal_container__pic MiniAppModalContainer__pic ${_}" alt aria-label="product">`:""}isHorizontalLayoutSupported(){return(0,o.isMvk)()&&(0,c.partConfigEnabled)("vk_bridge_modals_horizontal_layout")}renderModal(){this.props.containerClass=this.props.containerClass||"",this.props.buttonsClass=this.props.buttonsClass||"",this.props.isGradientModal&&(0,o.isMvk)()&&(this.props.containerClass+=" MiniAppsGradientModal"),this.props.isNoWrapButtons&&(0,o.isMvk)()&&(this.props.buttonsClass+=" MiniAppsNoWrapButtons");const _=this.props.scopes&&this.props.scopes.length&&this.props.extraAction;this.isHorizontalLayoutSupported()&&(this.props.containerClass+=" VkAppModal__Container--horizontalSupport",_&&(this.props.containerClass+=" VkAppModal__Container--withExtraButton"));let e=`\n    <div class="vk_app_modal_container vk_app_modal_container--flex ${this.props.containerClass||""}">\n      <div class="vk_app_modal_content">\n        ${this.getThumb()}\n        <h2 class="vk_app_modal_container__heading">${this.props.title}</h2>\n        ${this._renderSubheading()}\n        ${this._renderTextSeparator()}\n        ${this._renderText(this.props.text)}\n      `;this.props.scopes&&(e+=`\n          <p class="vk_app_modal_container__text">${getLang("apps_connect_modal_messages_scopes_text")}</p>\n          <p class="vk_app_modal_container__list">${this._renderScopes(this.prepareScopes(this.props.scopes))}.</p>`),e+=`\n          </div>\n          ${this.props.checkbox?'<div class="MiniAppsModalCheckbox"></div>':""}\n          <div class="vk_app_modal_btns ${this.props.buttonsClass}"></div>\n      </div>`,this._enhanceBtnsWithActions(),this.modal=this._renderOuter(),this.modal.innerHTML=e,this.props.showCloseBtn&&this._renderCloseBtn(this.modal),_&&this.modal.getElementsByClassName("vk_app_modal_content")[0].appendChild(this.prepareExtraBtn()),this._renderBtns(this.modal),this.props.checkbox&&this._renderCheckboxWrap(this.modal),this.props.scopes&&this._setCounter(this.props.scopes.length)}_renderText(_){if(!_)return"";return(Array.isArray(_)?_:[_]).map((_=>`<p class="vk_app_modal_container__text">${_}</p>`)).join("")}_renderSubheading(){return this.props.subheading?`<h3 class="vk_app_modal_container__subheading">${this.props.subheading}</h3>`:""}_renderTextSeparator(){return this.props.isTextSeparated?'<div class="vk_app_modal_container__text_separator"></div>':""}constructor(_,e){this.props={..._},e&&(this.callback=e),this.props.buttons=this.props.buttons||[],this.containerNode=document.getElementById(this.props.containerId),this.modal=null,this.modalParentLayer=null,this.onAction=this.onAction.bind(this),this.addScroll=(0,s.throttle)(this.addScroll.bind(this),i.THROTTLE_TIME),this.renderModal(),this._destroyed=!1}}},241936:(_,e,t)=>{"use strict";t.d(e,{THROTTLE_TIME:()=>i,addPopupScroll:()=>s});var o=t(705744);const i=300,s=(_,e)=>{const t=e?e.scrollTop:window.pageYOffset,i=window.cur.app;if(i&&!(0,o.isMvk)()){const e=50*(Boolean(window.vk?.rtl)?1:-1),o=i.frame.clientHeight-360,s=Math.max(103,Math.min(t,o)+102);requestAnimationFrame((function(){_.style.transform=`translateX(${e}%) translateY(${s}px)`}))}}},499061:(_,e,t)=>{"use strict";t.d(e,{default:()=>i});var o=t(340257);const i=class{_errorStrucuture(_,e){let t={type:this.method,data:{error_type:this.type,error_data:{error_code:_}}};return this.type===o.ERROR_TYPES.API?(t.data.error_data.error_msg=e,this.data.request_params&&(t.data.error_data.request_params=this.data.request_params)):t.data.error_data.error_reason=e,this.data.request_id&&(t.data.request_id=this.data.request_id),this.data.description&&(t.data.error_data.error_description=this.data.description),t}getReadableMessage(){const{error_reason:_,error_msg:e,error_description:t}=this.selectErrorType().data.error_data;return _||e||t}selectErrorType(){if(!this.data.hasOwnProperty("code"))return this.data.hasOwnProperty("error_code")?this._errorStrucuture(this.data.error_code,this.data.error_msg||o.ERROR_REASONS.UNKNOWN_ERROR):this.data.error_msg&&"operation denied by user"===this.data.error_msg.toLowerCase()?this._errorStrucuture(o.ERROR_CODES.USER_DENIED,"User denied"):this._errorStrucuture(o.ERROR_CODES.UNKNOWN,this.data.reason||this.data.error_msg||o.ERROR_REASONS.UNKNOWN_ERROR);switch(this.data.code){case o.ERROR_CODES.MISSING_PARAM:return this._errorStrucuture(o.ERROR_CODES.MISSING_PARAM,this.data.reason||"Missing required params or wrong type of param");case o.ERROR_CODES.CONNECTION_LOST:return this._errorStrucuture(o.ERROR_CODES.CONNECTION_LOST,this.data.reason||o.ERROR_REASONS.CONNECTION_LOST);case o.ERROR_CODES.USER_DENIED:return this._errorStrucuture(o.ERROR_CODES.USER_DENIED,this.data.reason||o.ERROR_REASONS.USER_DENIED);case o.ERROR_CODES.INVALID_PARAMS:return this._errorStrucuture(o.ERROR_CODES.INVALID_PARAMS,this.data.reason||o.ERROR_REASONS.INVALID_PARAMS);case o.ERROR_CODES.ACCESS_DENIED:return this._errorStrucuture(o.ERROR_CODES.ACCESS_DENIED,this.data.reason||o.ERROR_REASONS.ACCESS_DENIED);case o.ERROR_CODES.CUSTOM:return this._errorStrucuture(o.ERROR_CODES.CUSTOM,this.data.reason||this.data.error_msg);case o.ERROR_CODES.REQUESTS_LIMIT_REACHED:return this._errorStrucuture(o.ERROR_CODES.REQUESTS_LIMIT_REACHED,"Requests limit reached");case o.ERROR_CODES.UNKNOWN:return this._errorStrucuture(o.ERROR_CODES.UNKNOWN,o.ERROR_REASONS.UNKNOWN_ERROR);default:return this._errorStrucuture(this.data.code?this.data.code:o.ERROR_CODES.UNKNOWN,this.data.reason||this.data.error_msg||o.ERROR_REASONS.UNKNOWN_ERROR)}}constructor(_,e,t=o.ERROR_TYPES.CLIENT){this.data=e||{},this.method=_,this.type=t}}},422109:(_,e,t)=>{"use strict";t.d(e,{destroyOpenedApp:()=>l,filterPostMessageOrigin:()=>n,getHostName:()=>s,isAllowedPostMessageOriginHost:()=>r,isVKPayApp:()=>a,objectToQuerystring:()=>i});var o=t(340257);const i=(_,e="?",t=!1)=>Object.keys(_).reduce(((o,i,s)=>[o,0===s?e:"&",encodeURIComponent(i),"=",t&&Array.isArray(_[i])?_[i].map(encodeURIComponent).join(","):encodeURIComponent(_[i])].join("")),""),s=_=>{const e=_.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);return null!=e&&e.length>2&&"string"==typeof e[2]&&e[2].length>0?e[2].toLowerCase():null},l=_=>{if(cur.vkAppQueue){const e=Object.keys(cur.vkAppQueue).filter((e=>~e.indexOf(_)));if(e.length>0){const _=e[0];cur.vkAppQueue[_].destroyView(),delete cur.vkAppQueue[_]}}},a=_=>o.VKPAY_APPS.includes(_);function n(_,e){const t=s(e),o=_.vkApp?_.vk_app_url:_.src,i=s(o);if(t!==i&&!r(_,t))throw Error(`Insecure method call from ${t}. Call must be from ${i}`);return!0}function r(_,e){if(!_.allowed_origin_regexp)return!1;return new RegExp(_.allowed_origin_regexp).test(e)}},487434:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _web_audio_player_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(671300),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(714209),_web_lib_market__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(174628),_shared_lib_site__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(705744),_web_wall_post_subscribe_action_post_subscribe_action__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(603370),_web_wall_post_update_view_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(948585),_web_wall_wall_post_elem_utils__WEBPACK_IMPORTED_MODULE_94__=__webpack_require__(489944),_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(8520),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(610989),_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_96__=__webpack_require__(741531),_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_97__=__webpack_require__(165753),_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(452314),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(788407),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(317412),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(810903),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(20025),_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(248298),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(250682),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(879007),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(850101),_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(756758),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(688701),_web_lib_fx__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(663878),_web_lib_video__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(744025),_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(645024),_shared_lib_convert__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(387674),_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(967886),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(618913),_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(691004),_web_lib_utils__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(507035),_web_donut__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(367571),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(280800),_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(30884),_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(53117),_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(145309),_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(7144),_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(898971),_web_wall_deep_replies_utils__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(815578),_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(37645),_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(524679),_web_wall_wall_post_render__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(414505),_web_wall_wall_utils__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(899623),_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(70517),_web_lib_date__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(307188),_shared_donut_stats_donut_log__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(529397),_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(858723),_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(824738),_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__(768354),_web_reports_reports__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__(678041),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__(476726),_web_likes_helpers__WEBPACK_IMPORTED_MODULE_93__=__webpack_require__(630298),_icons_desktop__WEBPACK_IMPORTED_MODULE_88__=__webpack_require__(376331),_icons_desktop__WEBPACK_IMPORTED_MODULE_89__=__webpack_require__(161360),_icons_desktop__WEBPACK_IMPORTED_MODULE_90__=__webpack_require__(448114),_icons_desktop__WEBPACK_IMPORTED_MODULE_91__=__webpack_require__(144301),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__(258643),_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__(330326),_web_stickers_utils__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__(550072),_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__(123121),_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__(134020),_web_profile_profile_utils__WEBPACK_IMPORTED_MODULE_52__=__webpack_require__(857031),_shared_components_avatar_renderAvatarToString__WEBPACK_IMPORTED_MODULE_53__=__webpack_require__(793241),_shared_utils_reflow__WEBPACK_IMPORTED_MODULE_95__=__webpack_require__(405504),_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_92__=__webpack_require__(171444),_web_Badges_constants__WEBPACK_IMPORTED_MODULE_54__=__webpack_require__(545284),_web_ecomm_onboarding_Tooltips_services_TooltipEventService__WEBPACK_IMPORTED_MODULE_55__=__webpack_require__(919514),_shared_ranges__WEBPACK_IMPORTED_MODULE_56__=__webpack_require__(388078),_web_attachments_view_selector_init_view_ui_selector__WEBPACK_IMPORTED_MODULE_57__=__webpack_require__(511714),_web_attachments_view_selector_utils__WEBPACK_IMPORTED_MODULE_58__=__webpack_require__(740328),_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_59__=__webpack_require__(152314),_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__=__webpack_require__(221123),_web_ord_utils__WEBPACK_IMPORTED_MODULE_61__=__webpack_require__(906357),_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_62__=__webpack_require__(499048),_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__=__webpack_require__(681589),_web_Badges_helpers__WEBPACK_IMPORTED_MODULE_64__=__webpack_require__(194440),_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__=__webpack_require__(214249),_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_66__=__webpack_require__(695290),_shared_production_stats_click_feed_post_interaction__WEBPACK_IMPORTED_MODULE_67__=__webpack_require__(782784),_shared_feed_feed_utils__WEBPACK_IMPORTED_MODULE_68__=__webpack_require__(2432),_shared_short_video_utils__WEBPACK_IMPORTED_MODULE_69__=__webpack_require__(946709),_web_feed_components_text_stats__WEBPACK_IMPORTED_MODULE_70__=__webpack_require__(155207),_web_stickers_Stickers_helpers__WEBPACK_IMPORTED_MODULE_71__=__webpack_require__(815019),_web_feed_feed_stats__WEBPACK_IMPORTED_MODULE_72__=__webpack_require__(468189),_vkontakte_internal_vkjs_lib_API__WEBPACK_IMPORTED_MODULE_73__=__webpack_require__(933052),_shared_counters_tmr__WEBPACK_IMPORTED_MODULE_74__=__webpack_require__(141229),_shared_stickers_refactor_constants__WEBPACK_IMPORTED_MODULE_75__=__webpack_require__(524258),_shared_production_stats_click_feed_comments_sort_tab_click__WEBPACK_IMPORTED_MODULE_76__=__webpack_require__(777901),_web_feed_utils_miscellaneous__WEBPACK_IMPORTED_MODULE_77__=__webpack_require__(197971),_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__=__webpack_require__(996456),_shared_pixels__WEBPACK_IMPORTED_MODULE_79__=__webpack_require__(761085),_web_posting_carousel_components_CarouselRatioSelector_initCarouselRatioSelector__WEBPACK_IMPORTED_MODULE_80__=__webpack_require__(205712),_web_posting_carousel_components_utils__WEBPACK_IMPORTED_MODULE_81__=__webpack_require__(964032),_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_82__=__webpack_require__(719583),_shared_feed_stats_click_three_dots__WEBPACK_IMPORTED_MODULE_83__=__webpack_require__(804794),_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__=__webpack_require__(645084),_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__=__webpack_require__(417552),_shared_evbus__WEBPACK_IMPORTED_MODULE_86__=__webpack_require__(823875),_web_smoke_guard_smoke_screen_locator__WEBPACK_IMPORTED_MODULE_87__=__webpack_require__(528549);const renderReactCarousel=(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__.makeReactCarouselRenderer)(),Wall={LS_ADS_EVENTS:"ads.events",postponedPosts:null,deleteAll:function(_,e,t){ajax.post("al_wall.php",{act:"delete_all",post:e,hash:t},{onDone:function(e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_));t.oldt=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(t,e)},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_).appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{className:"progress"})))},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(_))}})},restoreAll:function(_,e,t){const o=Math.floor(1e5*Math.random());cur.wallRnd=o,ajax.post("al_wall.php",{act:"restore_all",post:e,hash:t,rnd:o},{onDone:function(e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(t,t.oldt)},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_).appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("span",{className:"progress_inline"})))},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(_))}})},deleteThread:function(_,e,t){ajax.post("al_wall.php",{act:"delete_thread",post:e,hash:t,from_deleted:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+e),"reply_deleted")},{onDone:function(t){let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("dld_inner",_);if(o)o.oldElements=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(o,t);else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+e),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("reply_wrap",_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(i),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{id:"post_del"+e,className:"dld",innerHTML:'<span class="dld_inner">'+t+"</span>"}),_.appendChild(o)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("replies_wrap_deep"+e)},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(_);const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post_actions",_);if(e)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(e,"post_actions_progress");else{let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(_);e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{className:"progress"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_).appendChild(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(e))}},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(_);const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post_actions",_);e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(e,"post_actions_progress"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(_))}})},restoreThread:function(_,e,t){ajax.post("al_wall.php",{act:"restore_thread",post:e,hash:t},{onDone:function(){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("replies_wrap_deep"+e),t.oldElements)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(t,t.oldElements);else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("reply_wrap","post"+e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)("post_del"+e)}},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(_);let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(_);e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{className:"progress"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_).appendChild(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(e))},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(_))}})},block:function(_,e,t,o,i){ajax.post("al_wall.php",{act:"block",post:e,hash:t,bl:o,from:i},{onDone:function(e){o?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_).insertBefore((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("span",{innerHTML:e}),_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(_)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_))),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_)))},showProgress:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.showProgress)(_,"post_inline_progress","post_inline_progress",!0)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)("post_inline_progress")}})},blockEx:function(_,e){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showBox)("groupsedit.php",{act:"bl_edit",name:"id"+e,gid:_,auto:1},{stat:["page.css","ui_controls.js","ui_controls.css"]})},withMentions:!(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mozilla&&_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.version.match(/^2\./)||_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mobile),editPost:function(_,e,t,o,i){if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsUpdateEnabled)()&&Wall.postponedPosts?.isLocked())return;if(cur.editingPost&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wpe_text")){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wall_posts",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wpe_text"));if(!_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(_))return o&&o(),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.notaBene)("wpe_text");Wall.cancelEdit()}if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("feed_post_menu_stats")){const e=_ instanceof HTMLElement?(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.getTrackCodeFromPost)(_):null;_shared_feed_stats_click_three_dots__WEBPACK_IMPORTED_MODULE_83__.FeedPostMenuStats.editPost(e,(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.resolveRefFromCur)())}let s=null;(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_36__.isInlineCommentsEnabled)()&&(s=_?.closest?.(".reply_inline"),s?.classList.remove("reply_inline"),s?.setAttribute("data-inline-comment-editing","")),cur.editingPost=[e],Wall.withMentions?window.stManager.add(["ui_controls.css","ui_controls.js",window.jsc("web/wall_edit.js")]):window.stManager.add([window.jsc("web/wall_edit.js")]);ajax.post("al_wall.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({act:"edit",post:e,mention:Wall.withMentions?1:""},t),{onDone:async function(..._){if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(_[4])&&cur.options&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(cur.options.filter_media_types)){const e=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(_[4],(function(_,t){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(cur.options.filter_media_types,(function(_,o){if(t[0]===o[0])return e.push(o),!1}))})),_[4]=e}_.unshift(e),t&&t.fromAds&&_.push(t.fromAds);const[o,s,l,a,n,r,d]=_;WallEdit.editPost.call(window,o,s,l,a,n,r,d),i&&i()},onFail:()=>{cur.editingPost=!1,(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_36__.isInlineCommentsEnabled)()&&(s?.classList.add("reply_inline"),s?.removeAttribute("data-inline-comment-editing")),o&&o()},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockActionsMenuItem)(_):_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.isFlatButton(_)?_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.lock(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("post_actions","post"+e),"post_actions_progress")},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockActionsMenuItem)(_):_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.isFlatButton(_)?_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.unlock(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("post_actions","post"+e),"post_actions_progress")},noSort:!0})},fixPost:function(link,post,hash,value){return ajax.post("al_wall.php",{act:"a_fix_post",post,hash,value},{onDone:function(js){if(js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_24__.logEvalError)(_,js)}const postEl=cur.wallLayer==post?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+post);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("post_fixed"),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(this,"post_fixed")})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(postEl,"post_fixed",value),link&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(link,value?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_unfix_post"):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_fix_post")),link.onclick=function(){return Wall.fixPost(link,post,hash,value?0:1)}),cur.onWKFix&&(cur.onWKFix(value),delete cur.onWKFix)},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(link,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockActionsMenuItem)(link):_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton.pbind("wpe_fix"+post)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(link,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockActionsMenuItem)(link):_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton.pbind("wpe_fix"+post)}}),!1},cancelEdit:function(_){if(cur.editingPost){if(!0===_&&cur.editingPost[0].match(/^-?\d+_/))return;window.WallEdit?WallEdit.cancelEditPost():cur.editingPost=!1}},searchWall:function(){},switchTabContent:function(_){switch((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("page_wall_posts","page_postponed_posts","page_suggested_posts","page_search_posts","page_top_posts","page_archive_posts","page_donut_posts"),_){case"own":case"all":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("page_wall_posts");break;case"postponed":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("page_postponed_posts"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("wall_more_link");break;case"suggested":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("page_suggested_posts");break;case"search":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("page_search_posts");break;case"top":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("page_top_posts");break;case"archive":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("page_archive_posts");break;case"donut":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("page_donut_posts")}},switchWall:function(_,e,t){if(e&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.checkEvent)(e))return!0;if(t||(t="own"==cur.wallType?"all":"own"),e&&"click"==e.type&&e.clientX&&e.offsetX&&cur.wallTab==t&&cur.wallType==t&&"top"!==t)return nav.go(_,e);if("postponed"==cur.wallTab&&(console.log("clean up on switch wall"),Wall.postponedPosts?.cleanUp(),wall.checkPostponedCount(),uiTabs.hideSort()),"archive"!==cur.wallTab&&"archive"!==t||((cur.wallLayer?wkcur:cur).wallMyDeleted={}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(cur.wallArchiveFeatureTooltipHide)&&cur.wallArchiveFeatureTooltipHide(),!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.inArray)(t,["top","archive","donut"])){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_wall_posts");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(_,"own"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(_,"all"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(_,t)}cur.wallType=t,cur.wallTab=t,uiTabs.switchTab(_),uiTabs.hideProgress(_),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.inArray)(t,["top","archive","donut"])?(cur.baseWallModule=cur.module,cur.module="wall_"+t,cur.topWallFeatureTT&&cur.topWallFeatureTT.hide()):cur.baseWallModule&&(cur.module=cur.baseWallModule,delete cur.baseWallModule);const o="donut"===t&&Wall.cantAccessDonutPosts();return Wall.hasPosts()||o?(Wall.update(),Wall.showWall()):(cur.wallNextFrom=0,cur.wallTopNextFrom=0,cur.wallArchiveNextFrom=0,cur.wallArchiveRestored=0,cur.wallArchiveArchived=0,cur.wallArchiveRolledback=0,cur.wallDonutNextFrom=0,"top"===t?delete cur.wallTopFinished:"archive"===t?delete cur.wallArchiveFinished:"donut"===t&&delete cur.wallDonutFinished,uiTabs.showProgress(_),Wall.showMore(0,_)),_?.dataset?.donutLogEvent&&(0,_shared_donut_stats_donut_log__WEBPACK_IMPORTED_MODULE_41__.logDonutEvent)(_.dataset.donutLogEvent),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(e)},resetWall:function(){if(cur.wallType&&cur.wallTab){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_wall_tab_"+cur.wallType);_&&(cur.wallNextFrom=0,cur.wallTopNextFrom=0,cur.wallArchiveNextFrom=0,(cur.wallLayer?wkcur:cur).wallMyDeleted={},"top"===cur.wallType?delete cur.wallTopFinished:"archive"===cur.wallType?delete cur.wallArchiveFinished:"donut"===cur.wallType&&delete cur.wallDonutFinished,uiTabs.showProgress(_),Wall.showMore(0,_,!0))}},hasPosts:function(_){_=_||cur.wallType;const e=Wall.getPostsWrap(_);return!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("post",e)},getPostsWrap:function(_){switch(_){case"archive":return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_archive_posts");case"top":return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_top_posts");case"donut":return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_donut_posts");default:return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_wall_posts")}},showSuggested:function(ev,rows,notAll){if(ev&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.checkEvent)(ev))return!0;if(!cur.oid)return!1;let el=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_wall_suggest");if(el=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(el,"unshown")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domQuery1)("#page_wall_suggest_more .ui_tab_group_item"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_tab",el),!el)return!1;if(uiTabs.switchTab(el),cur.wallTab="suggested",delete cur.suggestedDeletedCount,void 0!==rows)wall.suggestLoaded(rows,notAll);else{if(cur.suggestedLoading)return!1;const curOid=cur.suggestedLoading=cur.oid;uiTabs.showProgress(el),ajax.post("al_wall.php",{act:"get_suggests",owner_id:cur.oid},{onDone:function(rows,notAll,js,count){if(js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_24__.logEvalError)(_,js)}cur.suggestedLoading=!1,uiTabs.hideProgress(el),Wall.updateTabCounter("page_wall_suggested_cnt",count),curOid===cur.oid&&"suggested"==cur.wallTab&&wall.suggestLoaded.apply(window,arguments)}})}return!1},deleteSuggested:function(_,e,t,o){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isButtonLocked)(o))return;(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton)(o);const i=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_action_confirmation"),onHide:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton)(o)}},_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_delete_suggested_box"),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_delete_suggested_btn"),(function(o){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isButtonLocked)(o)||((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton)(o),ajax.post("al_wall.php",{act:"delete_suggested",post_id:_,hash:t,group_id:e},{onDone:function(_){if("full_own"==cur.wallType||"full_all"==cur.wallType){const e=(Math.ceil(_/cur.pgPerPage)-1)*cur.pgPerPage;e<cur.pgOffset&&(e>0?nav.objLoc.offset=e:delete nav.objLoc.offset,nav.setLoc(nav.objLoc)),nav.reload()}else Wall.showSuggested();i.hide()},showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton)(o),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton)(o)}))}),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_cancel"))},suggestLoaded:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_suggested_posts",_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggle)("wall_more_link",e),wall.switchTabContent("suggested")},suggestMore:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_suggested_posts"),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_more_link");(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isButtonLocked)(e)||ajax.post("al_wall.php",{act:"get_suggests",owner_id:cur.oid,offset:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("post",_).length-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("dld",_).length},{onDone:function(t,o){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{innerHTML:t});let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domFC)(i);for(;s;)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(s.id)||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(s,"post")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(s):_.appendChild(s),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domFC)(i);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggle)(e,o)},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton.pbind(e),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton.pbind(e)})},suggestUpdate:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_suggests_count");let t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(e));e&&(-1!==_&&1!==_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(e,t+=_),Wall.updateTabCounter("page_wall_suggested_cnt",t))},suggestPublished:function(_,e,t){if(cur.onepost)return nav.go("/wall"+cur.oid);if(Wall.suggestUpdate(-1),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.showDoneBox)(e),cur.wallMyDeleted[_]=1,cur.editingPost=!1,Wall.deinitComposer((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wpe_text")),Wall.deinitHashtagComposer((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wpe_text")),"full_own"!=cur.wallType&&"full_all"!=cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),cur.postWpeIsPoster=!!cur.posterWpeSendParams,cur.posterWpe&&cur.posterWpeSendParams&&WallEdit.posterDestroy(),t){const _=document.getElementById("page_postponed_posts");let e="";(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsActResult)(t)?(Wall.postponedPosts?.updateState({postsSize:t.count}),wall.postponeUpdateCount(Wall.postponedPosts?.getPostsSize()),e=t.rendered_posts):(wall.postponeUpdateCount(),e=t),_&&(_.innerHTML=e)}if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_suggests_count")))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)("post"+_);else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_rmenu");_?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_rmenu_item",_).click(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_wall_menu_suggested",_))):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_tabs")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_tab",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_tabs")).click(),wall.updateTabVisibility("page_wall_suggest",!1))}},showDonutWall:function(_){if(!cur.oid)return!1;const e="donut";Wall.updateTabVisibility("page_wall_donut",!0);const t=Wall.getWallTabLink(e);if(!t)return!1;uiTabs.switchTab(t),cur.wallTab=e,cur.wallType=e,void 0!==_&&Wall.donutWallSetRows(_)},donutWallSetRows(_){const e="donut",t=Wall.getPostsWrap(e);t&&(t.innerHTML=_,Wall.switchTabContent(e),Wall.update())},getWallTabLink:_=>{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(`page_wall_${_}`);return((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(e,"unshown")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domQuery1)(`#page_wall_${_}_more .ui_tab_group_item`):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_tab",e))||null},showPostponedFull:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("ui_rmenu_postponed"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_wall_posts");if(!e||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(e,"ui_rmenu_item_sel")||!t){const _={0:nav.objLoc[0],postponed:1};return nav.go(_)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(t,_),FullWall.updateSummary((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("post",t).length)},initPostponedSort(){const _=document.querySelector(".js-ui_tab_sort_wrap");function e(){Wall.postponedPosts?.toggleSort(),Wall.showPostponed({},void 0,!0)}return _?.addEventListener("click",e),()=>{_?.removeEventListener("click",e)}},showPostponed:function(_,e,t=!1){if(_&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.checkEvent)(_)&&!t)return!0;if(!cur.oid)return!1;if("postponed"===cur.wallTab&&!e&&!t)return!1;let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_wall_postponed");if(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(o,"unshown")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domQuery1)("#page_wall_postponed_more .ui_tab_group_item"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_tab",o),!o)return!1;if(uiTabs.switchTab(o),cur.wallTab="postponed",void 0!==e){const _=(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsActResult)(e)?e.rendered_posts:e,t=(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsActResult)(e)?e.count:void 0;Wall.postponedLoaded(_,t),console.log("result",e),(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsFixEnabled)()&&Wall.postponedPosts?.updateState({offset:e.starts_from??0,limit:e.limit,postsSize:e.count}),(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsActResult)(e)&&(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsParallelLoadingEnabled)()?Wall.postponedPosts?.loadAllAfterPosting(e):(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsActResult)(e)&&Wall.postponedPosts?.loadAfterPosting(e)}else{if(cur.postponedLoading)return!1;const _=cur.postponedLoading=cur.oid;uiTabs.showProgress(o);const e=()=>{cur.postponedLoading=!1,uiTabs.hideProgress(o),uiTabs.showSort(),_===cur.oid&&cur.wallTab};(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsFixEnabled)()?Wall.postponedPosts?.canStartInitialLoading()||t?(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsParallelLoadingEnabled)()?(Wall.postponedPosts?.updateState({offset:0,ownerId:window.cur.oid,limit:window.cur.postponedPostsRequestLimit,postsSize:window.cur.postponedPostsCount}),Wall.postponedPosts?.loadInParallel(0,{onLoaded:_=>{e(),Wall.postponedLoaded(_.rendered_posts,_.count)}})):(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsPaginationEnabled)()&&Wall.postponedPosts?.loadInitialForPagination({onLoaded:_=>{e(),Wall.postponedLoaded(_.rendered_posts,_.count)},onError:()=>{cur.postponedLoading=!1,uiTabs.hideProgress(o)}}):(cur.postponedLoading=!1,uiTabs.hideProgress(o),uiTabs.showSort(),wall.switchTabContent("postponed"),Wall.postponedPosts?.loadOnTabReturn()):ajax.post("al_wall.php",{act:"get_postponed",owner_id:cur.oid},{onDone:function(e){cur.postponedLoading=!1,uiTabs.hideProgress(o),_===cur.oid&&"postponed"==cur.wallTab&&Wall.postponedLoaded(e)}})}return!1},showSortTooltip(_,e){(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_11__.showTooltip)(_,{text:e,typeClass:"tt_black",slide:4,shift:[10,8],hasover:1,showdt:50,hidedt:50,dir:"auto"})},postponedLoaded:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_postponed_posts",_),wall.switchTabContent("postponed"),e?wall.postponeUpdateCount(e):wall.postponeUpdateCount()},postponeUpdateCount:function(_){let e=0;if(_)e=_;else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_postponed_posts");if(e=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("post",_).length-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("dld",_).length||0,!_)return}Wall.updateTabCounter("page_wall_postponed_cnt",e)},checkPostponedCount:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("post","page_postponed_posts");let e=0;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(_,(function(){const _=this.id.replace("post","");cur.wallMyDeleted[_]||e++})),e||wall.updateTabVisibility("page_wall_postponed",!1)},updateTabCounter:function(_,e){e=e?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.langNumeric)(e,"%s",!0):"",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)(_).forEach((function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(_,e);const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"ui_tab_group_item")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"default-label",t.innerHTML)}))},updateTabVisibility:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_wall_more_tab");if(t)if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(t))if(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"unshown")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_+"_more","unshown")){let e=!1;cur.wallTabsMorePriority.forEach((function(t){e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"unshown")||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(t,"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(t+"_more","unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(_,"unshown"),e=!0)})),e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(_+"_more","unshown")}}else{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(e,"unshown"))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_+"_more"),"unshown");else{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(e,"unshown");const _=cur.wallTabsLimit-1-(0,_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_39__.getNavigableTabs)(t).length;if(_>0){let e=_;cur.wallTabsMorePriority.forEach((function(_){if(e<=0)return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_+"_more");t&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"unshown")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_),"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(t,"unshown"),e--)}))}}const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("ui_tab_group_item",t);o.length-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("unshown",t).length<=1&&(o.forEach((function(_){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"unshown")||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_.id.replace(/_more$/,"")),"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(_,"unshown"))})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(t,"unshown"))}else{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_),"unshown",!e);const o=(0,_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_39__.getNavigableTabs)(t).length;if(o>cur.wallTabsLimit){let _=o-(cur.wallTabsLimit-1);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("ui_tab_group_item",t).forEach((function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(_,"unshown")})),cur.wallTabsMorePriority.forEach((function(e){if(_<=0)return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(e);t&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"unshown")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(t,"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(e+"_more"),"unshown"),_--)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(t,"unshown"),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.statlogsValueEvent)("wall_more_tab_shown",cur.oid)}}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_),"unshown",!e)},postponedPublished:function(_,e){if(cur.onepost)return nav.go("/wall"+cur.oid);"full_own"!=cur.wallType&&"full_all"!=cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),e&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.showDoneBox)(e),cur.wallMyDeleted[_]=1;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("post",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_postponed_posts")),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_);if(t.length<=1&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.inArray)(o,t)){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_rmenu");_?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_rmenu_item",_).click(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_wall_menu_postponed",_))):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_tabs")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_tab",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_tabs")).click(),wall.updateTabVisibility("page_wall_postponed",!1))}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(o),(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsFixEnabled)()?(Wall.postponedPosts?.removePost(),wall.postponeUpdateCount(Wall.postponedPosts?.getPostsSize())):wall.postponeUpdateCount()},onWallSearchSend:function(_,e){e?Wall.showSearch(e,0):Wall.hideSearch()},showSearch:function(_,e){if(cur.searchLoading&&cur.searchLoading==_||!cur.oid)return!1;const t=cur.oid;cur.wallQuery=cur.searchLoading=_,"search"!=cur.wallTab&&(cur.prevWallTab=cur.wallTab,cur.wallTab="search");const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_more_link"),i=+new Date;return ajax.post("al_wall.php",{act:"s",search:1,q:_,owner_id:cur.oid,offset:e,inline:1,owners_only:1},{onDone:function(s,l,a){if(t!==cur.oid)return;if("search"!=cur.wallTab)return;const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_search_posts");e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(n,""),n.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.cf)(s)),wall.switchTabContent("search"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggle)(o,l<a),o.onclick=Wall.showSearch.pbind(_,l);const r=_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserIdTransitional(cur.oid)?_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.serviceWallUsers:_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.serviceWallGroups,d=+new Date-i;(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.saveSearchAttemptStats)(r,0,a,_,0,0,d)},showProgress:function(){uiSearch.showProgress("wall_search"),e&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton)(o)},hideProgress:function(){cur.searchLoading=!1,uiSearch.hideProgress("wall_search"),e&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton)(o)}}),!1},hideSearch:function(){if(delete cur.wallQuery,!cur.prevWallTab)return;const _=(_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserIdTransitional(cur.oid),_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.serviceWallUsers);(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.removeSearchPositionTracker)(_),cur.wallTab=cur.prevWallTab,cur.prevWallTab=!1,wall.switchTabContent(cur.wallTab),wall.update()},publishPostponedPost:function(_,e,t){(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsUpdateEnabled)()&&Wall.postponedPosts?.isLocked()||(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_action_confirmation"),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_publish_postponed_confirm"),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_publish_postponed_btn"),(function(){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.curBox)().hide(),ajax.post("al_wall.php",{act:"publish_postponed",post:_,from:t,hash:e},{onDone:Wall.postponedPublished.pbind(_),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton.pbind("wpe_publish"+_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton.pbind("wpe_publish"+_)})}),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_cancel"))},publishFreeDonutCopy:function(_,e,t,o){const i=_.currentTarget,s=o?{title:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_warning"),content:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_publish_donut_as_free_confirmation_warn")}:{title:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_publish_donut_as_free_confirmation_title"),content:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_publish_donut_as_free_confirmation_confirm")},l=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(s.title,s.content,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_publish_donut_as_free_confirmation_btn"),(()=>{const _=()=>{l.hide()},o=l.btns.ok[0];ajax.post("al_wall.php",{act:"publish_free_donut_copy",post_id:e,hash:t},{onDone:e=>{Wall.publishFreeDonutCopyDone({menuActionEl:i,message:e}),_()},onFail:()=>{_()},showProgress:()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton)(o)},hideProgress:()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton)(o)}})}),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_cancel"))},publishFreeDonutCopyDone({message:_,menuActionEl:e}){"full_own"!==cur.wallType&&"full_all"!==cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),_&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.showDoneBox)(_,{timeout:3e3}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(e)},cmp:function(_,e){const t=_.length,o=e.length;return t<o?-1:t>o?1:_<e?-1:_>e?1:0},cleanBlocksDefault:["page_top_posts","page_wall_posts","page_archive_posts","page_donut_posts"],cleanBlocks:function(_=Wall.cleanBlocksDefault){_.forEach((function(_){if("page_donut_posts"===_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_donut_info"))return;let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_));for(;e;){const _=e;e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(e),_.tagName&&"input"===_.tagName.toLowerCase()||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(_)}}))},receive:function(_,e,t,o){o=!0===o;const i="top"===(t=t||cur.wallType),s="archive"===t,l="donut"===t,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{innerHTML:_}),n=!!cur.options.revert,r=Wall.getPostsWrap(t),d=[];let E,c,p,u,P=[],b=0;if(o)P=Wall.cleanBlocksDefault;else{const[,_]=[[s,"page_archive_posts"],[i,"page_top_posts"],[l,"page_donut_posts"],[!0,"page_wall_posts"]].find((([_])=>_));P=Wall.cleanBlocksDefault.filter((e=>e!==_)),p=n?r.firstChild:r.lastChild}function O(_){return!!(_&&_.tagName&&"div"===_.tagName.toLowerCase()&&_.id&&"post"===_.id.substr(0,4))&&_.id}Wall.cleanBlocks(P);for(let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(n?a.firstChild:a.lastChild);_;_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(n?a.firstChild:a.lastChild))if("input"!=_.tagName.toLowerCase()){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"post_fixed")||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_.id))if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"_ads_promoted_post"))d.push({el:_,beforePost:O(n?a.firstChild:E),afterPost:O(n?E:a.lastChild)});else{for(;p&&p.tagName&&"div"==p.tagName.toLowerCase()&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(p,"post_fixed")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(p,"_ads_promoted_post")||!i&&!s&&Wall.cmp(p.id,_.id)<0);)p=n?p.nextSibling:p.previousSibling;++b,p?Wall.cmp(p.id,_.id)?(u=p,c=n?p.previousSibling:p.nextSibling,c&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(c,"_ads_promoted_post")&&(u=c),n?r.insertBefore(_,u):r.insertBefore(_,u.nextSibling)):(r.replaceChild(_,p),p=_,--b):n?r.appendChild(_):r.insertBefore(_,r.firstChild),E=_,(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_25__.placeholderSetup)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByTag1)("textarea",_),{fast:1})}}else{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_.id);e?r.replaceChild(_,e):r.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertBefore)(_,r.firstChild):r.appendChild(_)}if(d.length)for(let _=0,e=d.length;_<e;++_){const e=d[_];if(!e.beforePost&&!e.afterPost)continue;let t="no_position";for(let _=n?r.firstChild:r.lastChild;_;_=n?_.nextSibling:_.previousSibling){u=null;const o=O(_);if(o){if(e.beforePost===o?u=_:e.afterPost===o&&(u=_.nextSibling),u&&(u.previousSibling&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(u.previousSibling,"_ads_promoted_post")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(u,"_ads_promoted_post"))){u=null,t="ads_sibling";break}if(u){r.insertBefore(e.el,u),t=!1;break}}}t&&(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.statlogsValueEvent)("debug_watch",1,"js_page_ads_promoted_post_no_position",t)}i&&!b?cur.wallTopFinished=cur.oid:s&&!b?cur.wallArchiveFinished=cur.oid:l&&!b&&(cur.wallDonutFinished=cur.oid),"full_own"!==t&&"full_all"!==t||(Pagination.recache(b),FullWall.updateSummary(cur.pgCount)),Wall.update(),wall.addReplyNames(e),Wall.updateMentionsIndex(),b&&(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_9__.getAudioPlayer)().updateCurrentPlaying()},showMore:function(_,e,t){if(cur.viewAsBox)return cur.viewAsBox();if(cur.wallLayer)return;if("suggested"===cur.wallTab)return Wall.suggestMore();if(cur.wallTypeLoading&&cur.wallTypeLoading[cur.wallType]||"top"===cur.wallType&&cur.wallTopFinished===cur.oid||"archive"===cur.wallType&&cur.wallArchiveFinished===cur.oid||"donut"===cur.wallType&&cur.wallDonutFinished===cur.oid)return;const o=cur.wallType,i="top"===o,s="archive"===o,l="donut"===o,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_more_link"),n=cur.wallLoading=cur.oid,r=i&&!!cur.wallTopOnlyCache;let d="";0!==_&&(d=s?cur.wallArchiveNextFrom:i?cur.wallTopNextFrom:l?cur.wallDonutNextFrom:cur.wallNextFrom),cur.wallTypeLoading=cur.wallTypeLoading||{},cur.wallTypeLoading[o]=!0,t=!0===t&&!_,ajax.post("al_wall.php",{act:"get_wall",owner_id:cur.oid,offset:_,type:o,fixed:cur.options.fixed_post_id||"",wall_start_from:d,onlyCache:r},{local:1,onDone:function(a,r,d,E){return e&&uiTabs.hideProgress(e),n!==cur.oid||o!==cur.wallType?(delete cur.wallLoading,void delete cur.wallTypeLoading[o]):i&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isObject)(a)&&a.wait?(cur.wallTopLoadingDelay=cur.wallTopLoadingDelay?cur.wallTopLoadingDelay+100:200,void(cur.wallTopLoadingDelay<500?setTimeout((function(){delete cur.wallLoading,delete cur.wallTypeLoading[o],Wall.showMore(_)}),cur.wallTopLoadingDelay):(delete cur.wallLoading,delete cur.wallTypeLoading[o],cur.wallTopOnlyCache=!1,Wall.showMore(_)))):(delete cur.wallTopLoadingDelay,cur.wallVideos&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(d,(function(_,e){cur.wallVideos[_]&&(cur.wallVideos[_].list=cur.wallVideos[_].list.concat(e.list))})),s?cur.wallArchiveNextFrom=E:i?cur.wallTopNextFrom=E:l?cur.wallDonutNextFrom=E:cur.wallNextFrom=E,void setTimeout((function(){Wall.receive(a,r,o,t),_||o!==cur.wallType||Wall.showWall(),delete cur.wallLoading,delete cur.wallTypeLoading[o]}),0))},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton.pbind(a),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton.pbind(a)})},showWall:function(){wall.switchTabContent(cur.wallType);const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domClosest)("wall_module",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_wall_posts")))[1];_<(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollGetY)()&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollToY)(_-15)},checkTextLen:function(_,e,t){const o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(Emoji.editableVal(_).replace(/\n\n\n+/g,"\n\n"));if(_.lastLen===o.length&&!t)return void(window.FullWall&&cur.onepost&&FullWall.onePostOnScroll());const i=_.lastLen=o.length,s=(cur.options||{}).max_post_len||(window.mvcur||{}).maxReplyLength,l=i-o.replace(/\n/g,"").length;e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(e),i>s-100||l>4?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(e),e.innerHTML=i>s?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_recommended_exceeded",i-s):l>4?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_recommended_lines",l-4):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("text_N_symbols_remain",s-i)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(e),window.FullWall&&cur.onepost&&FullWall.onePostOnScroll()},checkPostLen:_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_48__.checkPostLen,postChanged:function(_,e){const t=Wall.isPosterEditorOpen();if((t||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)("submit_post"))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("submit_post_box"),"shown")||Wall.showEditPost(void 0,!1,Boolean(e)),vk.id&&!vk.widget&&!cur.options?.no_draft){clearTimeout(cur.postAutosave);const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(cur.oid)==vk.id?Wall.saveDraft:Wall.saveOwnerDraftText.pbind(cur.oid);!0===_?e():cur.postAutosave=setTimeout(e,10===_?10:1e3)}t||(setTimeout((()=>Wall.checkPostLen(window.cur.postField,window.cur.postWarningField,window.cur.sendPostBtn))),setTimeout(Wall.checkPosterAvailability))},ownerDraftKey:function(_){return(0,_web_wall_wall_utils__WEBPACK_IMPORTED_MODULE_38__.buildOwnerDraftKey)(_)},ownerDraftData:function(){return cur.wallDraftData||(cur.wallDraftData={}),cur.wallDraftData},addOwnerDraftMedia:function(_,e){if(cur.options?.no_draft)return;const t=Wall.ownerDraftData(),o=e[0],i=e[1];let s=e[2];t._attach_cache=t._attach_cache||{},s?t._attach_cache[o+i]=s:s=t._attach_cache[o+i],t.attaches=t.attaches||[];const l=ls.get(Wall.ownerDraftKey(_))||{};!1!==o?t.attaches.push([o,i,s,t.attaches.length]):!1===o&&void 0!==i&&(t.attaches=t.attaches.filter((function(_){return _[3]!==i}))),ls.set(Wall.ownerDraftKey(_),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(l,{txt:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clean)(Wall.getDraftData().message||""),medias:t.attaches}))},cleanOwnerDraftMedia:function(_){if(cur.options?.no_draft)return;const e=Wall.ownerDraftData(),t=ls.get(Wall.ownerDraftKey(_))||{};e.attaches=[],ls.set(Wall.ownerDraftKey(_),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({txt:""},t,{medias:[]}))},saveOwnerDraftText:function(_){if(cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia),cur.options?.no_draft)return;const e=Wall.ownerDraftData(),t=ls.get(Wall.ownerDraftKey(_))||{},o=Wall.getDraftData(),i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clean)(o.message||"");let s=null;if(e.txt=i,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(t.medias||{},(function(_,e){switch(e[0]){case"postpone":o.postpone&&(t.medias[_][1]=o.postpone,t.medias[_][2].draft=1);break;case"poll":const e=(cur.wallAddMedia||{}).pollData(!0,!0);e&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(t.medias[_][2],e);break;case"copyright":const i=(cur.wallAddMedia||{}).copyrightData(!0);i&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(t.medias[_][2],i);break;case _web_donut__WEBPACK_IMPORTED_MODULE_27__.ATTACH_DATA_DONUT_DURATION:o[_web_donut__WEBPACK_IMPORTED_MODULE_27__.ATTACH_DATA_DONUT_DURATION]&&(t.medias[_][2]=Object.assign(t.medias[_][2]||{},{[_web_donut__WEBPACK_IMPORTED_MODULE_27__.ATTACH_DATA_DONUT_DURATION]:o[_web_donut__WEBPACK_IMPORTED_MODULE_27__.ATTACH_DATA_DONUT_DURATION]}))}})),i&&o.bkg_id&&(s={id:o.bkg_id},cur.poster&&cur.poster.isCustomBkgId(o.bkg_id)&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(s,cur.poster.getCustomBkg()),t.bkg_id&&delete t.bkg_id),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(t,{txt:i,bkg:s}),cur.shareShowImg&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(t,{shareShowImg:cur.shareShowImg}),_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(_)){const _=cur.poster?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("submit_post_box"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domClosest)("_submit_post_box",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("official"));(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(t,{from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"from-oid")||vk.id,signed:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)("signed")?1:0});(0,_web_donut__WEBPACK_IMPORTED_MODULE_27__.fieldValueIsDonutOnlyPost)(_,cur.wallAddMedia)?t.donutOnly=1:delete t.donutOnly}ls.set(Wall.ownerDraftKey(_),t)},getOwnerDraft:function(_){if(cur.options?.no_draft)return[];const e=ls.get(Wall.ownerDraftKey(_))||[],t={from:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e.from),signed:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e.signed),shareShowImg:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e.shareShowImg)};return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e.donutOnly)&&(t.donutOnly=1),[e.txt,e.medias,!0,t,e.bkg]},saveOwnerDraftMedia:function(_,e,t,o){if(cur.options?.no_draft)return;Wall.cleanOwnerDraftMedia(_);const i=cur.wallAddMedia||{};let s=[],l=(cur.wallAddMedia?i.getMedias():[]).slice().map((function(_){return _.slice(0,2)}));void 0!==t&&e?s=[[e,t,o]]:e||void 0===t||l.splice(t,1),l=l.concat(s),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(l,(function(){Wall.addOwnerDraftMedia(_,this)}))},saveDraft:function(){if(cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia),cur.options?.no_draft)return;if(cur.noDraftSave)return void(cur.noDraftSave=!1);if(cur.postSent||vk.id!=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(cur.oid))return;const _=Wall.getDraftData();_.delayed||ajax.post("al_wall.php",Wall.fixPostParams((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({act:"save_draft",hash:cur.options.post_hash},_)),{onFail:function(){return!0}})},getDraftData:function(){if(cur.options?.no_draft)return{};const _=cur.wallAddMedia||{},e=_.chosenMedia||{},t=cur.wallAddMedia?_.getMedias():[],o=_.shareData||{};let i="",s=0,l=null;if(Wall.isPosterEditorOpen())i=cur.poster.getText(),l=i?cur.poster.getBkgId():null;else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_field");i=window.Emoji?Emoji.editableVal(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(_),i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(i)}let a={message:i,bkg_id:l};return(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(e)&&e.length&&t.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clone)(e)),t.length&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(t,(function(e,t){if(!t)return;const l=this[0];let n=this[1];switch(l){case"poll":const e=_.pollData(!0,!0);if(!e)return a.delayed=!0,!1;n=e.question,delete e.question,a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(a,e);break;case"copyright":const s=_.copyrightData(!0);if(s)return void(a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(a,s));break;case"share":if(o.failed||!o.title&&(!o.images||!o.images.length)&&!o.photo_url&&!o.video)return cur.shareLastParseSubmitted&&Date.now()-cur.shareLastParseSubmitted<2e3?(a.delayed=!0,!1):void 0;o.video?(n=o.video_owner_id+"_"+o.video_id,a.snippet_video=1):n=o.user_id&&o.photo_id&&!o.noPhoto?o.user_id+"_"+o.photo_id:"",o.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(i)==o.initialPattern&&(a.message=""),o.is_vk_mini_app&&(a.is_vk_mini_app=!0,a.is_photo_edit=o.isPhotoEdit,a.image_offset=cur.shareShowImg),a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(a,{url:o.url,module:cur.module,mode:o.mode,title:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(o.title),description:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(o.description),button_text:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(o.button_text),button_action:o.button_action,extra:o.extra,extra_data:o.extraData,photo_url:o.video?"":(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(o.photo_url),open_graph_data:(o.openGraph||{}).data,open_graph_hash:(o.openGraph||{}).hash});break;case"page":o.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(i)==o.initialPattern&&(a.message="");break;case"postpone":const l=+_.postponeDate;return void(a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(a,{postpone:l}));case"mark_as_ads":return void(a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(a,{mark_as_ads:1}));case _web_donut__WEBPACK_IMPORTED_MODULE_27__.ATTACH_DATA_DONUT_DURATION:return void(a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(a,(0,_web_donut__WEBPACK_IMPORTED_MODULE_27__.getPostParamsFromDurationMedia)(t)))}this[3]&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(i)==this[3]&&(a.message=""),a["attach"+(s+1)+"_type"]=l,a["attach"+(s+1)]=n,s++})),a},setDraft:function(_){if(cur.options?.no_draft)return;if(!(_[0]||_[1]&&_[1].length||null!=_[4]))return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_field");if(!e)return;const t=_[4];t||Emoji.val(e,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(_[0]||"")).replace(/\n/g,"<br/>")),Wall.showEditPost((function(){setTimeout((function(){if(t&&cur.poster){Wall.hidePosterFeatureTooltip();const o={text:_[0]||""};if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isString)(t)?o.bkgId=_[4]:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isObject)(t)&&(cur.poster.isCustomBkgId(t.id)&&cur.poster.addCustomBkg(t),o.bkgId=t.id),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(Wall.getMainPostBlock()))return cur.poster.setBkg(o.bkgId,!0),cur.poster.setText(o.text),void Emoji.val(e,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(_[0])).replace(/\n/g,"<br/>"));Wall.openPosterEditor(o)}window.cur.addPostData=Array.isArray(_[1])?_[1]:[],Wall.drawMedia({skipClear:!0}),Wall.checkPosterAvailability(),Wall.saveDraft(),Wall.checkPostLen(window.cur.postField,window.cur.postWarningField,window.cur.sendPostBtn)}),0)}),!0),_[2]&&wall.focusOnEnd(),_[3]&&(wall.setReplyAsGroup((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("official"),_[3]),_[3].shareShowImg&&(cur.shareShowImgRestored=_[3].shareShowImg),_[3].donutOnly&&cur.wallAddMedia&&cur.wallAddMedia.donutPostSettings&&cur.wallAddMedia.donutPostSettings.setPostDonutOnly&&cur.wallAddMedia.donutPostSettings.setPostDonutOnly()),cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia)},onThumbUpdate:({id:_,thumb:e})=>{window.cur.addPostData=(window.cur.addPostData??[]).map((t=>t[1]===_?e:t))},drawMedia:function({skipPoll:_=!1,skipClear:e=!1,skipPostpone:t=!1}={}){if(window.cur.addPostData&&cur.wallAddMedia){e||cur.wallAddMedia.clearMedia({skipPoll:_,skipPostpone:t,skipNotifications:!0});for(const e in window.cur.addPostData){const t=window.cur.addPostData[e];_&&t[0]===_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_POLL||(cur.noDraftSave=!0,cur.wallAddMedia.chooseMediaNoNotify(...t))}}},initPostEditable:function(_){const e=cur.postField;if(!e||e.emojiInited)return!1;e.emojiInited=!0,window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){Emoji.init(e,{ttDiff:-42,rPointer:!0,controlsCont:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(e),noStickers:!0,onSend:Wall.sendPost,noEnterSend:!0,ref:"post",checkEditable:Wall.postChanged,initUploadForImagePasteCallback:function(_,e,t){window.Upload&&Upload.onFileApiSend(cur.wallUploadInd,[t])}}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(e,"submit_post_inited"),_?setTimeout(Wall.setDraft.pbind(_),0):cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia)})),setTimeout((function(){cur.postFieldZoomText&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)(e,"keydown paste",(function(){setTimeout((function(){cur.postFieldZoomText(cur.postField,cur.wallAddMedia)}),0)}))}),0)},initEmoji:function(){window.stManager.add([window.jsc("web/emoji.js")])},showEditPost:function(_,e,t){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_field");if(cur.viewAsBox)return setTimeout((function(){o.blur()}),0),cur.viewAsBox();if(0===cur.editing)return;(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.POSTING_INIT);const i=document.getElementById("submit_post_box");setTimeout(WallUpload.init,0),Wall.initComposer(o,{lang:{introText:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("profile_mention_start_typing"),noResult:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("profile_mention_not_found")},checkLen:Wall.postChanged,onValueChange:Wall.onPostValChange,onItemSelect:Wall.onPostItemSelect},_),Wall.initHashtagComposer(o,{checkLen:Wall.postChanged,onValueChange:Wall.onPostValChange,onItemSelect:Wall.onPostItemSelect}),Wall.hideEditPostReply(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)("submit_post_box","shown"),cur.editing=0,Wall.showPosterFeatureTooltip(),Wall.showPostCopyrightFeatureTooltip(),Wall.showPostOnlineBookingTooltip(i),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(cur.onShowEditPost)&&cur.onShowEditPost(),window.stManager.add(["ui_controls.css","ui_controls.js","datepicker.css",window.jsc("web/datepicker.js")])},postBoxFocus:function(_,e){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.stopEvent)(_||window.event);const t=Wall.isPosterEditorOpen();(cur.postField&&window.Emoji||t)&&setTimeout((function(){e?t?(cur.poster.focusPoster(),(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollToY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(cur.poster.getPosterElement())[1]-15)):(Emoji.focus(cur.postField),(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollToY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(cur.postField)[1]-15)):t?cur.poster.focusPoster():Emoji.focus(cur.postField,!0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("submit_post_box"))}),0)},initComposer:function(_,e,t){const o=e.hashtagEnable?"composer_hashtag":"composer";if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(_,o))t&&t();else if(cur.composerAdded){const o=Composer.init(_,e);t&&t(),cur.destroy.push(Composer.destroy.bind(Composer).pbind(o))}else window.stManager.add(["wide_dd.css",window.jsc("web/wide_dd.js")],(function(){cur.composerAdded=!0;const o=Composer.init(_,e);t&&t(),cur.destroy.push(Composer.destroy.bind(Composer).pbind(o))}))},deinitComposer:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(_,"composer");e&&Composer.destroy(e),_.emojiId&&window.Emoji&&Emoji.destroy(_.emojiId)},hasComposerMedia:function(_){const e=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(_,"composer");return!!(e&&e.addMedia&&e.addMedia.attachCount)&&e.addMedia.attachCount()>0},composerListShown:function(_){const e=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(_,"composer");if(!e)return!1;const t=e.wdd;let o=0;for(const _ in t.shown)o+=1;return!!(t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(t.listWrap)&&o)},onPostValChange:function(_){if(cur.wallAddMedia&&!cur.isUrlsRecognitionDisabled&&cur.wallAddMedia.checkMessageURLs.apply(window,arguments),"full_own"!=cur.wallType&&"full_all"!=cur.wallType||Pagination.pageTopUpdated(),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.msie&&!_){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_field");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.elfocus)(_)}},onPostItemSelect:function(_){if(!_||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(_[0])>=0||!cur.wallAddMedia)return;const e=`${(0,_shared_lib_site__WEBPACK_IMPORTED_MODULE_3__.getHostName)()}/event${-_[0]}`;cur.wallAddMedia.checkMessageURLs(e,!0)},hideEditPost:function(_){cur.editing=!1;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_field"),t=cur.wallAddMedia||{},o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)((window.Emoji?Emoji.editableVal:_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(e));!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.opera_mobile&&e&&(!_&&(o||t.chosenMedia||t.getMedias&&t.getMedias().length>0||t.activeState||t.attachCount&&t.attachCount()>0)||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)("submit_post_box","shown"),e&&!o&&cur.postMention&&(cur.postMention.options.minHeight=cur.emptyPostheight||14),cur.onWallSendCancel&&cur.onWallSendCancel(),window.WallUpload&&WallUpload.hide(),cur.wallAddMedia&&cur.wallAddMedia._hideAddMedia(!0)))},clearInput:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("page_add_media"),window.cur.addPostData=[],window.cur?.wallAddMedia?.clearCarouselRatio?.();const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_field");if(Wall.withMentions){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(_,"mention");e&&(e.rtaEl.innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(e.cont),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(_))}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(_,""),_.blur(),_.phonblur(),Wall.hideEditPost(!0),cur.wallAddMedia&&cur.wallAddMedia.unchooseMedia(void 0,void 0,{isReset:!0}),Wall.resetPostVisibilityAccess();const e=document.querySelector("#submit_post_box");e&&Wall.resetPostOrdData(e),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.checkbox)("export_status",!1),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.checkbox)("close_comments",!1),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.forEach((_=>{_()}));const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(_,"composer");t&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(t.articleConvertEl),t.articleConvertEl=!1)},fixPostParams:function(_){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clone)(_);return e.Message=_.message,delete e.message,e},focusOnEnd:function(_){if(!(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_field")))return;if("TEXTAREA"==_.tagName)return void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.elfocus)(_);const e=_.innerHTML?_.innerHTML.length:_.length?_.length:_.childNodes.length-1;if(_.focus(),document.selection){const _=document.selection.createRange();_.moveStart("character",e),_.select()}else window.getSelection().collapse(_,_.childNodes.length)},showPostSettings:function(_,e){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(_,"ett")){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(_),t=e&&e.querySelector("#post-copyright-button");new ElementTooltip(_,{cls:"post_settings_tooltip"+(t?" post_settings_tooltip_with_custom_btn":""),content:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(e),defaultSide:"top",offset:[0,-5],appendTo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_)}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(e)}e&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.checkKeyboardEvent)(e)&&"click"===e.type&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(_,"ett").toggle()},togglePostVisibilityAccess:function(_,e,t,o){t=t||"";const i="post_visibility_btn",s=cur[i+t];s&&s.hide(),(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_33__.updatePostTooltipActionRadioBtn)(_.closest(".radiobtn"),e,"post_settings_btn"+i+t);const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_visibility_btn"+t),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("post_action_btn_text",l),n=![_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.VISIBILITY_ACCESS_OPTIONS.ONLY_FRIENDS,_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS].includes(e);if(e===_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("best_friends_only"+t).querySelector(".PostVisibilityBestFriendsOnlyOption"),o=Number(e.dataset.count);_.classList.contains("PostVisibilityBestFriendsOnlyOption__editLink")||0===o?((0,_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_42__.sendBestFriendsAnalytic)(_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_42__.BestFriendsEventType.editBestFriends),this.resetPostVisibilityAccess(),window.stManager.add([window.jsc("web/best_friends.js")],(()=>{window.bestFriendsBoxSettings((_=>{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("best_friends_only"+t);if(0===_)e.innerHTML=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.getTemplate)("visibility_access_best_friends_only_option",{html:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_choose_best_friends"),count:_}),this.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("no_friends_only"+t),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.VISIBILITY_ACCESS_OPTIONS.PUBLIC,t,!0);else{const o=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_best_friends_settings_box_conversation_friends_count",_);e.innerHTML=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.getTemplate)("visibility_access_best_friends_only_option",{html:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.getTemplate)("visibility_access_best_friends_only_item",{count_text:o}),count:_}),this.togglePostVisibilityAccess(e,_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS,t,!0)}}))}))):((0,_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_42__.sendBestFriendsAnalytic)(_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_42__.BestFriendsEventType.selectBestFriends),a.innerHTML=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_best_friends_only"),a.setAttribute("aria-label",_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_best_friends_only")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(l,"best_friends_only"))}else if(n){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("no_friends_only"+t).querySelector(".FancyElementTT__itemLabel").innerHTML;a.innerHTML=_,a.setAttribute("aria-label",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(_)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(l,"on"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(l,"best_friends_only")}else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_only"+t).querySelector(".FancyElementTT__itemLabel").innerHTML;a.innerHTML=_,a.setAttribute("aria-label",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(_)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(l,"on"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(l,"best_friends_only")}o||Wall.postChanged()},resetPostVisibilityAccess(){Wall.canChangeVisibilityForNewPost()&&Wall.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("no_friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.VISIBILITY_ACCESS_OPTIONS.PUBLIC,!1,!0)},resetPostOrdData(_){const e=_.querySelector("#post_icon_gear_settings"),t=_.querySelector("#ads_ord_mini_app_option"),o=t&&t.querySelector('[name="ord_pred_id"]'),i=t&&t.querySelector('[name="erid"]');e&&e.classList.remove("PostOption__iconWrapperApplied","on"),t&&t.classList.remove("PostOption__withMarkAdsOrdMiniApp","on"),o&&(o.value=""),i&&(i.value="")},canChangeVisibilityForNewPost:()=>!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_visibility_btn"),initPostVisibilitySelector(_){Wall.canChangeVisibilityForNewPost()&&(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_33__.createPostTooltip)("post_visibility_btn",_.id)},cantAccessDonutPosts:()=>!1===window.cur.donutGroupUserHasWallAccess,togglePostMarkAsAds:function(_,e){e=e||"mute_notifications";const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(e);if(!t)return;const o=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)(_);if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disable)(t,o),o)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"prev-state",+(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)(t)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(t,"on");else{const _=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"prev-state");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(t,"on",_)}},needCheckSign:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("check_sign");return _&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)(_)},saveCheckSign:function(_){const e=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)(_),t=_.querySelector(".PostOption__iconWrapper");let o="",i="";e?(o=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_check_sign_disabled"),i=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_88__.getIcon20UserOutline)().icon):(o=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_check_sign_enabled"),i=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_89__.getIcon20UserSlashOutline)().icon),t.innerHTML=i,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"title",o),window.tooltips&&tooltips.hide(_,{onHide:_.onmouseover.bind(_)}),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.checkbox)(_,!e)},checkAsGroup:function(_){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.checkbox)(_),wall.setReplyAsGroup(_,{fromGroup:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)(_)})},showBoxError:function(_){const e=document.getElementById("submit_post_error");if(e.innerHTML=_.length>60?'<div class="msg_text">'+_+"</div>":_,!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(e)){const _=document.getElementById("box_layer_wrap");(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_19__.slideDown)(e,100),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_19__.animate)(_,{scrollTop:0})}},messageGetter:()=>window.Emoji?Emoji.editableVal:_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val,getMessage:function(_){const e=_||document.getElementById("post_field");return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(Wall.messageGetter()(e))},sendPost:function({skipLocked:_=!1,posterSendParams:e}={}){if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsFixEnabled)()&&Wall.postponedPosts?.isLocked()&&"postponed"===window.cur.wallTab)return;const t=cur.wallAddMedia||{},o=t.chosenMedia||{};let i=cur.wallAddMedia?t.getMedias():[];const s=t.shareData||{},l=cur.poster&&!!e;if(!Wall.checkPostLen(cur.postField))return;let a=l?e.text:Wall.getMessage(),n=!1;const r=l?null:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("send_post");let d=cur.options.suggesting?"suggest":cur.wallType;"top"===d&&(d="all"),l&&(i=i.filter((_=>{if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(_)){const[e]=_;return["copyright","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_27__.MEDIA_TYPE_DONUT_DURATION].includes(e)}})));const E=l?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("submit_post_box"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domClosest)("_submit_post_box",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("official")),c=(0,_web_donut__WEBPACK_IMPORTED_MODULE_27__.fieldValueIsDonutOnlyPost)(E,t);let p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(E,"from-oid")==cur.postTo?1:"";E&&cur.postTo||p||cur.defaultPostSettings&&(p=cur.defaultPostSettings.official?1:"");const{ord_is_ad:u,ord_erid:P,ord_external_id:b}=(()=>{const _=document.getElementById("ads_ord_mini_app_option"),e=_&&_.querySelector('[name="ord_pred_id"]'),t=_&&_.querySelector('[name="erid"]'),o=_&&_.classList.contains("on"),i=e&&e.value;return{ord_is_ad:o,ord_erid:t&&t.value,ord_external_id:i}})();let O={act:"post",message:a,to_id:cur.postTo,type:d,friends_only:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)("friends_only"),best_friends_only:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)("best_friends_only"),check_sign:Wall.needCheckSign(),close_comments:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("close_comments")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)("close_comments")?1:0:"",mute_notifications:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("mute_notifications")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)("mute_notifications")?1:0:"",mute_notifications_in_mentions:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("mute_notifications_in_mentions")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)("mute_notifications_in_mentions")?1:0:"",mark_as_ads:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)("mark_as_ads")||u?1:0,ord_erid:P,ord_external_id:b,official:p,signed:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)("signed"),hash:cur.options.post_hash,from:cur.from?cur.from:"",fixed:cur.options.fixed_post_id||"",situational_suggest_id:cur.options.situational_suggest_id||null},D=0;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(O,(0,_web_donut__WEBPACK_IMPORTED_MODULE_27__.getDonutPostParams)(c,t)),cur.options.additional_save_params&&(O=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(O,cur.options.additional_save_params));const M=cur.wallAddMedia&&cur.wallAddMedia.id||"";if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(O,(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_31__.getPostTopicSelectorParams)(String(M))),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("attachments_primary_mode_web_feature")){const _=(0,_web_attachments_view_selector_utils__WEBPACK_IMPORTED_MODULE_58__.getAttachmentsPrimaryModeParam)(String(M));(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(O,_),_&&((0,_web_attachments_view_selector_utils__WEBPACK_IMPORTED_MODULE_58__.saveAttachmentsPrimaryModeDefaultValue)(_.primary_attachments_mode),cur?.attachmentsViewSelectorResult?.setOption(_.primary_attachments_mode)),(0,_web_posting_carousel_components_utils__WEBPACK_IMPORTED_MODULE_81__.isCarouselCropEnabled)()&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(O,t.getPrimaryAttachmentsRatioAnalyticsParam())}(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(o)&&o.length&&i.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clone)(o)),l&&(O.poster_bkg_id=e.bkgId,O.poster_bkg_access_hash=e.accessHash,e.fallbackObj&&(i.push(["photo",e.fallbackObj.owner_id+"_"+e.fallbackObj.id,!1]),O.poster_photo_hash=e.fallbackObj.post_hash),O.poster_bkg_id!==cur.posterCtaBkgId&&(O.poster_author_bkg_check=!0)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("submit_post_error");const w=_=>{if(this.showBoxError(_),Wall.isPosterEditorOpen()){const _=cur.poster.getErrorWrapperElement();_.innerHTML="",_.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("submit_post_error"))}};let m;if(i.length&&(m=!1,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(i,(function(_,e){if(!e)return;const o=this[0];let l=this[1];switch(o){case"poll":const _=t.pollData();if(!_)return m=!0,!1;l=_.question,delete _.question,O=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(O,_);break;case"copyright":const e=t.copyrightData();if(e)return void(O=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(O,e));break;case"share":if(s.failed||!s.title&&(!s.images||!s.images.length)&&!s.photo_url&&!s.video)return cur.shareLastParseSubmitted&&Date.now()-cur.shareLastParseSubmitted<2e3?(m=!0,!1):void 0;if((cur.options.share||{}).button_exclusive&&s.button_text&&s.button_action){let _;i.length>1&&(_=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_share_too_many_attachments")),a.split("\n").length-1>(cur.options.share||{}).button_exclusive_max_message_newlines&&(_=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_ads_post_too_many_newlines")),a.length>(cur.options.share||{}).button_exclusive_max_message_len&&(_=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_ads_post_too_long_message"));const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extractUrls)(" "+a+" "),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extractUrls)(" "+s.url+" ")[0];if(t&&e.length){"/"===t.query&&(t.query=""),"www."===t.domain.substr(0,4)&&(t.domain=t.domain.substr(4));for(let o=0;o<e.length;++o){const i=e[o];if("/"===i.query&&(i.query=""),"www."===i.domain.substr(0,4)&&(i.domain=i.domain.substr(4)),t.domain!=i.domain||t.query!=i.query){_=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_share_too_many_links");break}}}if(_)return w(_),m=!0,!1}if(!s.title)return w(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_share_title_required")),m=!0,!1;if(!s.url)return w(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_share_url_required")),m=!0,!1;if(s.url=new URL(s.url).href,s.video?(l=s.video_owner_id+"_"+s.video_id,O.snippet_video=1):l=s.user_id&&s.photo_id&&!s.noPhoto?s.user_id+"_"+s.photo_id:"",s.share_upload_failed&&!l)return void(s.share_upload_failed=0);if(s.images&&s.images.length&&!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(s.images[cur.shareShowImg])&&!l&&!s.noPhoto&&!s.share_own_image&&!s.video)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton)(r),t.uploadShare((function(){Wall.sendPost({skipLocked:!0})})),m=!0,!1;if((cur.options.share||{}).require_image&&!l)return w(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_share_image_required")),m=!0,!1;s.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(a)==s.initialPattern&&(O.message=""),s.is_vk_mini_app&&(O.is_vk_mini_app=!0,O.is_photo_edit=s.isPhotoEdit,O.image_offset=cur.shareShowImg),O=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(O,{url:s.url,module:cur.module,mode:s.mode,title:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(s.title),description:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(s.description),button_text:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(s.button_text),button_action:s.button_action,extra:s.extra,extra_data:s.extraData,photo_url:s.noPhoto||s.video?"":(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(s.photo_url),open_graph_data:(s.openGraph||{}).data,open_graph_hash:(s.openGraph||{}).hash});break;case"page":s.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(a)==s.initialPattern&&(O.message="");break;case"postpone":const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("postpone_date"+t.lnkId);return O=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(O,{postpone:o}),cur.postponedLastDate=o,void(n=!0);case"mark_as_ads":return void(O=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(O,{mark_as_ads:1}));case"pretty_cards":if(!t.prettyCardGallery)return;if(t.prettyCardGallery.needSendData())return t.prettyCardGallery.saveCards(Wall.sendPost,(function(_){w(_)})),m=!0,!1;l=t.prettyCardGallery.getSendData().attachVal;break;case"podcast":if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(this[2],"attach_disabled"))return!1;break;case _web_donut__WEBPACK_IMPORTED_MODULE_27__.MEDIA_TYPE_DONUT_DURATION:return;case"donut_link":O["attach"+(D+1)+"_owner_id"]=this[5]?.owner_id}this[3]&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(a)==this[3]&&(O.message=""),O["attach"+(D+1)+"_type"]=o,O["attach"+(D+1)]=l;const d=this[5]?.crop_data;d&&(O["attach"+(D+1)+"_crop"]=(0,_web_posting_carousel_components_utils__WEBPACK_IMPORTED_MODULE_81__.changeCropDataFromArrayToString)(d)),D++})),m))return void(_&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton)(r));if(!D&&!a)return _&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton)(r),void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.elfocus)("post_field");if(r&&!_&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isButtonLocked)(r))return;cur.postAutosave&&clearTimeout(cur.postAutosave),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("submit_post_error"),cur.postSent=!0;const C=window.GroupsAdminTips&&window.GroupsAdminTips.isShownSection()?1:0;O.update_admin_tips=C;const T=(0,_web_donut__WEBPACK_IMPORTED_MODULE_27__.isPaidAttachPicked)(t,cur.oid);O.donut_duration&&-1!==O.donut_duration&&T&&!cur.donutAttachesApproved?(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_action_confirmation"),onHide:()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton)(r)}},_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_publish_donut_freeing_attaches_confirmation_title"),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_publish_postponed_btn"),(()=>{(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.curBox)().hide(),cur.donutAttachesApproved=!0,Wall.sendPost({skipLocked:_,posterSendParams:e})}),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_cancel"),(()=>{(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.curBox)().hide(),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton)(r)})):setTimeout((function(){ajax.post("al_wall.php",Wall.fixPostParams(O),{onDone:function(_,e,o,s){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("posting_track_event_count")){const _=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("posting_track_event_count_log");_&&("suggest"===d&&console.log("suggest post"),n&&console.log("postpone post")),"suggest"===d||n||((0,_shared_counters_tmr__WEBPACK_IMPORTED_MODULE_74__.tmrSendTimespentEvent)(_shared_counters_tmr__WEBPACK_IMPORTED_MODULE_74__.MY_TRACKER_COUNT_EVENT_IDS.POST_PUBLISH),_&&console.log("simple post"))}_web_ecomm_onboarding_Tooltips_services_TooltipEventService__WEBPACK_IMPORTED_MODULE_55__.TooltipEventService.onAddPost(),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isString)(o)||(o=null),cur.poster&&l&&(cur.poster.unlockEditPoster(),cur.poster.closeEditor(),cur.poster.resetPoster(),cur.posterCtaBkgId&&(cur.posterCtaBkgId=null)),cur.posterFeatureTT&&cur.posterFeatureTT.hide(),Wall.clearInput(),cur.postSent=!1,cur.donutAttachesApproved=!1;const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("mark_as_ads"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("mute_notifications");if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)(a)&&r&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(r,"on"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disable)(r,0)),a&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(a,"on"),t.donutUpdateVisibility()),cur.options.onSendPostDone)return void cur.options.onSendPostDone.apply(window,arguments);if(s&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.showDoneBox)(s),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isObject)(_)&&_.redirect)return void nav.go(_.redirect);(0,_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_39__.showHiddenNavigableTabs)();let E=(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsActResult)(_)?_.rendered_posts:_;if(n){if("feed"==d)(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.showDoneBox)(E,{out:3e3});else if("full_own"==d||"full_all"==d)return Wall.showPostponedFull(E);return wall.updateTabVisibility("page_wall_postponed",!0),void Wall.showPostponed(!1,_)}if(("full_own"==d||"full_all"==d)&&(cur.pgStart||nav.objLoc.postponed)){const _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clone)(nav.objLoc);return delete _.offset,delete _.postponed,vk.id!=cur.oid&&delete _.own,nav.go(_)}if(vk.id!=cur.oid&&"full_own"==d){const _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clone)(nav.objLoc);return delete _.own,nav.go(_)}if("feed"==d)return cur.wallPostCb();if("suggest"==d)return wall.updateTabVisibility("page_wall_suggest",!0),Wall.showSuggested(!1,E,e),Wall.suggestUpdate();if(c)return void Wall.showDonutWall(E);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_tabs")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_tab",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_tabs")).click(),Wall.receive(E,e),cur.onWallSendPost&&cur.onWallSendPost(),C&&null!==o&&window.GroupsAdminTips&&window.GroupsAdminTips.refreshSection(o);if((0,_web_profile_profile_utils__WEBPACK_IMPORTED_MODULE_52__.isVKCOMProfileRedesignedEnabled)()&&"profile"===window.cur.module){i.some((([_])=>"article"===_))&&window.Profile?.reloadOwnerContentTab("articles")}},onFail:function(_){if(cur.postSent=!1,cur.donutAttachesApproved=!1,cur.poster&&l&&cur.poster.unlockEditPoster(),cur.posterFeatureTT&&cur.posterFeatureTT.hide(),cur.options.onSendPostFail)return void cur.options.onSendPostFail.apply(window,arguments);if(!_)return!0;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("submit_post_error");if(e.innerHTML=_.length>60?'<div class="msg_text">'+_+"</div>":_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)("submit_post_error")||(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_19__.slideDown)("submit_post_error",100),Wall.isPosterEditorOpen()){const _=cur.poster.getErrorWrapperElement();_.innerHTML="",_.appendChild(e)}return!0},showProgress:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton)(r)},hideProgress:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton)(r)},noSort:!0})}),0)},_repliesLoaded:function(_,e,t,o,i){const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+_);if(!s)return;const l=s.nextSibling;if(e){const _=s.offsetHeight;s.innerHTML=t,(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollToY)((0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollGetY)()+(s.offsetHeight-_),0,void 0,!0),setTimeout(Wall.scrollHighlightReply.pbind("post"+e),0)}else s.innerHTML=t;if(l&&"replies_open"==l.className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(l),ajax._framenext(),_==cur.wallLayer){const _=wkcur.reverse;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(wkcur,{offset:!_&&i.offset||0,loaded:i.num||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("reply",s,"div").length,count:i.count}),wall.addReplyNames(o),WkView.wallUpdateReplies(),_||(wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll())}else wall.addReplyNames(o),Wall.repliesSideSetup(_);Wall.updateMentionsIndex(),setTimeout((function(){(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_9__.getAudioPlayer)().updateCurrentPlaying()}),10),i&&Likes.updateComments("wall"+_,i.count)},repliesSideSetup:function(_){if(cur.wallLayer==_)return void WkView.wallUpdateReplies();const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+_);if(!e)return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("wr_header",e,"a"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(o,"deep_active");let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_side"+_);if(cur.wallMyOpened[_]&&(t||i)){if(!s){const t=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_90__.getIcon24ChevronUp)().icon,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)(`<div class="replies_side_wrap"><div id="replies_side${_}" class="replies_side"><div class="replies_side_icon">${t}</div></div></div>`);e.parentNode.insertBefore(o,e),s=o.firstChild,s.onmouseover=Wall.repliesSideOver.pbind(_),s.onmouseout=Wall.repliesSideOut.pbind(_),s.onclick=i?Wall.hideDeepReplies.pbind(_):Wall.repliesSideClick.pbind(_)}e.onmouseover=Wall.repliesSideOver.pbind(_),e.onmouseout=Wall.repliesSideOut.pbind(_),Wall.repliesSideOver(_)}else(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.floatingButtonCollapseAllRepliesHide)(s),e.onmouseover=null,e.onmouseout=null},repliesSideClick:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+_),t=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollGetY)(),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(e)[1];return t>o&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollToY)(o-100,0),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.floatingButtonCollapseAllRepliesHide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_side"+_)),Wall.showReplies(_,3,!1)},repliesSideOver:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_side"+_);if(!e)return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(t))[1],i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(t)[1],s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(e)[1],l=e.offsetHeight,a=window.lastWindowHeight||0,n=o+i-a+15,r=s+l-a;cur.wallRepliesSideOver=[_,t,n,r],Wall.repliesSideUpdate()},repliesSideOut:function(_){cur.wallRepliesSideOver&&cur.wallRepliesSideOver[0]==_&&delete cur.wallRepliesSideOver},repliesSideUpdate:function(_){const e=cur.wallRepliesSideOver;if(!e)return;const t=e[1],o=e[4]||{},i=e[5]||"";let s,l="replies_side";void 0===_&&(_=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollGetY)()),_<e[2]?((0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.floatingButtonCollapseAllRepliesShow)(t),s={marginTop:0,opacity:1}):_<e[3]?((0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.floatingButtonCollapseAllRepliesShow)(t),l+=" replies_side_fixed",s={opacity:Math.max(0,Math.min(1,(e[3]-_)/200))}):(l+=" replies_side_hidden",s={marginTop:e[3]-e[2],opacity:0,display:null}),(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_6__.isEqual)(o,s)||((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(o,(function(_,e){o[_]=null})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.setStyle)(t,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(o,s)),e[4]=s),i!=l&&(t&&(t.className=l),e[5]=l)},highlightReply:function(_){(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_))&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(_,"reply_highlighted"),setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(_,"reply_highlighted")}),1500))},scrollHighlightReply:function(_){if(!(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_)))return;if(cur.wallLayer||_.id.match(/^post-?\d+(photo|video|market)?_\d+$/)&&(window.wkcur&&wkcur.shown||window.mvcur&&mvcur.mvShown||cur.pvShown)){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(_,!0)[1];return void(e<0||e>lastWindowHeight-200?(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_19__.animate)(wkLayerWrap,{scrollTop:wkLayerWrap.scrollTop+e-50},300,Wall.highlightReply.pbind(_)):Wall.highlightReply(_))}const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(_)[1];e<(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollGetY)()+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)("page_header")[1]?((0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollToY)(e,300),setTimeout(Wall.highlightReply.pbind(_),300)):Wall.highlightReply(_)},showReply:function(_,e,t,o){if(cur.viewAsBox)return!1;if(o&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.checkEvent)(o))return!0;if(window.mvcur&&mvcur.post==e)return Videoview.showComment(t),!1;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+t);if(i)Wall.scrollHighlightReply(i);else if(cur.wallLayer==e)WkView.wallShowPreviousReplies(t);else if(e.match(/market/))Market.comments(e);else{if(_.tt&&_.tt.hide&&_.tt.hide(),"full"==cur.wallType){const _=t.split("_");return delete nav.objLoc.offset,nav.go((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(nav.objLoc,{reply:_[1]}))}Wall.showReplies(e,!1,t)}return!1},showReplies:function(_,e,t,o){if((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.checkEvent)(o||window.event))return!0;if(cur.viewAsBox)return cur.viewAsBox();if(cur.wallLayer==_&&wkcur.reverse)return;cur.wallMyOpened[_]=3!=e;const i={act:"get_replies",post:_,count:e},s={onDone:Wall._repliesLoaded.pbind(_,t),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton.pbind("wrh"+_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton.pbind("wrh"+_),local:1};if(t||e&&!(e>20)||((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(i,{cont:"replies"+_}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(s,{frame:1}),cur.onFrameBlocksDone=function(){setTimeout(Wall.repliesSideSetup.pbind(_),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.msie?100:10)}),ajax.post("al_wall.php",i,s),!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.msie&&e>0&&e<10){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+_);let o=t&&t.lastChild;const i=[];for(;i.length<e&&o;)"DIV"==o.tagName&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(o,"reply")&&i.push(o),o=o.previousSibling;if(i.length==e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("reply",t,"div").length;for((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(t,'<a class="wr_header wrh_all"></a>'),Wall.updateRepliesHeader(_,t.firstChild,e,o),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.floatingButtonCollapseAllRepliesHide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_side"+_));i.length;)t.appendChild(i.pop());(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton)("wrh"+_)}}return!1},moreReplies:function(_,e,t,o){let i;if(o.deep){const s=_.split("_");i={act:"get_post_replies",offset:e,owner_id:s[0],item_id:s[1],count:t},o.order&&(i.order=o.order)}else i={act:"get_replies",offset:e,post:_,count:t};return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(i,{rev:o.rev,from:o.from}),ajax.post("al_wall.php",i,{onDone:function(e,t,i){const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+_);o.clear?s.innerHTML=e:o.rev||o.append?s.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.cf)(e)):s.innerHTML=e+s.innerHTML,wall.addReplyNames(t),o.onDone&&o.onDone(e,t,i),Wall.updateMentionsIndex()},onFail:()=>!1,showProgress:o.showProgress,hideProgress:o.hideProgress}),!1},openDeepShortReplies:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("replies_next",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_));return t&&((0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.loadRepliesLinkShow)(t),t.focus(),t.click(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(_)),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(e)},collapseDeepReplies:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+e);if(!t||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"replies_list_deep"))return;const o=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollGetY)();let i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(_)[1];const s=Math.round((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.clientHeight)()/2);cur.wallLayer?(i-=o,i<s&&(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_19__.animate)(wkLayerWrap,{scrollTop:wkLayerWrap.scrollTop+i-s},300)):o>i-s&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollToY)(i-s);const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+e);l&&(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.highlightUpdatedReply)(l);const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("span",{className:"progress_inline replies_next_loader"});(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(_),t.innerHTML="";const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_box_wrap"+e);n&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(n);const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_wrap_deep"+e),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",t)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",t),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(d,"post-id"),c=wall.getRepliesOrder(E);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(r,"replies_deep_has_field"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(r,"replies_deep_has_short"),wall.updateRepliesOnScroll(),ajax.post("al_wall.php",{act:"get_collapsed_replies",reply_id:e,order:c},{onDone:function(_){t.innerHTML=_},onFail:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(cur.wallTpl.reply_deep_next,{post_id:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(d,"post-id"),reply_id:e,offset:0,text:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_next_n_replies",cur.options&&cur.options.replies_page_count||20),class:" replies_next_deep",post_author_suffix:""}));t.appendChild(_),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.loadRepliesLinkShow)(_)},showProgress:function(){t.appendChild(a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(a)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(a)}})},overCollapseDeepReplies:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("replies_deep_collapse_icon",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(e),o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getStyle)(e,"bottom")),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(_),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(_),l=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollGetY)(),a=cur.wallLayer?wkLayerWrap.scrollTop:l;cur.wallLayer&&(s[1]-=l);const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.clientHeight)(),r=s[1]+i[1];let d,E,c=(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_36__.getFixedReplyField)(),p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(c)[1];cur.wallLayer?(d=a+r-n,E=a+s[1]+t[1]+o+o-n):(d=r-n,E=s[1]+t[1]+o+o-n),cur.onScrollCollapseDeepReplies=wall.updCollapseDeepRepliesIcon.pbind(_,e,{iconSize:t,iconBottom:o,collapseSize:i,collapsePos:s,fixedField:c,fixedFieldSize:p,maxFixedScroll:d,topMaxScroll:E}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)(cur.wallLayer?wkLayerWrap:window,"scroll",cur.onScrollCollapseDeepReplies),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)(window,"resize",cur.onScrollCollapseDeepReplies),cur.onScrollCollapseDeepReplies()},outCollapseDeepReplies:function(_){cur.onScrollCollapseDeepReplies&&((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.removeEvent)(cur.wallLayer?wkLayerWrap:window,"scroll",cur.onScrollCollapseDeepReplies),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.removeEvent)(window,"resize",cur.onScrollCollapseDeepReplies),delete cur.onScrollCollapseDeepReplies);const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("replies_deep_collapse_icon",_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.setStyle)(e,{position:null,bottom:null,left:null,right:null})},updCollapseDeepRepliesIcon:function(_,e,t){const o=cur.wallLayer?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollGetY)();let i=t.maxFixedScroll;if((cur.wallLayer&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t.fixedField,"wl_reply_form_fixed")||"full"===cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t.fixedField,"fixed"))&&(i+=t.fixedFieldSize),o<i){const _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((t.collapseSize[0]-t.iconSize[0])/2),i=t.topMaxScroll+t.fixedFieldSize-o;let s=t.fixedFieldSize+t.iconBottom;i>0&&(s-=i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.setStyle)(e,{position:"fixed",bottom:s,left:t.collapsePos[0]+_,right:"auto"})}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.setStyle)(e,{position:null,bottom:null,left:null,right:null})},updateCollapseDeepReplies:function(_){if(!cur.wallTpl||!cur.wallTpl.reply_deep_collapse)return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_wrap_deep"+_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("replies_wrap_deep",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_));if(!e)return;_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"post-id");const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+_);if(!t)return t;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("reply",t).length>=2;let i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("replies_deep_collapse",e);if(o){if(i)return;i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(cur.wallTpl.reply_deep_collapse,{reply_id:_})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertBefore)(i,t)}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(i)},showNextReplies:function(_,e,t){const o=e.split("_"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"offset"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"count"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"collapse");let a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"replies_prev"),n=cur.wallLayer?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+e);const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)("post"+e,"reply"),d={act:"get_post_replies",owner_id:o[0],item_id:o[1],offset:i,count:s,collapse:l,ref:(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.resolveRefFromCur)()},E=a?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPS)(_);if(E&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(E,"reply")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(E,"replies_wrap_deep"))){const _=((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(E,"post-id")||"").split("_")[1];a?d.next_id=_:d.prev_id=_}if(r)cur.wallLayer||(n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",n));else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+e),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"top-ids");t&&(d.top_replies=t)}const c=n.offsetHeight,p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(n,"post-id");d.order=wall.getRepliesOrder(p);const u=r&&wall.isDescRepliesOrder(p,d.order);u&&(a=!a);const P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("span",{className:"progress_inline replies_next_loader"});return ajax.post("al_wall.php",d,{onDone:function(t,o,s){const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domChildren)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{innerHTML:t})),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.cf)();let E=!1;r.forEach((function(_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"wr_header"))return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_.id);e&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(e,"reply")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(e,"replies_wrap_deep"))||(d.appendChild(_),E=!0)}));const P=a&&!u||!a&&u;let b,O,D=!1;if(P){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_wrap_deep"+e),"replies_deep_has_short")){const e=window.innerHeight||document.documentElement.clientHeight,t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)("page_header")[1],o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(o)[1];b=cur.wallLayer?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollGetY)(),D=cur.wallLayer?i<e:i<b+e-t}O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domFC)(d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertBefore)(d,_)}else O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domLC)(d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertAfter)(d,_);const M=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(s.num),w=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(s.offset),m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(s.count),C=Boolean(s.has_author_replies),T=Math.max(0,w+(a?-M:M)),h=m-T;let A=0;if(E&&(a&&w>0||!a&&h>0)&&(A=a?i-T:Math.min(h,M),s.closest_inx>=0&&(A=Math.min(A,s.closest_inx))),document.activeElement===_?(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)(_,"focusout",(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(_)})):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(_),A){const e=_.cloneNode(!0),t=e.querySelector(".js-replies_next_label");if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(e,"replies_next_pre_deleted"),!l){if(C){let _="";P?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertBefore)(e,O),_=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_prev_n_replies",A)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertAfter)(e,O),_=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_next_n_replies",A)),t.removeChild(t.firstChild),t.insertBefore(document.createTextNode(_),t.firstChild)}else P?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertBefore)(e,O),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(t,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_prev_n_replies",A))):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertAfter)(e,O),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(t,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_next_n_replies",A)));(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"count",A),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"offset",T)}}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_wrap_deep"+e),"replies_deep_has_short");const g=n.offsetHeight-c;if(D&&g){const _=b+g;cur.wallLayer?wkLayerWrap.scrollTop=_:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollToY)(_,0,!1,!0)}wall.updateCollapseDeepReplies(e),wall.updateMentionsIndex(),wall.addReplyNames(o),wall.addDeepRepliesBlock(e),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[p]=1,wall.repliesSideSetup(p),wall.updateRepliesOnScroll()},onFail:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(_,"replies_next_pre_deleted")},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(_,"replies_next_pre_deleted"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertAfter)(P,_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(P)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(P)}}),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(!1)},emojiOpts:{},emojiShowTT:function(_,e,t){return void 0!==Wall.emojiOpts[_]&&Emoji.ttShow(Wall.emojiOpts[_],e,t)},emojiHideTT:function(_,e,t){return void 0!==Wall.emojiOpts[_]&&Emoji.ttHide(Wall.emojiOpts[_],e,t)},initReplyEditable:function(_,e,t,o,i){if(_.emojiInited)return!1;const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_button"+t),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_media_preview"+t);_.emojiInited=!0,window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){const a=Emoji.init(_,{ttDiff:o?-40:-42,rPointer:!0,controlsCont:e,noStickers:"undefined"!=typeof mvcur&&!!mvcur.noStickers,shouldFocus:!i,ref:"reply",onSend:function(){Wall.sendReply(t),_.blur()},ctrlSend:function(){return Wall.customCur().wallTpl.reply_multiline||Wall.composerListShown(_)},checkEditable:function(){cur.onReplyChanged&&cur.onReplyChanged(_,t),Wall.checkTextLen(_,"reply_warn"+t)},onChange:function(){s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(s,"reply_send_disabled",!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(Emoji.editableVal(_))&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(l,"media_preview_has_medias")),Wall.hideCheckTimer(t,"editing")},onStickerSend:function(_,e){Wall.sendReply(t,!1,{stickerId:_,sticker_referrer:e})},initUploadForImagePasteCallback:Page.initUploadForImagePaste});if(vk.widget&&!window.emojiStickers&&Emoji.updateTabs(),Wall.emojiOpts[t]=a,cur.afterEmojiInit&&cur.afterEmojiInit[t]){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("emoji_smile",Emoji.opts[a].controlsCont);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(_)&&(cur.afterEmojiInit[t](),delete cur.afterEmojiInit[t])}}))},initEditReply:function(_,e,t,o){let i=_,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_field"+_);const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_);let a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_fakebox"+_),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_box"+_);const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(l,"reply"),d=cur.wallLayer?wkcur:cur;let E,c=!1;if(r){if(E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",l)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",l),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(E,"deep_active"),c){if(!cur.reply_to){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(l,"answering-id");if(e){const t=_.split("_")[1];cur.reply_to=[(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(t)],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("reply_to"+_,t)}}wall.addDeepRepliesBlock(_),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_fakebox"+_)}i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(E,"post-id")}else cur.wallLayer?(c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wl_post"),"deep_active"),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wl_reply_form_inner")):(E=l,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(E,"deep_active"));if(!E&&a?E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("_post_wrap",a):E&&!cur.pvShown||!n||(E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("_post_wrap",n)),a){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+i),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"can_reply_as_group"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"can_reply_as_any_group"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(a,"owner-photo")||"",E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(a,"owner-href")||"",p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(a,"owner-name")||"",u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(a,"owner-is-nft")||"",P=(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_36__.replyBoxOwnerIsNftFromAttr)(u),b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(a,"user-name")||"";let O="";o?O=d.wallTpl.reply_form_any_group:t&&(O=d.wallTpl.reply_form_group);const{is_nft:D,avatar_url:M}=d.wallTpl.default_replier,w=r&&c?_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.REPLY_IMAGE_SMALL_SIZE:_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.REPLY_IMAGE_DEFAULT_SIZE,m=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(d.wallTpl.reply_form_user_image,{href:"",primary_image:(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_48__.getPostAvatarString)(M,"post_field_user_image",w,D,null,b),secondary_image:(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_48__.getPostAvatarString)(l,"post_field_user_image",w,P,"post_field_image_secondary",p)});n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(c&&d.wallTpl.reply_form_new?d.wallTpl.reply_form_new:d.wallTpl.reply_form,{add_buttons:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(O,{post_id:_,oid:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(_),owner_photo:l||"/images/blank.gif",primary_image:(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_48__.getPostAvatarString)(M,"post_field_choose_image",w,D,null,b),secondary_image:(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_48__.getPostAvatarString)(l,"post_field_choose_image",w,P,"post_field_choose_secondary",p)}),post_id:_,oid:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(_),owner_is_nft:u,owner_photo:l,owner_href:E,owner_name:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.unclean)(p)),reply_image:m})),a.parentNode.replaceChild(n,a),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_field"+_)}if(!s){throw new Error("Failed to init new reply or edit reply: no reply field")}if(Wall.initReplyEditable(s,n,_,e,t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(s,"composer"))o&&o();else{const e=[];let t,l,a,n,r=!1;window.mvcur&&mvcur.mvShown?t=mvcur.mvMediaTypes:cur.wallLayer==i?t=wkcur.options.rmedia_types:window.pvcur&&cur.pvShown?(t=pvcur.rmedia_types,l=0,a=0):t=d.options&&d.options.rmedia_types,(c||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(E.parentElement,"VerticalVideoLayerInfo__commentsReply"))&&(r=!0,l=0,a=0),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(t||d.options&&d.options.media_types||[],(function(){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.inArray)(this[0],["photo","video","audio","doc","link","page"])&&e.push(this)}));let p=!1;const u=i.match(/^(\d+_)?-?\d+_(photo|video|topic|market)?\d+(mv)?(_\d+)?$/);e.length>0&&u?(n={lnk:c?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_more_attaches"+_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_add_media_"+_),preview:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_media_preview"+_),actionsEl:!1,gearEl:!1,types:e,options:{from:"topic"===u[2]?"board":"comment",limit:2,disabledTypes:["album","market","market_album","online_booking","poll",_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_GROUP],toggleLnk:!0,maxShown:void 0!==l?l:void 0,hideAfterCount:void 0!==a?a:void 0,vectorIcon:r,hideLabel:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_reply_add_attach_label"),toId:"full"===cur.wallType?cur.oid:cur.postTo,onToggleBlock:function(e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_box"+_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("reply_box_photo",t);o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggle)(o,e)},onMediaChanged:function(){Wall.hideCheckTimer(_,"editing"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)("reply_button"+_,"reply_send_disabled",!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(Emoji.editableVal(s))&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)("reply_media_preview"+_,"media_preview_has_medias"))}}},i.match(/^-?\d+_topic/)&&((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(n.options,{disabledTypes:["album","share","link","page"],limit:10,editable:1,sortable:1,teWidth:280,teHeight:200}),p=!0)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)("reply_add_media_"+_),Wall.initComposer(s,{lang:{introText:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("profile_mention_start_typing"),noResult:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("profile_mention_not_found")},toup:p,wddClass:"reply_composer_dd",width:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(s.parentNode)[0],media:n,isReply:!0},o)}return void 0!==s.emojiId&&cur.afterEmojiInit&&cur.afterEmojiInit[_]&&(cur.afterEmojiInit[_](),delete cur.afterEmojiInit[_]),{postId:i,postEl:E,isReply:r,rf:s}},showEditReply:function(_,e,t,o,i,s){if(cur.viewAsBox)return setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_field"+_).blur()}),0),cur.viewAsBox();if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)("post"+_,"Post--with_closed_comments_donut"))return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.setStyle)("replies_wrap"+_,{display:""}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(e);const l=wall.initEditReply(_,t,i,s);if(l.rf){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domClosest)("reply_box_wrap",l.rf));const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("replies_wrap_deep",l.rf);_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(_,"replies_deep_has_field")}return cur.wallMyOpened&&(cur.wallMyOpened[_]=cur.wallMyOpened[_]||!1),cur.editing===_?(Emoji.editableFocus(l.rf,!1,!0),!1):(Wall.hideEditPostReply(),l.isReply?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_wrap_deep"+_),"deep_reply_box_open"):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(l.postEl,"reply_box_open"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(l.postEl,"post--replyBoxWasOpened")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.setStyle)("replies_wrap"+_,{display:""}),cur.editing=_,window.Emoji&&setTimeout((function(){Emoji.editableFocus(l.rf,!1,!0),Wall.repliesSideOver(_)}),0),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.triggerEvent)(window,"scroll"),void 0!==l.rf.emojiId&&cur.afterEmojiInit&&cur.afterEmojiInit[_]&&(cur.afterEmojiInit[_](),delete cur.afterEmojiInit[_]),cur.wallTpl&&cur.wallTpl.reply_multiline_intro&&ajax.post("al_wall.php",{act:"a_ctrl_submit_intro",hash:cur.wallTpl.poll_hash},{onDone:function(e){e&&cur.editing===l.postId&&Wall.replySubmitTooltip(_,1)},onFail:function(){return!0}}),window.mvcur&&(mvcur.post==l.postId&&Videoview.onShowEditReply(),mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),mvcur.scrollBottom&&mvcur.scrollBottom()),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(cur.onReplyFormSizeUpdate)&&cur.onReplyFormSizeUpdate(l.rf),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(cur.onReplyFormFocus)&&cur.onReplyFormFocus(l.rf),!1)},hideEditReply:function(_,e){cur.editing=!1;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_field"+_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_box"+_),s=cur.reply_to&&Wall.getReplyName(cur.reply_to[0]);let l=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(window.Emoji?Emoji.editableVal(t):"");const a=Wall.hasComposerMedia(t);let n;const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(o,"reply");if(n=cur.wallLayer?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wl_reply_form_inner"):r?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",o):o,n&&!cur.pvShown||!i||(n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("_post_wrap",i)),!t||a&&!e)return;if(s&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(s)&&s[1]&&(l&&s[1].indexOf(l)||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(t,""),l="")),e&&(l||a)){const _=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(t,"composer");_?Composer.reset(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(t,""),l="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("reply_warn",n))}if(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.opera_mobile||_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile||l)return;(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.curBox)()&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.curBox)().isVisible()||(r?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_wrap_deep"+_),"deep_reply_box_open"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(n,"reply_box_open")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_link"+_)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("replies_wrap"+_),window.tooltips&&i&&tooltips.hideAll(i),t.blur(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.triggerEvent)(window,"scroll"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("reply_to"+_,""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("reply_to_title"+_),cur.reply_to=!1;const d=Wall.emojiOpts[_];d>=0&&Emoji.opts[d]&&Emoji.opts[d].onChange&&Emoji.opts[d].onChange(),cur.onReplyFormSizeUpdate&&cur.onReplyFormSizeUpdate();const E=cur.replySubmitSettings;E&&E.tt&&E.tt.el&&E.tt.destroy(),window.mvcur&&mvcur.post==_&&(Videoview.onHideEditReply(),mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate())},replyNamesRE:function(){wall.addReplyNames({});const _=wall.getReplyNames();if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isEmpty)(_))return!1;const e=[];return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(_,(function(_,t){t&&((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(t)&&(t=t[1]),"string"==typeof t&&e.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.escapeRE)(t)))})),new RegExp("^("+e.join("|")+")")},replyTo:function(_,e,t,o){const i=window.cur.wallLayer==_?wkcur:window.cur;Wall.showEditReply(_,o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("reply_to"+_,e);const s=i.reply_to&&Wall.getReplyName(i.reply_to[0]);i.reply_to=[t,e];const l=Wall.getReplyName(t),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_as_group"+_),n=_.replace("topic","").match(/^(-?\d+)_([a-z]+)?(\d+)([a-z]+)?$/),r=n[1],d=n[2]||"",E=n[4]||"",c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+r+d+"_"+e),p=c&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("reply_to",c,"a"),u=Wall.replyNamesRE(),P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",c)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",c),b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(P,"deep_active"),O=b?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("replies_wrap_deep",c):null,D=O?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(O,"post-id"):_;let M="";if(!b||O){let _=((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(l)?l[0]:l)||"";_='<a class="reply_to_mem" onclick="return wall.showReply(this, \''+D+"', '"+r+d+"_"+e+E+"', event);\">"+_+"</a>";const t=`<span class="reply_to_cancel" onclick="return Wall.cancelReplyTo('${D}', event);">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_91__.getIcon12Cancel)().icon}</span>`,o='<div class="reply_to_label">'+(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.langStr)(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_reply_to"),"user",_)+"</div>";M=b?o+t:t+o}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("reply_to_title"+D,M);const w=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_field"+D);if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(l)&&l[1]&&window.Emoji){const e=w;let t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(Emoji.val(e)));t=t.replace(/&nbsp;/g," "),!t||s&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(s)&&!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.winToUtf)(s[1]).indexOf((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.winToUtf)(t))?Emoji.val(e,l[1]):u&&(t=t.replace(u,l[1]),Emoji.val(e,t));const o=Wall.emojiOpts[_];o>=0&&Emoji.opts[o]&&Emoji.opts[o].onChange&&Emoji.opts[o].onChange(),Emoji.focus(e,!0)}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggle)("reply_to_title"+D,M),a){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(a.parentNode)&&_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(r)&&p&&p.getAttribute("rid")===r;Wall.setReplyAsGroup(a,{from:_?r:vk.id})}const m=(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_36__.getFixedReplyField)();return b&&w&&m&&(0,_web_wall_deep_replies_utils__WEBPACK_IMPORTED_MODULE_34__.scrollOutsideFixedReplyArea)(w,m),i.onReplyFormSizeUpdate&&i.onReplyFormSizeUpdate(),window.mvcur&&mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.stopEvent)(o),!1},cancelReplyTo:function(_,e){const t=window.cur.wallLayer==_?wkcur:window.cur,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_field"+_),i=t.reply_to&&Wall.getReplyName(t.reply_to[0]);let s=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(window.Emoji?Emoji.editableVal(o):""));const l=Wall.replyNamesRE(),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",a)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",a),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(n,"deep_active");if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(i)&&i[1]&&window.Emoji){s&&i[1].indexOf(s)?l&&(s=s.replace(l,""),Emoji.val(o,s)):(s="",Emoji.val(o,s));const e=Wall.emojiOpts[_];e>=0&&Emoji.opts[e]&&Emoji.opts[e].onChange&&Emoji.opts[e].onChange(),Emoji.focus(o,!0)}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("reply_to_title"+_),r){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(a,"answering-id");if(e){const o=_.split("_")[1];t.reply_to=[(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(o)],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("reply_to"+_,o)}else t.reply_to=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("reply_to"+_,"")}else window.mvcur&&mvcur.post==_?mvcur.mvReplyTo=!1:t.reply_to=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("reply_to"+_,"");return t.onReplyFormSizeUpdate&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(t.onReplyFormSizeUpdate)&&t.onReplyFormSizeUpdate(o),window.mvcur&&mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.stopEvent)(e),!1},replySubmitTooltip:function(_,e,t){const o=_&&window.cur.wallLayer==_?wkcur:window.cur,i=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_box"+_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_fakebox"+_)),s=i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("button_blue",i,"div");let l=o.replySubmitSettings;if(t&&s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(s))return;if(t=t||s,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"flat_button")&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isButtonLocked)(t)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"button_disabled"))return void(!e&&l&&l.tt&&l.tt.hide&&l.tt.hide());if(l||(l=o.replySubmitSettings=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{className:"reply_submit_hint_tt_point"})),!e)return void(l&&l.tt&&l.tt.hide&&l.tt.hide());if(!t)return;if(l.parentNode==t&&l.tt&&l.tt.show)return void l.tt.show();l.tt&&l.tt.el&&l.tt.destroy(),t.insertBefore(l,t.firstChild);const a=Wall.customCur().wallTpl.reply_multiline?1:0,n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(Wall.customCur().wallTpl.reply_multiline_hint,{enabled:a?"on":"",disabled:a?"":"on",wall_reply_submit_settings:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_reply_submit_settings"),wall_reply_submit_settings_1:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_reply_submit_settings_1"),wall_reply_submit_settings_2:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_reply_submit_settings_2")}),r=i&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",i)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",i)),d=r&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(r,"deep_active");(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_11__.showTooltip)(l,{text:n,typeClass:"tt_default_right",slide:15,shift:d?[15,8]:[0,8],asrtl:1,hasover:1,toup:!1,showdt:700,hidedt:700,dir:"auto",noZIndex:!0,onCreate:function(){radioBtns.reply_submit={els:Array.prototype.slice.apply((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("radiobtn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_submit_hint_opts"))),val:n?1:0}}})},onReplySubmitChanged:function(_,e){if(cur.wallTpl?cur.wallTpl.reply_multiline=_:mvcur.wallTpl&&(mvcur.wallTpl.reply_multiline=_),Wall.customCur().wallTpl&&(Wall.customCur().wallTpl.reply_multiline=_),e){const _=cur.replySubmitSettings;_&&_.tt&&_.tt.el&&_.tt.destroy()}else ajax.post("al_wall.php",{act:"a_save_ctrl_submit",value:_,hash:Wall.customCur().wallTpl.poll_hash}),window.Notifier&&Notifier.lcSend("wall_reply_multiline",{value:_})},getReplyFromId:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_as_group"+_);return!(!e||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(e.parentNode))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domClosest)("_submit_post_box",e),"from-oid")},showCheckTimer(_,e,t){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_field"+_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_box"+_),s=i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("WallCheckComment__timer",i);if(!o||!s)return;(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_11__.showTooltip)(o,{text:t.description,showdt:0,hidedt:0,shift:[0,-1],width:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(o)[0],forcetoup:!0,nohide:!0,noZIndex:_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.msie_edge,className:"WallCheckComment__tt"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByTag)("span",s).forEach((_=>{_.style.animationDuration=`${t.delay}s`})),i.classList.add("WallCheckComment--shown");const l=setTimeout((()=>{i.classList.remove("WallCheckComment--shown"),Wall.sendReply(_,void 0,e)}),1e3*t.delay);s.timeout=l,s.onclick=()=>{Wall.hideCheckTimer(_,"button")},cur.destroy||(cur.destroy=[]),cur.destroy.push((()=>{l&&clearTimeout(l)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.elfocus)(o)},hideCheckTimer(_,e=!1){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_field"+_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_box"+_),i=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("WallCheckComment__timer",o);if(!t||!i)return;const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"check_timestamp");e&&s&&Wall.isCheckTimerShown(_)&&ajax.post("al_wall.php",{act:"check_comment_cancelled",post_raw:_,timestamp:s,reason:e}),i.timeout&&clearTimeout(i.timeout),t.tt&&t.tt.hide&&t.tt.hide(),o.classList.remove("WallCheckComment--shown"),"button"===e&&setTimeout((()=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.elfocus)(t)),0)},isCheckTimerShown(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_box"+_);return e&&e.classList.contains("WallCheckComment--shown")},isPostAuthor(_,e){const t=parseInt(_.dataset.postSignerOrAuthorId);return!!t&&!!e&&t===e},sendReply:function(_,e,t){t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({},t);const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_wrap_deep"+_);let i,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("reply_to"+_);if(o?(i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",o),"post-id"),s=s||_.split("_")[1]):i=_,window.mvcur&&mvcur.post==i)return Videoview.sendComment(i,e,t);const l=window.cur.wallLayer==i,a=l?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+i),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+_),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(a,"deep_active"),d=l?wkcur:window.cur,E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_field"+_),c=E&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(E,"composer"),p=d.reply_to&&Wall.getReplyName(d.reply_to[0]);let u,P;const b=E&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(E,"send");if(b&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(b))return b(_,e,t);if(t.stickerId)P={message:"",attach1_type:"sticker",attach1:t.stickerId,sticker_referrer:t.sticker_referrer};else if(t.suggest)P={message:t.suggest};else{if(P=c?Composer.getSendParams(c,Wall.sendReply.pbind(_)):{message:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)(Emoji.editableVal(E))},P.delayed)return;if(!P.attach1_type&&(!P.message||(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(p)&&p[1]&&!p[1].indexOf(P.message)))return void Emoji.editableFocus((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_field"+_),!1,!0)}let O;const D=window.wkcur&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wk_content");if(E&&(D&&D.contains(E)?wkcur.wallCheckComments:d.wallCheckComments)){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(E,"check_in_progress"))return;if(O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(E,"check_timestamp")||void 0,!O)return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.stopEvent)(e),void ajax.post("al_wall.php",{act:"check_comment",post_raw:i,text:P.message},{onDone(e){e&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(E,"check_timestamp",e.timestamp),e.description&&e.delay)?Wall.showCheckTimer(_,t,e):Wall.sendReply(_,void 0,t)},onFail:()=>((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(E,"check_timestamp",Date.now()),Wall.sendReply(_,void 0,t),!0),showProgress(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(E,"check_in_progress",!0)},hideProgress(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(E,"check_in_progress",null)}});if(Wall.isCheckTimerShown(_))return void Wall.hideCheckTimer(_,"button");Wall.hideCheckTimer(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(E,"check_timestamp",null)}t.stickerId||t.suggest||(c?u=Composer.reset(c):window.Emoji&&Emoji.val(E,""),E.autosize&&E.autosize.update()),d.wallMyOpened=d.wallMyOpened||{},d.wallMyReplied[i]=1,d.wallMyOpened[i]=1;const M=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_hash"+i)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_hash"+i).value:d.options.post_hash;let w=null,m=r&&(o||!l&&"full"!==d.wallType);const C=wall.getRepliesOrder(i),T=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(n,"top-ids");let h=!1;if(m&&n){const _=!o&&wall.isDescRepliesOrder(i,C)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domFC)(n):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domLC)(n);_?.classList.contains("replies_next_inline")?(m=!0,h=!1):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"replies_next")&&(m=!1,h=!0)}const A=(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.getTrackCodeFromPost)(a);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(P,{act:"post",type:d.wallType,reply_to:i,reply_to_msg:s,reply_to_user:d.reply_to&&d.reply_to[0]||0,start_id:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("start_reply"+i),from:l?"wkview":"",hash:M,only_new:m?1:0,need_last:h?1:0,order:C,top_replies:T||null,timestamp:O,ref:(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.resolveRefFromCur)(),track_code:A,event_subtype:(0,_web_feed_feed_stats__WEBPACK_IMPORTED_MODULE_72__.getFeedEventSubtype)()}),d.reverse&&(P.rev=1);const g=wall.getReplyFromId(_);let R;if(g&&(P.from_oid=g),R=d.wallType?"feed"==d.wallType?"news"==d.section?"feed_"+(d.subsection?d.subsection:d.section):"recommended"==d.section?"feed_recommended"+("recent"!=d.subsection?"_"+d.subsection:""):-1!==["friends","groups","videos","photos","list"].indexOf(d.section)?"feed_"+d.section+(d.subsection?"_"+d.subsection:""):"feed_"+d.section:"top"==d.wallType?"wall_top":"wall_"+(d.onepost?"one":(d.wallType||"").indexOf("full_")?"page":"full"):d.module,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(P,{ref:R}),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mobile?Wall.hideEditReply(_):(Emoji.editableFocus(E,!1,!0),Wall.cancelReplyTo(_,e)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("reply_warn"+_),ajax.post("al_wall.php",Wall.fixPostParams(P),{onDone:function(e,t,o,s){if(r){if(m)return wall.onOnlyNewReplySent.apply(window,arguments);if(h)return wall.onLastChunkReplySent.apply(window,arguments);if(l)return wall.onNewReplySentLayer.apply(window,arguments)}if("full"===d.wallType)return r?FullWall.onNewReplySent.apply(window,arguments):FullWall.onReplySent.apply(window,arguments);d.wallMyReplied[i]=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)("reply_link"+i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("reply_warn"+i),Wall._repliesLoaded(_,!1,t,o,s),Wall.processPostReplyActions(e)},onFail:function(_){if(w&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(w),c?u=Composer.restore(c,u):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(E,P.message),E.autosize&&E.autosize.update(),_)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_error"),_),!0},showProgress:function(){r?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disableButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_button"+_),!0):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_button"+_))},hideProgress:function(){r?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disableButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_button"+_),!1):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_button"+_))}}),window.cur.onPostReply&&window.cur.onPostReply(_),P.from_oid||!P.message||m)return;const I=-++d.wallMyRepliesCnt,L=Emoji.emojiToHTML((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clean)(P.message),!0),B=wall.getReplyNames(),W=_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(P.reply_to_user)?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_replied_to_group"):B[P.reply_to_user]&&B[P.reply_to_user][0],U=W?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(d.wallTpl.reply_link_to,{to_user:W}):"";if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("feed_author_replies_new_reply_fast_web")){const[_,e,,,,t]=this.replyAsProfileData(),i=(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_48__.getPostAvatarString)(e,"reply_image",o?_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.REPLY_IMAGE_SMALL_SIZE:_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.REPLY_IMAGE_DEFAULT_SIZE,t);w=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(d.wallTpl.reply_fast,{reply_id:"0_"+I,message:L.replace(/\n/g,"<br/>"),to_link:U,date:Wall.getNowRelTime(d),is_author_suffix:this.isPostAuthor(a,_)?d.wallTpl.is_author_suffix:"",reply_image:i}))}else w=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(d.wallTpl.reply_fast,{reply_id:"0_"+I,message:L.replace(/\n/g,"<br/>"),to_link:U,date:Wall.getNowRelTime(d)}));if(n&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(n)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_link"+_))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)("reply_link"+_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("replies_wrap"+_);else if(!d.onepost){const e=n.nextSibling;if(e&&"replies_open"==e.className&&Wall.openNewComments(_),!l){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("wr_header",n,"a"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("reply",n,"div").length+1,o=t;e&&(o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e.getAttribute("offs").split("/")[1])+1),(o>5||t<o)&&(e||n.insertBefore(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("a",{className:"wr_header"}),n.firstChild),Wall.updateRepliesHeader(_,e,t,o))}}d.reverse?n.insertBefore(w,n.firstChild):n.appendChild(w),l&&(WkView.wallUpdateReplies(),d.reverse||(wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll()))},onOnlyNewReplySent:function(_,e,t){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(o,"reply"),s=i?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",o):o,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(s,"post-id"),a=!i&&wall.isDescRepliesOrder(l);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(s,"deep_active"))return;const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("replies_wrap_deep",o);i&&n&&(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(n,"post-id"));const r=cur.wallLayer===l,d=Wall._getRepliesInfoBeforeAddNewReply(_,r),E=Wall._checkVisibilityBeforeAddNewReply(_,d,a,r);i&&wall.addDeepRepliesBlock(_);const c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)(e),p=d?.repliesListEl?.querySelector(".replies_next_inline");a&&d.repliesListEl.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertBefore)(c,d.repliesListEl.firstChild):p?p.insertAdjacentElement("beforebegin",c):d.repliesListEl.appendChild(c),Wall._fixScrollAfterAddNewReply(_,d,E,a,r),i&&wall.updateCollapseDeepReplies(_),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.highlightUpdatedReply)(c),wall.incReplyCounter(s),wall.addReplyNames(t)},onLastChunkReplySent:function(_,e,t,o,i,s){const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+i),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(l,"reply"),n=a?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",l)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",l):l,r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(n,"post-id"),d=!a&&wall.isDescRepliesOrder(r);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(n,"deep_active"))return;const E=cur.wallLayer===r,c=Wall._getRepliesInfoBeforeAddNewReply(i,E),p=Wall._checkVisibilityBeforeAddNewReply(i,c,d,E);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(c.repliesListEl,e),Wall._fixScrollAfterAddNewReply(i,c,p,d,E);const u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+s);u&&(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.highlightUpdatedReply)(u),a&&wall.updateCollapseDeepReplies(i),wall.incReplyCounter(n,1,_),wall.addReplyNames(o)},_getRepliesInfoBeforeAddNewReply:function(_,e){const t=e?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollGetY)(),o=window.innerHeight||document.documentElement.clientHeight,i=t+(e?0:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)("page_header_cont")[1]),s=t+o,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+_),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(l,e)[1],n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(l)[1];return{repliesListEl:l,scrollY:t,topY:i,bottomY:s,viewportHeight:o,repliesListY:a,repliesListH:n,repliesListEndY:a+n,layerFieldH:e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)("wl_reply_form")[1]:0}},_checkVisibilityBeforeAddNewReply:function(_,e,t,o){let i=!1;return i=t?o?e.repliesListY>0&&e.repliesListY<e.viewportHeight-e.layerFieldH:e.topY<e.repliesListY&&e.bottomY>e.repliesListY:o?e.repliesListEndY>0&&e.repliesListEndY<e.viewportHeight-e.layerFieldH:e.topY<e.repliesListEndY&&e.bottomY>e.repliesListEndY,i},_fixScrollAfterAddNewReply:function(_,e,t,o,i){const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(e.repliesListEl)[1];if(o)t||(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollToY)(e.repliesListY-100,300,!1,!0);else if(t){const _=e.scrollY+s-e.repliesListH;i?wkLayerWrap.scrollTop=_:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollToY)(_,0,!1,!0)}else{const _=e.repliesListY+s-300;i?(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_19__.animate)(wkLayerWrap,{scrollTop:e.scrollY+_},300):(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollToY)(_,300,!1,!0)}},incReplyCounter:function(_,e,t){e=e||1;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"post-id"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("comment",_);let s;i&&(t||(s=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(i,"count"),t=Math.max(0,s+e)),Likes.update("wall"+o,{comment_num:t}))},onNewReplySentLayer:function(_,e,t,o){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wl_post"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("wl_replies",i);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(s,e);const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domChildren)(s).filter((function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"reply")})).length;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(wkcur,{offset:t,loaded:l,count:_}),wall.addReplyNames(o),WkView.wallUpdateReplies();const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(i,"post-id");wall.isDescRepliesOrder(a)?wkLayerWrap.scrollTop=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(i)[1]-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)("wl_replies_wrap")[1]-30:wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll()},postTooltip:function(_,e,t,o){if(cur.viewAsBox)return;const i=(t||{}).reply,s=(t||{}).className||"",l=i&&!(i%2)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(_)[0]>420;o=o||{},i||(o.appendEl=document.body),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_11__.showTooltip)(_,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({url:"al_wall.php",params:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({act:"post_tt",post:e},t||{}),slide:15,shift:[l?417:27,6,6],ajaxdt:100,showdt:400,hidedt:200,dir:"auto",className:"rich wall_tt"+s,typeClass:l?"tt_default_right":"tt_default"},o))},adsMarkTooltip:function(_){cur.viewAsBox||(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_11__.showTooltip)(_,{black:1,shift:[15,7,0],text:_.getAttribute("data-tooltip")})},hideEditPostReply:function(_,e){if(!1===cur.editing)return;if(cur.wallLayer&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)("wl_post","deep_active")&&(e=!0),!e&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(boxLayerBG)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(layerBG)))return;const t=_&&_.target?_.target:{},o=t.id;cur.editing?cur.editingHide?cur.editingHide(cur.editing,t):_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domClosest)("_reply_wrap",t)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"reply_link")||o=="reply_field"+cur.editing||"reply_to_link"==t.className)||Wall.hideEditReply(cur.editing):(cur.wallAddMedia||{}).chosenMedia||_&&"post_field"==o||Wall.hideEditPost()},postShowDeletedMessage:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_);if(t){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_post_content",t)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("feedback_row_t",t);(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_20__.revertLastInlineVideo)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(o),"post_publish")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(o));const i="post_del"+_,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(i),l='<span class="dld_inner">'+e+"</span>";return s?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(s,l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(s)):t.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{id:i,className:"dld",innerHTML:l})),!0}return!1},postHideDeletedMessage:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_);if(e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_post_content",e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("feedback_row_t",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(t),"post_publish")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(t));const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_del"+_);return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(o),!0}return!1},isArchiveWall:function(){return cur.pgParams&&cur.pgParams.archive||"wall_archive"===cur.module},rollbackPostsArchiveState:function(_,e,t){if(!Wall.isArchiveWall()||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.linkLocked)(_))return;const o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e.split("_")[1]);ajax.post("al_wall_archive.php",{act:"a_rollback_state",from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_wall_more_tab")?"profile":"wall",postId:o,hash:t},{onDone:function(_){cur.wallArchiveRolledback=!0,Wall.postShowDeletedMessage(e,_)},showProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockLink)(_),hideProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockLink)(_)})},restoreLastRollbackPostsArchiveState:function(_,e,t){if(!Wall.isArchiveWall()||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.linkLocked)(_))return;const o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e.split("_")[1]);ajax.post("al_wall_archive.php",{act:"a_restore_last_rollback",from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_wall_more_tab")?"profile":"wall",postId:o,hash:t},{onDone:function(_){delete cur.wallArchiveRolledback,Wall.postShowDeletedMessage(e,_)},showProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockLink)(_),hideProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockLink)(_)})},postSetArchiveState:function(actionEl,postRaw,hash,state,isRollback){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.actionsMenuItemLocked)(actionEl)||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.linkLocked)(actionEl))return;const postId=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(postRaw.split("_")[1]),isActionMenuItem=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(actionEl,"ui_actions_menu_item"),localCur=cur.wallLayer?wkcur:cur;localCur&&(localCur.wallMyDeleted||(localCur.wallMyDeleted={}),localCur.wallMyDeleted[postRaw]=!Wall.isArchiveWall()==!state?0:1);const extended=!isRollback&&(Wall.isArchiveWall()?cur.wallArchiveRestored>=3&&!cur.wallArchiveRolledback:!cur.wallArchiveArchived);if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("feed_post_menu_stats")&&1===state){const _=actionEl instanceof HTMLElement?(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.getTrackCodeFromPost)(actionEl):null;_shared_feed_stats_click_three_dots__WEBPACK_IMPORTED_MODULE_83__.FeedPostMenuStats.archivePost(_,(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.resolveRefFromCur)())}ajax.post("al_wall_archive.php",{act:"a_set_state",from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_wall_more_tab")?"profile":cur.pid?"post":"wall",hash,state:state?1:void 0,extended:extended?1:void 0,postId},{onDone:function(msg,js){if(Wall.isArchiveWall()&&(state=!state,isRollback||(cur.wallArchiveRestored||(cur.wallArchiveRestored=0),cur.wallArchiveRestored++)),state&&(cur.wallArchiveArchived=!0),isRollback?Wall.postHideDeletedMessage(postRaw):Wall.postShowDeletedMessage(postRaw,msg)){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+postRaw);"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(state?-1:1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"reply")&&(state?--cur.pgOffset:++cur.pgOffset,state?--cur.pgCount:++cur.pgCount,FullWall.repliesSummary(cur.pgCount)),"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"own")&&(state?++cur.deletedCnts.own:--cur.deletedCnts.own),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"all")&&(state?++cur.deletedCnts.all:--cur.deletedCnts.all),Wall.isArchiveWall()&&(state?--cur.deletedCnts.archive:++cur.deletedCnts.archive),Wall.update())}if(js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_24__.logEvalError)(_,js)}},showProgress:isActionMenuItem?_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockActionsMenuItem.pbind(actionEl):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockLink)(actionEl),hideProgress:isActionMenuItem?_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockActionsMenuItem.pbind(actionEl):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockLink)(actionEl)})},deletePost:function(_,e,t,o,i){if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsUpdateEnabled)()&&Wall.postponedPosts?.isLocked())return;(cur.wallLayer?wkcur:cur).wallMyDeleted[e]=1;const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+e),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("post_actions",s),a={act:"delete",post:e,hash:t,root:o?1:0,confirm:i?1:0,from:"wall"};if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("feed_post_menu_stats")){const e=_ instanceof HTMLElement?(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.getTrackCodeFromPost)(_):null;_shared_feed_stats_click_three_dots__WEBPACK_IMPORTED_MODULE_83__.FeedPostMenuStats.deletePost(e,(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.resolveRefFromCur)())}cur.suggestedDeletedCount&&cur.suggestedDeletedCount>=2&&(a.delete_all=1),(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_26__.isClaimContent)()&&(a._nol=JSON.stringify(window.nav.objLoc)),ajax.post("al_wall.php",a,{onDone:function(i,l,a,n){if(n)return void(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_error"),i);if(a){const s=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(i,a,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_delete"),(function(){s.hide(),wall.deletePost(_,e,t,o,1)}),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("box_cancel"));return}Wall.postShowDeletedMessage(e,i),"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(s,"reply")&&(cur.pgOffset--,cur.pgCount--,FullWall.repliesSummary(cur.pgCount));const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_publish_wrap"+e);r&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(r,"suggest")&&(void 0===cur.suggestedDeletedCount&&(cur.suggestedDeletedCount=0),cur.suggestedDeletedCount++),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(s,"suggest")?Wall.suggestUpdate(-1):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(s,"postponed")?(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsFixEnabled)()?(Wall.postponedPosts?.removePost(),wall.postponeUpdateCount(Wall.postponedPosts?.getPostsSize())):wall.postponeUpdateCount():"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(s,"own")&&++cur.deletedCnts.own,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(s,"all")&&++cur.deletedCnts.all,Wall.isArchiveWall()&&++cur.deletedCnts.archive,Wall.update())},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockActionsMenuItem)(_):_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.isFlatButton(_)?_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.lock(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(l,"post_actions_progress")},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockActionsMenuItem)(_):_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.isFlatButton(_)?_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.unlock(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(l,"post_actions_progress")}});const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("delete_post"+e);n&&n.tt&&n.tt.el&&n.tt.destroy()},markAsSpam:function(_,e,t,o,i){if(this.isAdPostMarkingAsSpam(e))return void this.markAdAsSpam(t,e,o,i);const[s,l]=e.split("_");window.Feed?.viewStats?.onReport(t);const a=(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.getTrackCodeFromPost)(t),n=(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.resolveRefFromCur)();a&&"wall"===_&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("feed_content_events_report_web")&&_shared_production_stats_click_feed_post_interaction__WEBPACK_IMPORTED_MODULE_67__.feedInteractionItemStatCollector.logEvent({track_code:a??void 0,ref:n,item:(0,_web_feed_feed_stats__WEBPACK_IMPORTED_MODULE_72__.getFeedInteractionItemType)()},_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_66__.EventItemType.REPORT),(0,_web_reports_reports__WEBPACK_IMPORTED_MODULE_45__.showReportForm)(_,s,l,(()=>{const _=document.querySelector(`#post${s}_${l}`);null!==_?_.innerHTML=`<div class="dld">${_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_report_sent")}</div>`:(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_24__.debugLog)("unable to find wall item")}))},pinReply:function(_,e,t,o){const i={act:"reply_pin",post_raw_id:_,reply_raw_id:e,hash:t,action:o};ajax.post("al_wall.php",i,{onDone:function(_,e){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(_,e)}})},isAdPostMarkingAsSpam:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_);return!!e&&(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.getAdAttribute)(e,"ad")},markAdAsSpam:function(el,post,hash,inline){const adDataPost=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+post),adData=(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.getAdAttribute)(adDataPost,"ad");ajax.post("al_wall.php",{act:"spam",post,ad_data:adData,hash,from:inline?"inline":""},{onDone:function(msg,js,js2){if("string"!=typeof js&&js2&&(js=js2),inline)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(el).replaceChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{innerHTML:msg}),el);else{const postSelector=`#post${post}`,r=el.closest(postSelector)||document.querySelector(postSelector),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_post_content",r)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("feedback_row_t",r);(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_20__.revertLastInlineVideo)(r);const pd=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_del"+post);if(pd?(pd.innerHTML=msg,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(pd)):r.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{id:"post_del"+post,innerHTML:msg})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(t),js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_24__.logEvalError)(_,js)}adData&&Wall._setAdReportHandler(post,adData,hash)}},showProgress:function(){el&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(el,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockActionsMenuItem)(el):inline&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(el),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(el)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(el).appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("span",{className:"progress_inline"}))))},hideProgress:function(){el&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(el,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockActionsMenuItem)(el):inline&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(el),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(el)))},stat:[window.jsc("web/privacy.js"),"privacy.css"]});const btn=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("delete_post"+post);btn&&btn.tt&&btn.tt.el&&btn.tt.destroy()},_setAdReportHandler(_,e,t){const o="ad_report_"+_,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(o+"_send");if(!i)return;const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("radiobtn",o),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("radiobtn on",o);window.radioBtns[o]={val:l.dataset.value||1,els:s};const a=()=>{const[s,l]=_.split("_"),n=window.radioBtns[o].val;ajax.post("reports.php",{act:"report_ad_common",type:"ad",oid:s,item_id:l,hash:t,reason:n,ad_data:e},{onDone:()=>{delete window.radioBtns[o],i.removeEventListener("click",a),window.closeChosenReportReasonBlock(s,l),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.showDoneBox)(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("reports_warning_sent"))},onFail:_=>((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.showDoneBox)(_),!1),showProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.lock(i),hideProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.unlock(i)})};i.addEventListener("click",a)},showIgnoreItemReasons:function(_,e,t,o,i,s,l){const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+e);if(!a)return;const n=(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.getAdAttribute)(a,"ad");(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_20__.revertLastInlineVideo)(a),(0,_shared_pixels__WEBPACK_IMPORTED_MODULE_79__.logPixelEvent)(a,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_82__.PixelNames.closed_by_user),ajax.post("/al_wall.php",{act:"get_ignore_reasons",post_raw:e,feed_raw:t,caption_type:i,uids:s,hash:o,ad_data:n,mode:l},{onDone:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(a,_);const n="ad_hide_"+e,r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(n+"_send");if(!r)return;const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("radiobtn",n),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("radiobtn on",n);window.radioBtns[n]={val:E.dataset.value||1,els:d},r.addEventListener("click",(()=>{_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.lock(r);const _=window.radioBtns[n].val,d="feed"===l?window.feed.ignoreItem:wall.ignoreAdsItem,E=(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.getTrackCodeFromPost)(a);d(e,t,o,i,s,_,E).then((()=>{Wall.triggerAdStat(a,"hide"),delete window.radioBtns[n]})).catch((()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.unlock(r)))}))},showProgress:function(){_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"ui_actions_menu_item")&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockActionsMenuItem)(_)},hideProgress:function(){_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"ui_actions_menu_item")&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockActionsMenuItem)(_)}})},ignoreAdsItem:function(_,e,t,o,i,s=0,l=""){const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_),n=(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.getAdAttribute)(a,"ad"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_actions_menu_wrap",a);if(a)return r&&uiActionsMenu.toggle(r,!1),(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_20__.revertLastInlineVideo)(a),new Promise(((o,i)=>{ajax.post("/al_feed.php",{act:"a_ignore_item",post_raw:_,track_code:l,feed_raw:e,hash:t,ad_data:n,no_html:1,reason_id:s},{onDone:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(a),o()},onFail:i})}))},ignoreAdsOwner:function(_,e,t,o){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_);i&&ajax.post("/al_feed.php",{act:"a_ignore_owner",post_raw:_,owner_id:e,hash:t,list:0,no_html:1},{onDone:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(i)},showProgress:o&&_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton.pbind(o),hideProgress:o&&_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton.pbind(o)})},markAsAds:function(_,e,t,o){ajax.post("al_wall.php",{act:"mark_as_ads",post:_,hash:e,full:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(o)},{onDone:function(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("ui_actions_menu_item_mark_as_ads"+_).innerHTML=e}})},restorePost:function(_,e,t){return(cur.wallLayer?wkcur:cur).wallMyDeleted[_]=0,ajax.post("al_wall.php",{act:"restore",post:_,hash:e,root:t?1:0},{onDone:function(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)("post_del_btn"+_),!Wall.postHideDeletedMessage(_))return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_);"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"reply")&&(cur.pgOffset++,cur.pgCount++,FullWall.repliesSummary(cur.pgCount)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"suggest")?Wall.suggestUpdate(1):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"postponed")?(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsFixEnabled)()?(Wall.postponedPosts?.restorePost(),wall.postponeUpdateCount(Wall.postponedPosts?.getPostsSize())):wall.postponeUpdateCount():"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"own")&&--cur.deletedCnts.own,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"all")&&--cur.deletedCnts.all,Wall.isArchiveWall()&&--cur.deletedCnts.archive,Wall.update())}}),!1},blockPostApp:function(_,e,t,o){ajax.post("al_wall.php",{act:"block_post_app",aid:_,from:e,hash:t},{onDone:function(_){o.parentNode.parentNode.innerHTML=_},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton.pbind(o),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton.pbind(o)})},sendExpandStatsGlobal:_=>{const e=document.getElementById("post"+_);(0,_web_feed_components_text_stats__WEBPACK_IMPORTED_MODULE_70__.sendExpandStats)(e)},checkPostClick:function(_,e,t){if(e=e||window.event,!_||!e)return!0;let o=e.target||e.srcElement,i=8,s=!1,l=/wall_post_text|published_comment|post_media|page_event_share|page_public_share|page_group_share|feed_friends|feed_videos|feed_explain_list|explain|feed_photos|feedback_row/;do{if(!o||o==_||o.onclick||o.onmousedown||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.inArray)(o.tagName,["A","IMG","TEXTAREA","EMBED","OBJECT"])||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.inArray)(o.className,["play_new","video_box_wrap"])||(s=o.className.match&&o.className.match(l))||o?.closest("."+_shared_stickers_refactor_constants__WEBPACK_IMPORTED_MODULE_75__.POPUP_STICKER_ICON_CLASS))break}while(i--&&(o=o.parentNode));if(!s)return!1;if(cur.postClicked||(cur.postClicked={}),!t||!cur.postClicked[_]){if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString()))return!1;t&&(cur.postClicked[_]=!0,setTimeout((function(){cur.postClicked[_]=!1}),2e3))}return o||!0},postClick:function(_,e,t){if((0,_web_stickers_Stickers_helpers__WEBPACK_IMPORTED_MODULE_71__.checkStopActionOnEventOnSticker)(e))return;if((0,_shared_short_video_utils__WEBPACK_IMPORTED_MODULE_69__.checkStopActionOnEventOnShortVideo)(e)&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("clips_web_redesign")&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("clips_open_direct_link"))return;t=t||{};const o=(_||"").match(/^(-?\d+)_(wall)?(\d+)$/),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_);let s;const{target:l}=e;window?.searcher?.onPostClick?.(l);const a=(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.getTrackCodeFromPost)(i);if(l&&"A"===l.tagName&&l.href&&(0,_shared_feed_feed_utils__WEBPACK_IMPORTED_MODULE_68__.checkIfInternalLink)(l.href)&&(0,_web_feed_feed_stats__WEBPACK_IMPORTED_MODULE_72__.checkIfLinkIsValid)(l)&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("post_click_analytics_int_ext_link_click_web")&&_shared_production_stats_click_feed_post_interaction__WEBPACK_IMPORTED_MODULE_67__.feedInteractionItemStatCollector.logEvent({track_code:a??void 0,ref:(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.resolveRefFromCur)(),item:(0,_web_feed_feed_stats__WEBPACK_IMPORTED_MODULE_72__.getFeedInteractionItemType)()},_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_66__.EventItemType.INT_LINK_CLICK),s=!!t.skipCheck||Wall.checkPostClick(i,e),!s)return;if(!0!==s){if(!s.querySelector(".PostTextMore[data-open-post]")){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("wall_post_more",s,"a");if(_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(_))return _.onclick(),void(o||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(i,"wall_post_over"));const e=s.querySelector("button.PostTextMore");if(e)return e.click(),void e.remove()}}if(!o)return;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(i,"suggest")||cur.onepost)return;const n=i&&(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.getAdAttribute)(i,"ad"),r=i&&(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.getAdAttribute)(i,"ad-block-uid"),d="/wall"+o[1]+"_"+o[3];if(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mobile&&e){const _={};n&&r&&(_.params={_post_ad_data:n,_post_ad_block_unique_id:r}),nav.go(d,null,_)}else(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.checkEvent)(e)?window.open(d,"_blank"):(n&&r&&(t.ads_params={post_ad_data:n,ad_block_unique_id:r}),t.trackCode=(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.getTrackCodeFromPost)(i),t.postInteractionItem=_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_66__.FeedInteractionItemType.WALL_ITEM,t.postId=i?.getAttribute("id"),Wall.hideEditPostReply(),Wall.postFull("wall"+o[1]+"_"+o[3],!1,t))},postClickStat:function(_){const e=(_=(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.normEvent)(_)).currentTarget,t=[];(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.getAdAttribute)(e,"ad-view")&&(t.push(Wall.postsGetRaws(e)),Page.postsSeen(t));const o=_.target;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.inArray)(o.getAttribute("data-post-click-type"),["post_owner_img","post_owner_link"])||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(o,"author")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(o,"post_image")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(o,"post_img")?Wall.triggerAdStat(e,"click_post_owner"):("A"==_.target.nodeName&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wall_post_text",_.target,e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("page_media_thumbed_link",_.target,e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_.target,"lnk")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("lnk",_.target,e))&&Wall.triggerAdStat(e,"click_post_link")},adBlockClickStat:function(_,e){const t=(_=(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.normEvent)(_)).currentTarget;if(!t)return;const o="._ads_block_data_w",i=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("post_adblock_protection_promo")?`${_web_smoke_guard_smoke_screen_locator__WEBPACK_IMPORTED_MODULE_87__.Locator.getInstance().lookup(o)}, .post, ._post`:o,s=t.closest(i);if(!s)return;const l=[];(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.getAdAttribute)(s,"ad-view")&&(l.push(Wall.postsGetRaws(s)),Page.postsSeen(l)),Wall.triggerAdStat(s,e)},getAdsEvents:function(){return _shared_lib_ls__WEBPACK_IMPORTED_MODULE_14__.multiAccountLs.get(Wall.LS_ADS_EVENTS)||{}},setAdsEvents:function(_){_shared_lib_ls__WEBPACK_IMPORTED_MODULE_14__.multiAccountLs.set(Wall.LS_ADS_EVENTS,_)},cleanAdsEvents:function(){const _=Wall.getAdsEvents(),e=(new Date).getTime()/1e3|0;let t=!1;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(_,(function(o,i){e-i>=3600&&(delete _[o],t=!0)})),t&&Wall.setAdsEvents(_)},triggerAdPostStat:function(_,e){Wall.triggerAdStat(_,e)},triggerAdStat:function(elIdOrEl,event){const el="string"==typeof elIdOrEl?Wall.domPost(elIdOrEl):elIdOrEl;event===_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_82__.PixelNames.click&&(0,_shared_pixels__WEBPACK_IMPORTED_MODULE_79__.logPixelEvent)(el,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_82__.PixelNames.click);let pixels=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("post_adguard_protection_promo")?(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.getAdAttribute)(el,`ad-stat-${event}`):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(el,"ad-stat-"+event);for(;pixels;){const _=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("post_adblock_protection_promo")?(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.getAdAttribute)(el,"ad-block-uid"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(el,"ad-block-uid"),e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.inArray)(event,["load","impression","impression_long","video_start","video_play_3s","video_play_10s","video_play_25","video_play_50","video_play_75","video_play_95","video_play_100"]);if(e&&((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("post_adguard_protection_promo")?((0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.updateAdAttribute)(el,`ad-disabled-stat-${event}`,(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.getAdAttribute)(el,`ad-stat-${event}`)),(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.removeAdAttribute)(el,`ad-stat-${event}`)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(el,"ad-disabled-stat-"+event,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(el,"ad-stat-"+event)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(el,"ad-stat-"+event,null))),_&&e)try{const e=(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_26__.hashCode)(""+event+_),t=Wall.getAdsEvents();if(t[e])break;const o=(new Date).getTime()/1e3|0;t[e]=o,Wall.setAdsEvents(t)}catch(_){try{(0,_shared_pixels__WEBPACK_IMPORTED_MODULE_79__.logPixelEvent)?.(el,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_82__.PixelNames.error),console.log(_.message)}catch(_){}}pixels=pixels.split("$$$"),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(pixels,(function(_,e){const t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.vkImage)();t.src=e,t.onerror=function(){(0,_shared_pixels__WEBPACK_IMPORTED_MODULE_79__.logPixelEvent)?.(el,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_82__.PixelNames.error)}}));break}if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("ads_pixels_track_new_events_web_mvk"))(0,_shared_pixels__WEBPACK_IMPORTED_MODULE_79__.triggerAdHtmlEvent)(el,event);else{const statHtml=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("post_adguard_protection_promo")?(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.getAdAttribute)(el,`ad-stat-html-${event}`):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(el,"ad-stat-html-"+event);if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("post_adguard_protection_promo")?(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.removeAdAttribute)(el,`ad-stat-${event}`):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(el,"ad-stat-html-"+event,null),statHtml){const statElemWrap=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{innerHTML:statHtml});let elem;for(;elem=statElemWrap.firstChild;)if(el.appendChild(elem),"SCRIPT"===elem.tagName)try{eval(elem.innerHTML)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_24__.logEvalError)(_,elem.innerHTML)}}}},copyHistory:function(_,e,t,o){let i=(_=_||window.event).target||_.srcElement,s=8,l=!1,a=/published_a_quote/;do{if(!i||(l=i.className.match(a))||i.onclick||i.onmousedown||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.inArray)(i.tagName,["A","IMG"]))break}while(s--&&(i=i.parentNode));if(!l)return;return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString())?void 0:(ajax.post("al_wall.php",{act:"copy_history",post:t,offset:o,from:cur.module},{onDone:function(_){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(e))return;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(e),!_)return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(e),"published_by_quote")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(e):e;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(t).insertBefore((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.cf)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(t)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isAncestor)(t,"im_rows")?IM.updateScroll(!0):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isAncestor)(t,"wl_post")&&WkView.wallUpdateReplies()}}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(_))},postFull:function(_,e,t){if(_.match(/^wall-?\d+_\d+$/)&&!(t||{}).nolist&&(!cur.pgParams||!cur.pgParams.owners_only&&!cur.pgParams.q))switch(cur.wallType){case"all":case"full_all":_+="/all"}return(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_9__.showWiki)({w:_,reply:t?.reply},!1,e,t)},checkReplyClick:function(_,e){if(e=e||window.event,!_||!e)return!1;let t=e.target||e.srcElement,o=8,i=!1;do{if(!t||t==_||t.onclick||t.onmousedown||"A"==t.tagName&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"_reply_lnk")||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.inArray)(t.tagName,["IMG","TEXTAREA","EMBED","OBJECT"])&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"emoji")||"wpe_cont"==t.id||t.dataset.preventReplyClick||(i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"_reply_content")))break}while(o--&&(t=t.parentNode));if(!i)return!0;return!!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString())},replyClick:function(_,e,t,o){if((0,_web_stickers_Stickers_helpers__WEBPACK_IMPORTED_MODULE_71__.checkStopActionOnEventOnStickerPopupIcon)(t))return;if(t?.target.classList.contains(_web_Badges_constants__WEBPACK_IMPORTED_MODULE_54__.BADGE_COMMENT_SELECTOR))return;const i=_.split("_"),s=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(i[0]),l=i[1].replace(/-?\d+$/,""),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+s+l+"_"+e);let n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(n,"closed_comments")||!cur.stickerClicked&&Wall.checkReplyClick(a,t))return;(t||{}).cancelBubble=!0;const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("wall_reply_more",a,"a");if(r&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(r))return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(a,"reply_moreable"),void r.onclick();if(o){n=cur.wallLayer?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wl_post"):n;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(n,"deep_active"),{packId:s,clickData:l}=cur.stickerClicked||{};let r=_;if(i){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("replies_wrap_deep",a);r=_?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"post-id"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(a,"post-id")}const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_field"+r);cur.stickerClicked=null,!s||d&&d.emojiInited||(cur.afterEmojiInit=cur.afterEmojiInit||{},cur.afterEmojiInit[r]=function(){Emoji.clickSticker(s,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_field"+r),t,l)}),Wall.replyTo(r,e,o,t),s&&d&&d.emojiInited&&Emoji.clickSticker(s,d,t,l)}},stickerClick:function(_,e,t,o){return t&&(t.cancelBubble=!0),window.Emoji?e?(Emoji.getStickerPack(_).then((i=>{if(Boolean(i?.[Emoji.PACK_FIELD_IS_ACTIVE])){const t=e.closest(".reply");t?.onclick&&(cur.stickerClicked={packId:_,clickData:o},t.onclick())}else Emoji.clickSticker(_,null,t,o)})),!1):(Emoji.clickSticker(_,null,t,o),!1):(window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){Wall.stickerClick(_,e,t,o)})),!1)},domPost:function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_)},formatCount:function(_,e){return e=e||{},(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.formatCount)(_,e)},likeFullUpdate:function(_,e,t){const o=e.match(/^(wall|photo|video|note|topic|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(-?\d+_)(\d+)/);Likes.update(o?(o[1]||"wall")+o[2]+o[3]:e,t)},likeUpdate:function(_,e,t,o,i,s,l){l||(o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(o)),!1===_&&cur.wallLayer===e&&(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wl_post_body"));const a=e.match(/(-?\d+)(_?)(photo|video|note|topic|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),n=a[1]+"_"+a[4],r=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",_))||wall.domPost(n),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(r,l?"_views_wrap":s?"_share_wrap":"_like_wrap"),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(d,"_count");if(!E)return;if(!l&&!s){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(r,"_views_wrap"),i=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(t,"_count");!i||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"_auto_update")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(i)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(i)!=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(E)||wall.likeUpdate(_,e,0,this.formatCount(o),void 0,void 0,1)}const c=d.tt||{},p=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clone)(c.opts||{}),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(c.container,"_value"),P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(c.container,"_content"),b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(c.container,"_title");i&&b&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(b,i),c&&(c.likeInvalidated=!0),u&&(u.value=o),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_19__.animateCount)(E,l?o:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.langNumeric)(o,"%s",!0),{str:"auto",noWrapWidth:!!l}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(d,s?"my_share":"my_like",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(d,l?"no_views":s?"no_shares":"no_likes",!o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(P,"me_hidden",!t&&!l),o?c.el&&(!1===i?c.destroy&&c.destroy():(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(c.container)||i||!1===i||tooltips.show(c.el,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(p,{showdt:0}))):c.el&&c.hide();const O=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.langNumeric)(o,"%s",!0);if(l){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("feedback_views",r);let e=0;e=o.match(/^\d+$/)?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(o):5,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(_,"<em>"+o+"</em> "+_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_X_post_views",e,!0))}else if(s){let _="";o>0&&(_="<em>"+O+"</em> "+_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_X_shared",o,!0)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("feedback_share",r),_)}else{let _="";o>0&&(_="<em>"+O+"</em> "+_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_like")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("feedback_like",r),_)}},likeShareUpdate:function(_,e,t,o,i){return Wall.likeUpdate(_,e,t,o,i,!0)},like:function(_,e){if(!vk.id||cur.viewAsBox)return;const t=wall.domPost(_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(t,"_like_wrap"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(o,"_icon"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(o,"_count"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(i,"fw_like_icon")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(i,"fw_my_like"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(o,"my_like"),a=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),n=(a[3]||"wall")+a[1]+"_"+a[4];let r=cur.module;cur.wallType&&(r="feed"==cur.wallType?"feed_"+("news"==cur.section&&cur.subsection?cur.subsection:cur.section):"top"==cur.wallType?"wall_top":"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full")),ajax.post("like.php",{act:"a_do_"+(l?"un":"")+"like",object:n,hash:e,wall:2,from:r},{onDone:Wall.likeFullUpdate.pbind(!1,_)});const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(s);Wall.likeUpdate(!1,_,!l,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(d)+(l?-1:1)),cur.onWallLike&&cur.onWallLike()},bookmark:function(_,e){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(_,"bookmarked")},likeShare:function(_,e){if(!vk.id||cur.viewAsBox)return;const t=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),o=(t[3]||"wall")+t[1]+"_"+t[4],i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("like_share_"+o),s=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)(i);let l=cur.wallType?"feed"==cur.wallType?"feed_"+cur.section:"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full"):cur.module;"top"==cur.wallType&&(l="wall_top"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.checkbox)(i),ajax.post("like.php",{act:"a_do_"+(s?"un":"")+"publish",object:o,hash:e,wall:2,ref:l},{onDone:Wall.likeFullUpdate.pbind(!1,_)});const a=wall.domPost(_),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(a,"_like_wrap"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(n,"_icon"),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(a,"_count")),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(r,"fw_like_icon")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(r,"fw_my_like"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(n,"my_like");Wall.likeUpdate(!1,_,!0,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(d)+(E?0:1))},likeShareCustom:function(_,e){const t=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),o=(t[3]||"wall")+t[1]+"_"+t[4];(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showBox)("like.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({act:"publish_box",object:o},e))},likeShareCheckLen:function(_,e,t){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(e),t=t||255;const o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(_)).replace(/\n\n\n+/g,"\n\n");if(_.lastLen===o.length)return;const i=_.lastLen=o.length,s=i-o.replace(/\n/g,"").length;i>t-50||s>4?(i>t?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(e,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("text_exceeds_symbol_limit",i-t)):s>4?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(e,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_recommended_lines",s-4)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(e,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("text_N_symbols_remain",t-i)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(e)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(e)},showLikesPage:function(_,e,t){cur.likesBox.loadTabContent("like.php",{act:"a_get_members",object:_,published:e,offset:t,wall:1},e)},clearLikesCache:function(_,e){const t="^/like.php#"+(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_22__.toQueryString)({act:"a_get_members",object:_,published:e,offset:12345,wall:1,tab:e,only_content:1}).replace("12345","\\d+")+"$",o=new RegExp(t,"i");for(const _ in ajaxCache)o.test(_)&&delete ajaxCache[_]},subscribeByButton:_web_wall_post_subscribe_action_post_subscribe_action__WEBPACK_IMPORTED_MODULE_4__.subscribeByButton,subscribeByAction:_web_wall_post_subscribe_action_post_subscribe_action__WEBPACK_IMPORTED_MODULE_4__.subscribeByAction,subscribeToAuthor:_web_wall_post_subscribe_action_post_subscribe_action__WEBPACK_IMPORTED_MODULE_4__.subscribeToAuthor,showPhoto:function(_,e,t,o,i){return!(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showBox)("al_photos.php",{act:"photo_box",to_id:_,photo:e,hash:t},{cache:1},!!o.href&&i)},domFC:function(_){for(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domFC)(_);_&&_.id.match(/page_wall_count_/);)_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(_);return _},domPS:function(_){for(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPS)(_);_&&_.id.match(/page_wall_count_/);)_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPS)(_);return _},initScrollChecking(_){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)(window,"scroll",Wall.scrollCheck),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)(window,"resize",Wall.scrollCheck),(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_92__.pushNavDestroy)((()=>{(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.removeEvent)(window,"scroll",Wall.scrollCheck),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.removeEvent)(window,"resize",Wall.scrollCheck)})),window.cur.wallAutoMore=_.automore,setTimeout((()=>{Wall.scrollCheck()}),200)},scrollCheck:function(_,e,t){const o=null==e?(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollGetY)():e;let i,s=0;const l=[],a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;if(window.scrollAnimation)return!1;if(Wall.repliesSideUpdate(o),cur.wallPage){let _;if(_="suggested"==cur.wallTab?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_suggested_posts"):"top"==cur.wallTab?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_top_posts"):"donut"===cur.wallTab?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_donut_posts"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_wall_posts"),((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(cur.topRow)!=_||((cur.topRow||{}).id||"").match(/page_wall_count_/))&&(cur.topRow=Wall.domFC(_)),vk.id&&cur.topRow&&!cur.topRow.id.match(/page_wall_count_/)&&!((window.curNotifier||{}).idle_manager||{}).is_idle){const _=[];for(let e=Wall.domPS(cur.topRow);e;e=Wall.domPS(e))cur.topRow.offsetTop>o&&(cur.topRow=e),e.unseen||(e.unseen=!0,_.push(Wall.postsGetRaws(e)));Page.postsUnseen(_);for(let _=cur.topRow;_;_=i){LongView&&LongView.register(_,"Wall");const e=s||_.offsetTop;if(e>=o+a)break;i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(_),((i||{}).id||"").match(/page_wall_count_/)&&(i=null),s=i?i.offsetTop:e+_.offsetHeight,s<o&&i&&(cur.topRow=i);let t=_.bits||0;t>=3||(t|=(e>=o&&e<o+a?1:0)|(s>=o&&s<o+a?2:0))&&(_.bits=t,3==t&&l.push(Wall.postsGetRaws(_)))}LongView&&LongView.onScroll(o,a),Page.postsSeen(l)}}if(!cur.wallAutoMore||cur.wallLoading||cur.viewAsBox)return;const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_more_link");if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(n))return;o+(window.lastWindowHeight||window.innerHeight)+1500>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(n)[1]&&n.onclick()},postsGetRaws:function(_){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.indexOf)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_).children,_);let t;const o={};if(!_)return o;o.module=cur.module,o.index=e;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"_ads_promoted_post"),s=(0,_web_feed_feed_attributes_hider__WEBPACK_IMPORTED_MODULE_78__.getAdAttribute)(_,"ad-view");s&&(o["ad_"+s]=1,i&&(o.module+="_ads_promoted_post"));const l=_.getAttribute("post_view_hash");if(l&&(o.hash=l),"block_"===_.id.substr(0,6)){o[_.id]=1,o.block=_.id.substr(6);let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.attr)(_,"data-contain");e&&(e=e.split(","),e.forEach((function(_){_=_.split(":"),o[_[0]]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(_[1])||1})))}else(t=_.id.match(/^post(-?\d+_\d+)$/))&&(o[t[1]]=1,(t=(_.getAttribute("data-copy")||"").match(/^(-?\d+_\d+)$/))&&(o[t[1]]=-1));return o},votingExtendParams:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"fixed")&&(_.is_fixed=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"preview")&&(_.is_preview=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"board")&&(_.is_board=1),vk.widget&&(_.is_widget=1,_.width=cur.widgetWidth,_.url=cur.url),cur.voteHash&&(_.vote_hash=cur.voteHash);const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"id");t&&(_.voting_id=t);const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"ref");o&&(_.ref=o);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"hash");i&&(_.hash=i);const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"material");return!s||_.is_board||_.is_widget||(_.material=s),_},votingRevote:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("media_voting",_);if(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"id");if(this.votingIsLocked(_))return;const t=this.votingExtendParams({act:"revote"},e);ajax.post("al_voting.php",t,{onDone:this.votingUpdateFull.bind(this,_),showProgress:this.votingLock.bind(this,_),hideProgress:this.votingUnlock.bind(this,_)})}},votingIsLocked:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("_media_voting"+_);let t=!1;return e.forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"media_voting_locked")&&(t=!0)})),t},votingLock:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("_media_voting"+_).forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"disabled")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"queue")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(_,"media_voting_locked")}))},votingUnlock:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("_media_voting"+_).forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(_,"media_voting_locked")}))},votingUpdate:function(_,e){ajax.post("al_voting.php",{act:"get_layout",voting_id:_},{onDone:t=>{(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(e)&&!1===e(t)||(this.votingUpdateFull(_,t),this.votingUnlock(_))},onFail:()=>this.votingUnlock(_),showProgress:()=>this.votingLock(_)})},votingUpdateFull:function(_,e){if(_&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isString)(e)){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("_media_voting"+_);t.length&&(t.forEach((_=>{if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"disabled")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"queue"))if(""===e)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(_);else{const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.cf)(e);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"media_voting_can_vote")){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domFC)(t);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(e,"media_voting_just_voted"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domReplaceEl)(_,t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClassDelayed)(e,"media_voting_just_voted")}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domReplaceEl)(_,t)}})),window.IMBRIDGE&&setTimeout(IMBRIDGE.syncHistory.bind(IMBRIDGE),0),vk.widget&&window.WPoll&&window.WPoll.resizeWidget())}},votingUpdatePartly:function(_,e){if(!_||!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isObject)(e)||this.votingIsLocked(_))return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("_media_voting"+_);if(!t.length)return;const o=e.answers.reduce(((_,e)=>Math.max(_,e.rate)),0),i={};e.answers.forEach((_=>{_.isLeader=_.rate===o,i[_.id]=_})),t.some((t=>{if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"disabled"))return;if(t.classList.contains("media_voting_voted")&&!e.votes)return this.votingUpdate(_),!0;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("media_voting_option_wrap",t).forEach((_=>{const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"id"),o=i[t];if(_.tt&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(_.tt.destroy)&&_.tt.destroy(),!o)return;const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("media_voting_option_bar",_),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("media_voting_option_percent",_),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("media_voting_option_count",_),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("media_voting_option_counter",_),r=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.langNumeric)(o.votes,"%s",!0),d=new Array((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.cf)(r).textContent.split("").length+2).join("0");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domLC)(a),d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domLC)(n),r),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(l,e.votes?o.rate:""),s.style.transform=`scaleX(${.01*o.rate})`,s.style.oTransform=`scaleX(${.01*o.rate})`,o.votes?a.classList.remove("media_voting_option_count_hidden"):(a.classList.add("media_voting_option_count_hidden"),_.classList.remove("media_voting_option_voted")),o.isLeader?_.classList.add("media_voting_option_leader"):_.classList.remove("media_voting_option_leader")}));const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_media_voting_footer_voted_text",t);if(o){let _;_=e.votes?vk.widget?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("voting_x_voted_short",e.votes,!0):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("voting_x_voted",e.votes,!0):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("voting_nobody_voted",e.votes,!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(o,_);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("media_voting_footer_voted_friend",t);i.length>e.votes&&i.forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(_)}))}})),window.IMBRIDGE&&window.IMBRIDGE.syncHistory(),vk.widget&&window.WPoll&&window.WPoll.resizeWidget()},votingUpdateByPostRaw:function(_){if(vk.id){_=_.split("_");const e=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.positive)(_[1]),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(_[0]),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("_post_media_voting"+t+"_"+e);if(o&&o.length){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("media_voting",o[0]);if(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"id");this.votingUpdate(e)}}}},votingVote:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"id");if(!this.votingIsLocked(t)&&vk.id){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"queue"))return this.votingUpdate(t,(_=>{if(_&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isString)(_)){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.cf)(_));if(t&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"queue")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"disabled"))return this.votingVote(t,e,!0),!1}}));if(e.length){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(_),"wk_voting_box"),i=this.votingExtendParams({act:"vote",option_ids:e.join(",")},_);ajax.post("al_voting.php",i,{onDone:(_,e)=>{o?nav.reload():(vk.widget&&window.WPoll&&window.WPoll.updateShareMessage(e),this.votingUpdateFull(t,_))},showProgress:this.votingLock.bind(this,t),hideProgress:()=>{o||this.votingUnlock(t)}})}}else vk.widget&&Widgets.oauth()},votingButtonVote:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("media_voting",_);if(e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(e,"media_voting_multiple")){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("media_voting_option_selected",e),t=[];_.forEach((function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"id");e&&t.push(e)})),this.votingVote(e,t)}},votingOptionVote:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("media_voting",_);if(t){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"media_voting_multiple")){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"id");if(this.votingIsLocked(e)||!vk.id)return void(vk.widget&&Widgets.oauth());(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(_,"media_voting_option_selected");const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("media_voting_option_selected",t).length;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(t,"media_voting_has_selected_options",o)}else{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"id");this.votingVote(t,[e])}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(e)}},votingOptionVoteAttempt:function(_,e,t,o){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("media_voting",_);if(i){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(i,"ref");(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.statlogsValueEvent)("voting_vote_attempt",_,t,o)}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(e)},votingOptionTooltip:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("media_voting",_);if(e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"owner-id"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"id"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"board");(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_11__.showTooltip)(_,{url:"al_voting.php",params:{act:"option_tt",option_id:t,owner_id:o,is_board:s,voting_id:i},slide:15,ajaxdt:100,showdt:400,hidedt:200,dir:"auto",shift:[0,10,10],typeClass:"voting_tt"})}},votingLayer:function(_,e){const t=!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"media_voting_option_wrap")&&_,o=t?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"id"):0,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"media_voting")?_:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("media_voting",_);if(i){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(i,"id"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(i,"owner-id"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(i,"board"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(i,"ref"),a={w:(s?"board_poll":"poll")+t+"_"+_};if(o&&(a.opt_id=o),vk.widget)window.open(location.origin+"/"+a.w,"poll");else{const _={queue:1,noloader:!!(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.curBox)()};"story"===l&&(_.customRef="story"),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_9__.showWiki)(a,!1,void 0,_)}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(e)}},votingExport:function(_,e={}){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("media_voting",_);if(t&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"board")||e.id&&!1===e.isBoard){const _=this.votingExtendParams({act:"export_box",is_board:e.isBoard,voting_id:e.id},t);(vk.widget?window.showBox:_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showBox)("al_voting.php",_,{onDone:function(){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.curBox)().setOptions({width:500,needShadow:!1})}})}},votingOnMain:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("media_voting",_);if(t){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"id");if(this.votingIsLocked(_))return;const o=this.votingExtendParams({act:"onmain",state:e?1:0},t);ajax.post("al_voting.php",o,{onDone:this.votingUpdateFull.bind(this,_),showProgress:this.votingLock.bind(this,_),hideProgress:this.votingUnlock.bind(this,_)})}},votingClosed:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("media_voting",_);if(t){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"id");if(this.votingIsLocked(_))return;const o=this.votingExtendParams({act:"closed",state:e?1:0},t);ajax.post("al_voting.php",o,{onDone:this.votingUpdateFull.bind(this,_),showProgress:this.votingLock.bind(this,_),hideProgress:this.votingUnlock.bind(this,_)})}},votingNarrowAction:function(votingId,hash,action){let act,state;switch(action){case 101:act="closed",state=0;break;case 102:act="closed",state=1;break;case 103:act="onmain",state=0;break;case 104:act="onmain",state=1}act&&!cur.votingNarrowActionProgress&&ajax.post("al_voting.php",{act,voting_id:votingId,is_fixed:1,state,narrow:1,hash},{onDone:function(html,js){let votingModuleEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("group_voting");if(votingModuleEl&&(votingModuleEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(votingModuleEl),html?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domReplaceEl)(votingModuleEl,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.cf)(html)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(votingModuleEl)),js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_24__.logEvalError)(_,js)}},showProgress:function(){cur.votingNarrowActionProgress=!0},hideProgress:function(){cur.votingNarrowActionProgress=!1}})},showReportVotingForm:function(_,e={}){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.actionsMenuItemLocked)(_))return;let t,o,i;const s=void 0!==e.id;if(s)t=e.id,o=e.isBoard;else{if(i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("media_voting",_),null===i&&(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_24__.debugLog)("Unable to show report voting form because there is no .media_voting element"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(i,"id"),this.votingIsLocked(t))return;o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(i,"board")}const l=o?"board_poll":"poll";(0,_web_reports_reports__WEBPACK_IMPORTED_MODULE_45__.showReportForm)(l,0,t,(()=>{if(!s){const _=i.querySelector("._report_voting_button");if(null==_)return void(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_24__.debugLog)("Unable to disable report voting button, because it cannot be found");_.innerHTML=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_report_sent"),_.onclick=null}}))},foTT:function(_,e,t){t&&t.oid&&(e=t.oid==vk.id?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_my_friends_only"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("wpfo"+t.pid)),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_11__.showTitle)(_,e)},update:function(){if(cur.wallLayer)return void WkView.wallUpdateReplies();const _="top"===cur.wallType,e="archive"===cur.wallType,t="donut"===cur.wallType;if("all"!==cur.wallType&&"own"!==cur.wallType&&!_&&!e&&!t||"all"!==cur.wallTab&&"own"!==cur.wallTab&&"top"!==cur.wallTab&&"archive"!==cur.wallTab&&"donut"!==cur.wallTab)return;const o=e?"all":_||t?"own":cur.wallType,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_more_link"),s=Wall.getPostsWrap(cur.wallType),l=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(cur.deletedCnts[o]),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)(o,s).length-l;let n=!1;if((_||e||t)&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("no_posts",s))||_&&cur.wallTopFinished===cur.oid||e&&cur.wallArchiveFinished===cur.oid||t&&(cur.wallDonutFinished===cur.oid||Wall.cantAccessDonutPosts())))n=!0;else{let i;if(i=e?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_archive")):_?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_top")):t?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_donut")):"own"===o?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_own")):(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_all")),"suggested"!==cur.wallTab){let _=i;_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(cur.oid)&&cur.options.fixed_post_id&&(_-=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_posts_count",_?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.langNumeric)(_,cur.options.wall_counts):cur.options.wall_no)}let s=a;!_&&!e&&cur.options.fixed_post_id&&_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(cur.options.wall_oid)&&(s+=1),n=s>=i-l||0===s}n?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(i):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(i),i.onclick=Wall.showMore.pbind(a)),cur.wallTab==cur.wallType&&((0,_web_lib_market__WEBPACK_IMPORTED_MODULE_2__.shortCurrency)(),cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler())},getAbsDate:function(_,e){e=e||window.cur;const t=new Date(_||Date.now());let o,i=t.getHours(),s=t.getMinutes(),l="";return e.wallTpl.time_system&&(l=e.wallTpl.time_system[i>11?1:0],i=i%12||12),o=i>9?i:"0"+i,s=s>9?s:"0"+s,e.wallTpl.date_format.replace("{am_pm}",l).replace("{hour}",i).replace("{num_hour}",o).replace("{minute}",s)},getNowRelTime:function(_){_=_||window.cur;const e=Date.now();return'<span class="rel_date rel_date_needs_update" time="'+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e/1e3-(_.tsDiff||0))+'" abs_time="'+Wall.getAbsDate(e,_)+'">'+_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("profile_status_word_secs_ago",1)+"</span>"},getNewPostHTML:function(_,e,t,o){const i=(o=o||window.cur).wallTpl.post;if(!i)return void console.error(new Error("Missing wall post template"));const s=[],l=_[2],[a]=l.split("_");let n="";const r=_[4].split("|");let d,E=Wall.getNowRelTime(o);const c="1"===_[8];c?n=o.wallTpl.reply_link||"":a!=vk.id&&(n=o.wallTpl.own_reply_link||"");let p=_[3].replace("mem_link","author").replace("memLink","author"),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)(p),P=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.unclean)(u.innerText||u.textContent||""));-1!=_[6].indexOf('id="wpfo')&&(E+=`<span class="page_friends_only inl_bl dvd PostHeaderSubtitleDivider">${_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_post_privacy_friends")}</span>`);const b=(0,_web_Badges_helpers__WEBPACK_IMPORTED_MODULE_64__.updateNewPostHTMLForBadges)(s,o,_);o.wallTpl.custom_del&&(e>(_[9]==a?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER)||a==vk.id||_[9]==vk.id||_[2].split("_")[0]!=_[4])&&s.push(o.wallTpl.custom_del),e>(_[9]==a?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER)||a==vk.id||_[9]==vk.id?s.push(o.wallTpl.del):_[2].split("_")[0]!=_[4]&&s.push(o.wallTpl.spam);const O=e>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR&&_[9]==a||a==vk.id||_[9]==vk.id;O&&"rss"!==_[13]&&s.push(o.wallTpl.edit);let D=_[6];_[15]&&window.vk.pe.obscene_text_filter&&(D=_[15]),a!=vk.id&&_[9]!=vk.id||!D||(_[6]=_[6].replace("vk2017_snippet_show_layer_button","vk2017_snippet_show_layer_button_hidden"));const M=_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(a)&&_[9]==a&&e>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR,w=(0,_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_29__.getReactionsButtonPostTemplate)(_,o);return d={oid:a,name:p,actions:s.length&&o.wallTpl?.post_actions?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(o.wallTpl.post_actions,{actions:s.join("")}):"",replies:"",reply_link:n,own_reply_link:o.wallTpl.own_reply_link,reply_box:c&&o.wallTpl.reply_box?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(o.wallTpl.reply_box,{actions:"",class:M?" reply_fakebox_with_official":""}):"",photo:r[0],link:_[5],text:D,date:E,post_id:_[2],post_class:"",poll_hash:o.wallTpl.poll_hash,date_postfix:"",user_image:"",post_url:"/wall"+l.replace("_wall_reply","_"),can_reply_as_group:M?1:"",owner_photo:M?r[1]||r[0]:"",owner_href:M?_[5]:"",owner_name:M?P:"",online_class:_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserId(a)?" online":"",likes:Likes.makeTemplate(o.wallTpl.post_likes,{buttons_prepend:w?.template,like_class_name:w?.likeClassName,object_raw:_[2]}),class:"",...b},t&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(d,t(d,_)),O&&o.wallTpl.author_data&&(d.date=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(o.wallTpl.author_data,{date:d.date,post_id:l})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(i,d),d)},getNewReplyHTML:function(_,e,t,o){const i=o||window.cur;let s=i.wallTpl.reply,l=[];const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_field"+_[2])||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_fakebox"+_[2])||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("fwr_text");let n="",r="",d="",E=_[10]||"";const c=(0,_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_29__.getReactionsButtonReplyTemplate)(_,i);if(!s)return void console.error(new Error("Missing wall reply template"));if(e>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER||!_[2].indexOf(vk.id+"_")||_[4]==vk.id?l.push(i.wallTpl.del_reply):_[2].split("_")[0]!=_[4]&&l.push(i.wallTpl.spam_reply),(e>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR&&_[4]==(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(_[2])||_[4]==vk.id)&&l.push(i.wallTpl.edit_reply),-1!=_[8].indexOf('class="wall_reply_more"')&&(n+="reply_moreable"),a){n+=" reply_replieable",r=i.wallTpl.reply_link_wrap;wall.getReplyNames()[_[4]]||wall.addReplyName(_[4],[_[11],_[12]])}n&&(d=" onclick=\"Wall.replyClick('%post_id%', %reply_msg_id%, event, %reply_uid%)\""),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(i.wallTpl.reply_actions,{actions:l.join("")});let p=_[8];_[15]&&window.vk.pe.obscene_text_filter&&(p=_[15]);const u=_[5].replace("mem_link","author"),P=_[7],b=_[4]||"false",O={name:u,photo:_[6],reply_image:(0,_shared_components_avatar_renderAvatarToString__WEBPACK_IMPORTED_MODULE_53__.renderAvatarToString)(_[6],_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.REPLY_IMAGE_DEFAULT_SIZE,P,"reply_image",null,_[7],!1,void 0,u,_[_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.EVENT_REPLY_FIELD_IS_NFT_INDEX]),link:P,text:p,classname:n,actions:l,attr:d,date:Wall.getNowRelTime(i),to_link:E,answer_link:r,post_id:_[2],reply_id:_[3],like_id:_[3].replace("_","_wall_reply"),reply_msg_id:_[3].split("_")[1],reply_uid:b,object_full:(0,_web_likes_helpers__WEBPACK_IMPORTED_MODULE_93__.likeReplyObjectId)(_[3]),likes:Likes.makeTemplate(i.wallTpl.reply_likes,{buttons_prepend:c?.template,like_class_name:c?.likeClassName,object_raw:_[2]}),is_author_suffix:_[_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.EVENT_REPLY_FIELD_IS_POST_AUTHOR_INDEX]?i.wallTpl.reply_is_author_suffix:""};return t&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(O,t(O)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(s,O)},updatePostImages:function(_){return _.replace(/<img[^>]+>/g,(function(_){return _.match(/class=/)?_.replace("src=","data-src=").replace('class="','class="__need_img '):_}))},loadPostImages:function(_){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("__need_img",_,"img"),(function(){const _=this.getAttribute("data-src");_&&(this.src=_,this.removeAttribute("data-src")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(this,"__need_img")}))},openNewComments:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+_),t=e.nextSibling;let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("wr_header",e,"a"),i=0,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("reply",e,"div").length,l=s,a=t.newCnt;Wall.loadPostImages(e),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clone)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("new_reply",e,"div")),(function(){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(this,"new_reply"),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.highlightUpdatedReply)(this),i++,100==i)return!1})),o&&(l=i+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(o.getAttribute("offs").split("/")[1])),s+=-a+i,(l>3||s<l)&&(o||e.insertBefore(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("a",{className:"wr_header"}),e.firstChild),Wall.updateRepliesHeader(_,o,s,l)),cur.wallMyOpened[_]=1,t&&"replies_open"==t.className&&(a>100?(t.innerHTML=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("news_x_new_replies_more",Math.min(100,a-i)),t.newCnt-=i):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(t)),Wall.repliesSideSetup(_)},langWordNumeric:function(_,e,t){return(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.langWordNumeric)(_,e,t)},updateTimes:function(_){let e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(Date.now()/1e3);const t=[];e-=cur.tsDiff,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("rel_date_needs_update",_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_wall_posts"),"span"),(function(_,o){if(!o)return;const i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(o.getAttribute("time")),s=e-i;let l=(0,_web_lib_date__WEBPACK_IMPORTED_MODULE_40__.getFormattedDiffTimeText)(s,"",(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("feed_redesign_header_2023_enabled")&&o.closest(".PostHeader--redesignV3"));l||(l=o.getAttribute("abs_time"),t.push(o)),o.innerHTML=l})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(t,(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(this,"rel_date_needs_update")}))},updateRepliesHeader:function(_,e,t,o){if(cur.onepost)return;let i,s,l=e.href,a=3,n=0;if(!l&&(s=_.match(/^(-?\d+)_(photo|video|note|topic|video|)(\d+)$/))){const _=s[2]||"wall";switch(l="/"+_+s[1]+"_"+s[3],_){case"topic":l+="?offset=last&scroll=1";break;case"wall":l+="?offset=last&f=replies"}e.href=l}o>t?t<100?(i=o>100?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_show_n_last_replies",100):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_show_all_n_replies",o),a=!1):i=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_hide_replies"):(i=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_hide_replies"),n=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(e,"wrh_all",n),e.innerHTML=i,e.onclick=Wall.showReplies.pbind(_,a,!1),e.setAttribute("offs",t+"/"+o)},processQueueEvent(_){if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isObject)(_)&&_.entity_type&&"voting"===_.entity_type)this.votingUpdatePartly(_.data.id,_.data)},updated:function(_,e,t){const o=_?window.wkcur:window.cur;if(!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(o.wallQueues)||!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(t.events)||!t.events.length)return;const i=o.wallQueues.filter((_=>_.key===e)).pop();if(!i)return;if(t.failed)return void(o.wallQueues=!1);i.ts=t.ts;const s=_?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollGetY)();let l=s;const a=!(o.wallType||"").indexOf("full"),n=o.onepost,r=!!_,d=_;a&&(nav.objLoc.q||nav.objLoc.search||nav.objLoc.day)||((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(t.events,(function(){if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isObject)(this))return Wall.processQueueEvent(this);const e=this.split("<!>"),t=e[0];let i=e[1];const s=e[2];let E=0,c=0,p=_&&window.cur.wallLayer==s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wl_post");if(p&&"del_reply"!=i||(p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isAncestor)(p,_?wkLayerWrap:pageNode)||(p=null)),t==o.options.qversion){switch((Wall.isArchiveWall()?"archive_post"===i:"reveal_post"===i)&&(i="res_post"),(Wall.isArchiveWall()?"reveal_post"===i:"archive_post"===i)&&(i="del_post"),i){case"new_post":{if(p)break;if(a&&o.pgStart>0){o.pgOffset++;break}if(o.oid==vk.id&&vk.id==e[9]&&window.curNotifier&&curNotifier.idle_manager.is_idle&&Wall.clearInput(),"own"!==o.wallType&&"all"!==o.wallType&&!Wall.hasPosts("own"))break;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_wall_posts");let t=_.lastChild;const i=!!a&&FullWall.addTetaTet,l=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e[e.length-1]),n=void 0!==o.options.is_admin?o.options.is_admin:_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(o.options.wall_oid)?8&l?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.EDITOR:2&l?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER,r=Wall.getNewPostHTML(e,n,i,o);if(!r)break;const u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)(r);let P=_.firstChild;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+s))break;for(t&&t!=u?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(t):t=!1,a?t||o.pgOffset++:((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_all",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_all"))+1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(u,"all"),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e[10])&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_own",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_own"))+1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(u,"own"))),0==e[8]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(u,"closed_comments"),o.deepRepliesActive&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(u,"deep_active");P&&("INPUT"==P.tagName||1!=P.nodeType||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(P,"post_fixed"));)P=P.nextSibling;_.insertBefore(u,P),Wall.votingUpdateByPostRaw(s),(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_43__.updateNarrativeSnippetsFromQueueByPost)(u),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_44__.updateArticleSnippetsFromQueueByPost)(u),E=u.offsetHeight+15,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(u,d)[1],(0,_web_wall_post_update_view_utils__WEBPACK_IMPORTED_MODULE_5__.highlightUpdatedPost)(u),(0,_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_23__.updateAriaElements)(),Wall.updateMentionsIndex(),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_0__.AudioUtils.updateQueueReceivedPost(u);break}case"edit_post":{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wpt"+s);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(p)||!_)break;let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("wall_post_more",_);t&&(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(t))),E=-_.offsetHeight,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(_,d)[1];let i=e[3];e[6]&&window.vk.pe.obscene_text_filter&&(i=e[6]);let l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(i,{poll_hash:o.wallTpl.poll_hash});const a=o.videoInlinePlayer&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isAncestor)(window._videoLastInlined[0],_),n=a&&"playing"==o.videoInlinePlayer.getState();if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(_,l),a){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("page_post_sized_thumbs",_);1==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domChildren)(e).length&&(e.innerHTML="",e.appendChild(window._videoLastInlined[1]),e.appendChild(window._videoLastInlined[0]),n&&setTimeout((function(){o.videoInlinePlayer.play()}),0))}t&&(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("wall_post_more",_),t&&t.onclick()),Wall.votingUpdateByPostRaw(s),(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_43__.updateNarrativeSnippetsFromQueueByPost)(_),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_44__.updateArticleSnippetsFromQueueByPost)(_),E+=_.offsetHeight,(0,_web_wall_post_update_view_utils__WEBPACK_IMPORTED_MODULE_5__.highlightUpdatedPostContent)(_),Wall.updatePostAuthorData(s);break}case"edit_reply":{const _=e[3],t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wpt"+_);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)("post"+_)||!t)break;let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("wall_reply_more",t);o&&(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domNS)(o)));let i=e[4];e[5]&&window.vk.pe.obscene_text_filter&&(i=e[5]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(t,i),E=-t.offsetHeight,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(t,d)[1],o&&(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("wall_reply_more",t),o&&o.onclick()),E+=t.offsetHeight,(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_43__.updateNarrativeSnippetsFromQueueByPost)(t),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_44__.updateArticleSnippetsFromQueueByPost)(t),(0,_web_stickers_utils__WEBPACK_IMPORTED_MODULE_49__.updateStickersFromQueue)(t),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.highlightUpdatedReplyContent)(t);break}case"post_parsed_link":{if(!p)break;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("wall_postlink_preview_btn_disabled",p);if(!_)break;const t=e[3];if("1"===t)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(_,"wall_postlink_preview_btn_disabled"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(_,"button_disabled");else if("0"===t)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(_);else if(t){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("a",{href:t,className:"flat_button",innerHTML:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_preview_link")});(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domReplaceEl)(_,e)}break}case"del_post":p&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(p)&&!o.wallMyDeleted[s]&&!n&&(E-=p.offsetHeight+15,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(p,d)[1],(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_20__.revertLastInlineVideo)(p),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(p,"unshown"),a||r||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_all",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_all"))-1),e[3]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_own",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_own"))-1),Wall.isArchiveWall()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_archive",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_archive"))-1)));break;case"res_post":p&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(p)&&((o.wallRnd==e[4]||Wall.isArchiveWall())&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(p,"unshown"),a?o.pgOffset++:((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_all",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_all"))+1),e[3]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_own",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_own"))+1),Wall.isArchiveWall()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_archive",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("page_wall_count_archive"))+1)));break;case"new_reply":{if(!p||o.wallMyReplied[s]||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+e[3])||n&&o.pgOffset<o.pgCount||r&&(o.reverse?o.offset:o.offset+o.loaded<o.count))break;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(r?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+s),"deep_active")){const _=wall.addNewReply(e);E+=_[0],c=_[1];break}const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+s),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_wrap"+s),l=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e[e.length-1]),a=void 0!==o.options.is_admin?o.options.is_admin:_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(o.options.wall_oid)?8&l?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.EDITOR:2&l?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER,u=Wall.getNewReplyHTML(e,a,!1,o);if(!u)break;const P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)(u),b=r?t.offsetHeight:p.offsetHeight;let O,D=!1;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(t)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(i)&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)("reply_link"+s)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domClosest)("wall_fixed",i)){O=t.nextSibling;let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("new_reply",t,"div").length+1;if(r||n||o.wallMyOpened[s]){if(!n){O&&"replies_open"==O.className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(O),D=!0;let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("wr_header",t,"a");const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("reply",t,"div").length+1;let o=e;_&&(o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(_.getAttribute("offs").split("/")[1])+1),(o>5||e<o)&&(_||t.insertBefore(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("a",{className:"wr_header"}),t.firstChild),Wall.updateRepliesHeader(s,_,e,o))}}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(P,"new_reply"),O&&"replies_open"==O.className||(O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(s),role:"button",tabIndex:0}),t.parentNode.insertBefore(O,t.nextSibling)),O.innerHTML=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_x_new_replies_more",Math.min(100,_)),O.newCnt=_}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)("reply_link"+s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(i,t),D=!0;_&&o.reverse&&t.firstChild?t.insertBefore(P,t.firstChild):t.appendChild(P),D&&(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.highlightUpdatedReply)(P),r?(o.count++,o.loaded++,WkView.wallUpdateReplies(),E=t.offsetHeight-b,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(P,d)[1]):(n&&(FullWall.repliesSummary(e[13]),o.pgOffset++,o.pgCount++,FullWall.repliesSummary(o.pgCount),Pagination.pageReady(!1),FullWall.onePostOnScroll(!1,!1,!0)),E=p.offsetHeight-b,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(D?P:O)[1],Wall.repliesSideSetup(s)),(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_43__.updateNarrativeSnippetsFromQueueByPost)(P),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_44__.updateArticleSnippetsFromQueueByPost)(P),(0,_web_stickers_utils__WEBPACK_IMPORTED_MODULE_49__.updateStickersFromQueue)(P),Wall.updateMentionsIndex(),Likes.update("wall"+s,{comment_num:e[13]});break}case"del_reply":{if(o.wallMyDeleted[s]||!p)break;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",p)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",p);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"deep_active")){const _=wall.removeDeepReply(e);E+=_[0],c=_[1];break}if(E-=p.offsetHeight,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(p,d)[1],(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_20__.revertLastInlineVideo)(p),o.layerpost)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(p),o.count--,o.loaded--;else{n&&(o.pgOffset--,o.pgCount--,FullWall.repliesSummary(o.pgCount));const _=p.parentNode.id.match(/replies(-?\d+_\d+)/);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(p),_&&Wall.repliesSideSetup(_[1])}break}case"view_post":Wall.likeUpdate(!1,s,0,Wall.formatCount((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e[3])),void 0,void 0,1);break;case"like_post":case"like_reply":{if(!p)break;const _="like_reply"==i?"wall_reply"+s:s,t=p&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(p,"_like_wrap"),o=p&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(p,"_share_wrap"),l=(0,_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_29__.likeDataReactionsFields)(e);wall.likeFullUpdate(t,_,{isQueueUpdate:!0,like_my:t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"my_like"),like_num:e[3],like_title:!1,share_my:o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(o,"my_share"),share_num:e[4],share_title:!1,...l});break}case"upd_ci":{let _=e[2],t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("current_info"),i=t||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_current_info");const s=(0,_web_profile_profile_utils__WEBPACK_IMPORTED_MODULE_52__.isVKCOMProfileRedesignedEnabled)()&&"profile"===window.cur.module;if(!i&&!s)break;switch(e[3]){case"audio":{if(s){let t;return e[4]&&"string"==typeof e[4]&&(t=e[4].split(",")?.[1]),void window.Profile?.updateBroadcastAudioStatus(_,t)}const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("current_audio_cnt_wrap");l&&l.tt&&l.tt.hide();const a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e[5]||""),n=a?"":" hidden";let r="";t||(r+=" onmouseover=\"showTooltip(this, {forcetoup: true, text: '"+o.options.ciAudioTip+"', black: 1, shift: [14, 5, 5]})\" onclick=\"Page.playCurrent(this, '"+e[4]+"')\""),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(o.options.ciAudioTpl,{text:_,attrs:r,count:a,cnt_class:n}),wall.updateOwnerStatus(_,i,e,t);break}case"app":{const s=e[6]?"[12, 5, 5]":"[15, 5, 5]",l=e[6]?" current_app_icon":"";let a=t?' onclick="cur.ciApp = '+e[4]+'"':" onmouseover=\"showTooltip(this, {forcetoup: true, text: '"+o.options.ciAppTip+"', black: 1, shift: "+s+'})" href="'+e[5]+'?ref=14" onclick="return showApp(event, '+e[4]+', 1, 14, cur.oid)"';e[6]&&(a+=" style=\"background-image: url('"+e[6]+"'); background-size: 16px 16px;\""),_='<a class="current_app'+l+'"'+a+">"+_+"</a>",wall.updateOwnerStatus(_,i,e,t);break}default:if(s)return void window.Profile?.resetActiveBroadcastAudioStatus();window.stManager.add([window.jsc("web/emoji.js")],(function(){_=_?'<span class="current_text">'+Emoji.emojiToHTML(_,!0)+"</span>":_,wall.updateOwnerStatus(_,i,e,t)}))}break}case"upd_ci_cnt":{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("current_info"),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(e[2]),o=_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_current_info"),i=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("current_audio_cnt_wrap",o);i&&(i.tt&&i.tt.destroy(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(i,"hidden",0==t),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_19__.animateCount)(document.querySelector(".current_audio_cnt"),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.langNumeric)(t,"%s",!0),{str:"auto"}));break}case"cover_updated":{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_page_cover");if(_&&e[2]){const t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.vkImage)(),o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.isRetina)()?e[3]:e[2];t.src=o,t.onload=function(){_.style.backgroundImage="url('"+o+"')",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(t)}}break}}E&&(_?c<0:l+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)("page_header_cont")[1]>c)&&(l+=E)}})),l!=s&&s>100&&!o.onepost&&(_?wkLayerWrap.scrollTop=l:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollToY)(l,0,!1,!0)),Wall.update())},updateOwnerStatus:function(_,e,t,o){if(o){_='<span class="'+(_?"my_current_info":"no_current_info")+'">'+(_||_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("change_current_info"))+"</span>",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(e.parentNode.nextSibling,_),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)("currinfo_editor")&&_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserId(cur.oid)&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggle)("currinfo_audio","app"!=t[3]),t[2]&&"app"!=t[3]&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.checkbox)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("currinfo_audio"),Boolean(t[2])),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggle)("currinfo_app","app"==t[3]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)("currinfo_app","on"))}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(e,_)},updateMentionsIndex:function(_){if(clearTimeout(cur.wallUpdateMentionsIndexTO),!_)return void(cur.wallUpdateMentionsIndexTO=setTimeout(wall.updateMentionsIndex.pbind(!0),300));const e={},t=[],o=new RegExp(`^(https?://(${_shared_lib_site__WEBPACK_IMPORTED_MODULE_3__.VK_HOST_REGEX_GROUP_UNSAFE.source}|${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.escapeRE)(location.host)}))?/?`);let i=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("author",document.body,"a"),(function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(this),i=this.href.replace(o,"");if(void 0!==e[i])return;const s=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(this.getAttribute("data-from-id"));s&&s!=vk.id&&(e[i]=t.length,t.push([s,_,"@"+i,"/images/camera_c.gif"]))})),i=i.concat(Array.from(document.querySelectorAll("a.post_image, a._post_image")),Array.from(document.querySelectorAll("a.reply_image, a._reply_image"))),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(i,(function(){const _=this.href.replace(o,""),i=e[_];if(void 0===i)return;const s=(0,_web_wall_wall_post_elem_utils__WEBPACK_IMPORTED_MODULE_94__.replyUserImageImg)(this);s&&(t[i][3]=s.getAttribute("src"),delete e[_])})),cur.wallMentions=t},initUpdates:function(_,e=!1){if(_&&_.length&&window.Notifier){const t=e?window.wkcur:window.cur,o=()=>{t.wallQueues&&t.wallQueues.forEach((_=>{Notifier.addKey(_,((_,t)=>{Wall.updated(e,_,t)}))}))};if(!t.wallQueues){const _=setInterval(o,1e4);e?t._hide.push((()=>clearInterval(_))):t.destroy.push((()=>clearInterval(_)))}t.wallQueues=_,o()}},initWallOptions:function(_){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(cur,{wallCheckComments:_.check_comments,wallType:_.wall_type,wallTpl:_.wall_tpl,wallMyDeleted:{},isGridOnly:_.posting_is_grid_only,isCarouselOnly:_.posting_is_carousel_only,tsDiff:_.wall_tpl&&_.wall_tpl.abs_timestamp?900*Math.round((Date.now()/1e3-_.wall_tpl.abs_timestamp)/900):0,wallMyOpened:{},wallMyReplied:{},wallMentions:[],wallMyRepliesCnt:0,wallUploadOpts:_.upload,wallUploadVideoOpts:_.upload_video,hasGroupAudioAccess:_.hasGroupAudioAccess}),_.wall_tpl&&_.wall_tpl.lang&&(cur.lang=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(cur.lang||{},_.wall_tpl.lang)),window.Notifier&&Notifier.addRecvClbk("wall_reply_multiline","wall",(function(_){Wall.onReplySubmitChanged(_.value,1)}),!0)},onPostLoaded:function(_,e){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)(_),Wall.onAdBlockLoaded(_,e),e&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"_post")&&(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_post",_)),_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"_post")&&cur.onPostLoaded&&cur.onPostLoaded(_)},onAdBlockLoaded:function(_,e){const t="._ads_block_data_w",o=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("post_adblock_protection_promo")?_?.closest?.(_web_smoke_guard_smoke_screen_locator__WEBPACK_IMPORTED_MODULE_87__.Locator.getInstance().lookup(t)):_?.closest?.(t);o&&((0,_shared_pixels__WEBPACK_IMPORTED_MODULE_79__.logPixelEvent)(o,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_82__.PixelNames.render),(0,_shared_pixels__WEBPACK_IMPORTED_MODULE_79__.logPixelEvent)(o,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_82__.PixelNames.viewability_measurable),Wall.triggerAdStat(o,"load"))},init:function(_){Wall.initEmoji(),Wall.initWallOptions(_),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(cur,{wallInited:!0,postField:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_field"),sendPostBtn:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("send_post"),wallSearch:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wall_search"),wallPage:document.getElementById("profile_redesigned")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("profile")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("group")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("public"),wallPageNarrow:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("narrow_column"),wallUploadOpts:_.upload||!1,wallOnClearInput:[],deletedCnts:{own:0,all:0,archive:0},posterFeatureTooltip:_.poster_feature_tooltip,posterFeatureTooltipHash:_.poster_feature_tooltip_hash,postCopyrightFeatureTooltip:_.post_copyright_feature_tooltip,postCopyrightFeatureTooltipHash:_.post_copyright_feature_tooltip_hash,isUrlsRecognitionDisabled:_.is_urls_recognition_disabled});let e=null;(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.isPostponedPostsFixEnabled)()&&(Wall.postponedPosts=_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_65__.PostponedPosts.new(),e=Wall.initPostponedSort()),cur.destroy.push((function(_){(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.serviceWallUsers),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.serviceWallGroups),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.serviceNews),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.cleanElems)(_.postField),Wall.postponedPosts?.cleanUpOnNavigation(),uiTabs.hideSort(),e&&e()}));const t=_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.removeEvent.pbind(document,"click",Wall.hideEditPostReply);cur._back?(cur._back.hide.push(t),cur._back.show.push(t),cur._back.show.push(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent.pbind(document,"click",Wall.hideEditPostReply))):cur.destroy.push(t),cur.wallTab=cur.wallType,Wall.update(),Wall.initUpdates(_.add_queues),_.wall_tpl&&(cur.timeUpdateInt=setInterval((function(){Wall.updateTimes(_.wallCont)}),1e4),(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_92__.pushNavDestroy)((()=>{clearInterval(cur.timeUpdateInt)}))),Wall.initScrollChecking(_);let o,i,s=!1;if(cur.options?.no_draft||(s=_.draft||cur.oid!=vk.id&&Wall.getOwnerDraft(cur.oid)),Wall.initPostEditable(s),cur.wallSearch&&(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_25__.placeholderInit)(cur.wallSearch),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.removeEvent)(document,"click",Wall.hideEditPostReply),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)(document,"click",Wall.hideEditPostReply),_.poster_options&&Wall.initPosterEditor(_.poster_options),cur.options.max_post_full_length&&Wall.initPostWarningField(),_.media_types){let l=4;_.media_types.find((_=>"article"===_?.[0]))&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("inline_attaches_icons")&&l++;const a=(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_6__.debounce)((_=>{(cur.isCarouselOnly&&_.getIsCarouselAllowed()||!_.getIsGridAllowed())&&cur.wallAddMedia.getAttachView()===_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_62__.ATTACHMENT_PRIMARY_MODE.grid&&(cur.wallAddMedia.setAttachView(_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_62__.ATTACHMENT_PRIMARY_MODE.carousel),_.setAttachViewControlValue(_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_62__.ATTACHMENT_PRIMARY_MODE.carousel))}),0),n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({onAddMediaChange:(_,e,t)=>{if(cur.postCopyrightFeatureTT&&cur.postCopyrightFeatureTT.hide(),Wall.hidePosterFeatureTooltip(),Wall.postChanged(10,_),["poll","postpone",_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_PRODUCT,_web_donut__WEBPACK_IMPORTED_MODULE_27__.MEDIA_TYPE_DONUT_DURATION].includes(_)||wall.focusOnEnd(),cur.oid!=vk.id&&Wall.saveOwnerDraftMedia(cur.oid,_,e,t),["postpone","video"].includes(_)){const o=cur.wallAddMedia?.getMedias?.()||[],i=Number(cur.wallAddMedia?.postponeDate);if("postpone"===_){(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_48__.showPostponePostWithVideoInfo)("media_info",e,o);const _=document.querySelector(".addpost_button");_&&_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.setLabel(_,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("profile_wall_postpone_btn"))}else(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_48__.showPostponePostWithVideoInfo)("media_info",i,[...o,[_,e,t]])}setTimeout(Wall.checkPosterAvailability)},onChangedSize:()=>{setTimeout((()=>{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("submit_post_box"),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("VideoRestriction",_);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(e,((_,e)=>{const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(e)[1],o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(e)[0];(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(e,"VideoRestriction--onlyIcon",o<200),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(e,"VideoRestriction--small",o>=200&&o<300&&o>t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(e,"VideoRestriction--medium",o>=300&&o<400)}))}))},onMediaChange:(..._)=>{const e=Number(_.slice(-1));if(e){const _=cur.wallAddMedia?.getMedias?.()||[];(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_48__.showPostponePostWithVideoInfo)("media_info",e,_)}Wall.postChanged()},onMediaAdd:()=>{a(n),cur.wallAddMedia.checkAttachViewFromOnePhoto?.(),i&&cur.wallAddMedia.checkNeedShowCarouselRatioHint?.(i.showHintTooltip)},onMediaRemove:_=>{const e=_.removedTypes?.includes("postpone"),t=_.removedTypes?.includes("video");if(e||t){const _=cur.wallAddMedia?.getMedias?.()||[],t=e?null:Number(cur.wallAddMedia?.postponeDate);(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_48__.showPostponePostWithVideoInfo)("media_info",t,_)}},onMediaUploadStarted:()=>{Wall.postChanged()},onIndexChanged:(_,e)=>{window.cur.addPostData=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_59__.moveThumbsInData)(_,e,window.cur.addPostData)},onDelete:_=>{window.cur.addPostData=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_59__.deleteThumbInData)(_,window.cur.addPostData)},onDataDelete:({type:_,id:e,isReset:t})=>{const o=n.getIsCarouselAllowed();window.cur.addPostData=window.cur.addPostData?.filter((([t,o])=>!(_===t&&e===o))),t||!o||cur.wallAddMedia.getAttachView()!==_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_62__.ATTACHMENT_PRIMARY_MODE.carousel||n.getIsCarouselAllowed()||(cur.wallAddMedia.setAttachView(_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_62__.ATTACHMENT_PRIMARY_MODE.grid),n.setAttachViewControlValue(_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_62__.ATTACHMENT_PRIMARY_MODE.grid)),t||a(n),cur.wallAddMedia.checkAttachViewForOnePhoto?.()},editable:1,from:"ads"===cur.module?"ads":"post",sortable:1,poster:cur.poster,maxShown:l,hideAfterCount:5,initialAttachView:(0,_web_attachments_view_selector_utils__WEBPACK_IMPORTED_MODULE_58__.getAttachmentsPrimaryModeDefaultValue)(cur)},_.media_opts||{});n.getIsCarouselAllowed=({skipClipsCheck:_=!1}={})=>!cur.isGridOnly&&(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__.isCarouselAllowed)(window.cur.addPostData,{skipClipsCheck:_}),n.getIsGridAllowed=()=>(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__.isGridAllowed)(window.cur.addPostData,cur.isCarouselOnly),n.setAttachViewControlValue=_=>{o?.setOption(_)},n.isFirstRatioNotEquelAllRatioThumbs=()=>(0,_web_posting_carousel_components_utils__WEBPACK_IMPORTED_MODULE_81__.isFirstRatioNotEquelAllRatioThumbs)((0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_59__.getThumbsMediaItems)(window.cur.addPostData)),n.savePreviousRatioCropsAndGetCropsForNewRatio=(_,e,t)=>{const o=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_59__.getThumbsMediaItems)(window.cur.addPostData),i={};o.forEach((_=>{if(!_||!_[2])return;const o=_[2];o&&(i[_[1]]=o.crop_data,t[e]&&t[e][_[1]]?o.crop_data=t[e][_[1]]:delete o.crop_data)})),_&&(t[_]=i)},"supp"!==cur.wallType&&(n.getThumbsCount=()=>(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__.getThumbsCount)(window.cur.addPostData),n.isNotExistDraftThumbs=Array.isArray(s?.[1])?0===(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__.getThumbsCount)(s?.[1]):void 0),cur.wallAddMedia=new window.MediaSelector((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_add_media"),"media_preview",_.media_types,n);const{wallAddMedia:r}=cur;if(cur.wallAddMedia.menu){r.emitter.on(r.eventTypes.choosenMedia,(_=>{switch(_?.[0]){case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_PHOTO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.ATTACH_PHOTO);break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_ALBUM:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.ATTACH_ALBUM);break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_VIDEO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.ATTACH_VIDEO);break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_AUDIO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.ATTACH_MUSIC)}window.cur.addPostData=window.cur.addPostData??[],window.cur.addPostData=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_59__.addThumbsInData)(_,window.cur.addPostData)})),r.emitter.on(r.eventTypes.mediaItemClick,(_=>{switch(_?.type){case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_PHOTO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.OPEN_MY_PHOTO);break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_VIDEO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.OPEN_MY_VIDEO);break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_DOC:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.ADD_FILE);break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_POLL:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.ADD_SURVEY);break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_MAP:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.ADD_MAP);break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_ARTICLE:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.ADD_ARTICLE);break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_SHORT_VIDEO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.ADD_CLIP);break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_MARKET:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.ADD_PRODUCT);break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_AUDIO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.OPEN_MUSIC)}})),r.emitter.on(r.eventTypes.closePickerModal,(_=>{switch(_?.type){case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_PHOTO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.CLOSE_ADD_PHOTO);break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_30__.MEDIA_SELECTOR_VIDEO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.CLOSE_ADD_VIDEO)}}));let d=()=>{},E=()=>{};r.emitter.on(r.eventTypes.viewChanged,(()=>{d(),Wall.drawMedia({skipPoll:!0,skipPostpone:!0})})),r.emitter.on(r.eventTypes.thumbUpdated,Wall.onThumbUpdate),E=(0,_web_posting_carousel_components_utils__WEBPACK_IMPORTED_MODULE_81__.isCarouselCropEnabled)()?_=>{d=renderReactCarousel({thumbs:(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_59__.getThumbsMediaItems)(window.cur.addPostData),onDelete:_=>{const[e,t]=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_59__.getThumbByIndex)(_,window.cur.addPostData)??[];e&&t&&r.unchooseMediaByTypeAndId(e,t)},ratio:r.getCarouselRatio(),changeRatio:(_,e)=>{r.setCarouselRatio(_,e),i?.setOption(_)}},_),r.emitViewDraw()}:(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_6__.debounce)((async _=>{d();const{renderCarouselPromise:e,abort:t}=(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__.renderCarousel)({attachments:(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__.mediaDataToAttachments)(window.cur.addPostData),oid:window.cur.oid,photoClickHandlers:(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__.mediaDataToClickHandlers)(window.cur.addPostData),onDelete:_=>{const[e,t]=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_59__.getThumbByIndex)(_,window.cur.addPostData)??[];e&&t&&r.unchooseMediaByTypeAndId(e,t)}},_);d=t,await e,r.emitViewDraw()}),0),r.emitter.on(r.eventTypes.carouselRedrawNeeded,(_=>{E(_)})),window.cur.destroy.push((()=>{d()}));const c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(cur.wallAddMedia.menu.menuNode,"_type_podcast"),p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("official");c&&p&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domClosest)("_submit_post_box",p),"from-oid")!=cur.postTo&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(c)}}if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("attachments_primary_mode_web_feature")){const u=cur.wallAddMedia&&cur.wallAddMedia.id||"";o=(0,_web_attachments_view_selector_init_view_ui_selector__WEBPACK_IMPORTED_MODULE_57__.initAttachmentsViewSelector)({linkId:String(u),postActionsEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_actions_btns"),addMedia:cur.wallAddMedia,isCarouselOnly:cur.isCarouselOnly,isGridOnly:cur.isGridOnly}),o&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.push(o.onClear)}if((0,_web_posting_carousel_components_utils__WEBPACK_IMPORTED_MODULE_81__.isCarouselCropEnabled)()){const P=cur.wallAddMedia&&cur.wallAddMedia.id||"";i=(0,_web_posting_carousel_components_CarouselRatioSelector_initCarouselRatioSelector__WEBPACK_IMPORTED_MODULE_80__.initCarouselRatioSelector)({linkId:String(P),postActionsEl:document.getElementById("post_actions_btns"),addMedia:cur.wallAddMedia}),i&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.push(i.onClear)}if(Wall.initPostVisibilitySelector(cur.wallAddMedia),(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_31__.isPostTopicSettingEnabled)(window.cur)){const b=cur.wallAddMedia&&cur.wallAddMedia.id||"",O=(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_31__.initPostTopicCreatingSelector)(String(b),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_actions_btns"),(_=>-1!==_));O&&(window.cur.destroy.push(O.onDestroy),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.push(O.clearSelection))}if(cur.withUpload=window.WallUpload&&!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.inArray)(cur.wallType,["all","own","feed","full_all","ads_promoted_stealth"])&&Wall.withMentions&&cur.wallUploadOpts,cur.withUpload&&WallUpload.checkDragDrop()){let D=!1,M=!1;const w=function(_){if(!1!==D&&(clearTimeout(D),D=!1),cur.uploadInited)return m(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(_);switch(_.type){case"drop":M=!1,delete cur.wallUploadFromDrag,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("post_upload_dropbox");break;case"dragleave":D=setTimeout((function(){M=!1,delete cur.wallUploadFromDrag,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("post_upload_dropbox")}),100);break;case"dragover":case"dragenter":M||(M=!_.target||"IMG"!=_.target.tagName&&"A"!=_.target.tagName?2:1,2==M&&setTimeout(WallUpload.initCallback,0)),2==M&&(cur.wallUploadFromDrag=1)}return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(_)};function m(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.removeEvent)(document,"dragover dragenter drop dragleave",w)}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)(document,"dragover dragenter drop dragleave",w),cur.destroy.push(m)}if(Wall.updateMentionsIndex(),(0,_web_wall_wall_post_render__WEBPACK_IMPORTED_MODULE_37__.wallPostRenderInit)(),nav.objLoc.new_post){Wall.showEditPost();const C=nav.objLoc.post_privacy;"friends_only"===C?Wall.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.VISIBILITY_ACCESS_OPTIONS.ONLY_FRIENDS,"",!0):"best_friends_only"===C&&Wall.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("best_friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_28__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS,"",!0),delete nav.objLoc.new_post,delete nav.objLoc.post_privacy,nav.setLoc(nav.objLoc)}},initPosterEditor:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)('<div class="page_block"></div>'),t=Wall.getMainPostBlock();"feed"===cur.module&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(e,"feed_post_field_wrap");const o=function(){return!1},i=function(){Wall.closeFancyTooltipsInPost(),Wall.openPosterEditor(),cur.poster.sendStatsInfo("open")},s={onPreOpen:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertAfter)(e,t)},onPostOpen:function(){const _=cur.poster.getTextInputEl();Wall.restoreCaretPositionForPoster(_)},onPreHide:function(){Wall.saveCaretPositionForPoster(cur.poster.getTextInputEl()),Wall.closeFancyTooltipsInPost();const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("submit_post_error"),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("submit_post_box"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_actions_btns"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("submit_post");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertBefore)(t,o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(_)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertAfter)(_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domFC)(e))},onPostHide:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_settings_btn"),o=cur.options.suggesting&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("check_sign");_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertBefore)(_,cur.openPosterBtn),o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertBefore)(o,cur.openPosterBtn),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(t);let i=cur.poster.getTextAsHtml();i&&i.match(Emoji.emojiRegex)&&(i=i.replace(Emoji.emojiRegex,Emoji.emojiReplace)),cur.postField.innerHTML=i,Wall.restoreCaretPositionForPoster(cur.postField),setTimeout((function(){Composer.updateArticleConvertSuggest((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(cur.postField,"composer"))})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(e)},onPreUploaderOpen:function(){const _=cur.poster.getTextInputEl();Wall.saveCaretPositionForPoster(_)},onPostUploaderClose:function(){const _=cur.poster.getTextInputEl();Wall.restoreCaretPositionForPoster(_)},onOverTextLimit:function(){Wall.disablePoster(!0),cur.poster.closeEditor(),cur.poster.sendStatsInfo("auto_disable"),cur.poster.state.toggled=!0},onChangeData:Wall.postChanged,onSend:function(_){Wall.sendPost({skipLocked:!0,posterSendParams:_})},onDestroy:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(e)},getPostOwnerId:function(){return+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("submit_post_box"),"from-oid")},width:Wall.getMainPostBlock().clientWidth,containerClasses:"poster_wall-creating",placeholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.attr)(cur.postField,"placeholder"),appendToElem:e};cur.openPosterBtn=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_poster_btn"),cur.poster=new Poster(_.poster_config,s),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)(cur.openPosterBtn,"click",i),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)(cur.openPosterBtn,"mousedown",o),(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_92__.pushNavDestroy)((()=>{(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.removeEvent)(cur.openPosterBtn,"click",i),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.removeEvent)(cur.openPosterBtn,"mousedown",o)}))},openPosterEditor:function(_){if(cur.viewAsBox)return cur.viewAsBox();if(!cur.poster||cur.poster.state.disabled||cur.poster.state.opened)return;_=_||{},cur.posterFeatureTT&&cur.posterFeatureTT.hide();const e=Wall.getMainPostBlock(),t=_.bkgId,o=window.browser.windows7||window.browser.windowsVista||window.browser.windowsXp;Wall.saveCaretPositionForPoster(cur.postField);let i=_.text||cur.postField.innerHTML;if(i=i.replace(/\n/g,"<br/>"),i=i.replace(/<img[^>]*>/g,(function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{innerHTML:_}).firstChild,t=Emoji.getCode(e);return t?o?" ":Emoji.codeToChr(t):_})),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(e))return cur.poster.setBkg(t,!0),void cur.poster.setText(i);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(e);const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_settings_btn"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("submit_post_error"),a=cur.options.suggesting&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("check_sign"),n=cur.poster.getPostOptionsWrapperEl();if(s&&n.appendChild(s),a&&n.appendChild(a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(l)){const _=cur.poster.getErrorWrapperElement();_.innerHTML="",_.appendChild(l)}const r=cur.poster.getBtnsWrapper(),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_actions_btns");d&&(r.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertBefore)(d,r.firstChild):r.appendChild(d),d.children.length||r.children.length>1?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(r):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(r)),cur.poster.openEditor(),cur.poster.setBkg(t,!0),cur.poster.setText(i)},checkPosterAvailability:function(){if(!cur.poster)return;const _=cur.wallAddMedia?cur.wallAddMedia.getMedias():[],e=cur.poster.isTextFieldValid(cur.postField),t=Wall.checkAttachesForPoster(_),o=e&&t;!o!==cur.poster.state.disabled&&Wall.disablePoster(!o),o&&cur.poster.state.toggled&&(Wall.openPosterEditor(),cur.poster.sendStatsInfo("auto_enable"),cur.poster.state.toggled=!1)},checkAttachesForPoster(_){if(!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(_))return!1;if(!_.length)return!0;let e=0;return _.some((_=>{if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_32__.isArray)(_)){const[t]=_;["copyright","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_27__.MEDIA_TYPE_DONUT_DURATION].includes(t)||++e}})),0===e},disablePoster:function(_){cur.poster&&(void 0===_&&(_=!0),cur.poster.state.disabled=_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(cur.openPosterBtn,"_disable",_))},isPosterEditorOpen:function(){return cur.poster&&cur.poster.isOpen()},saveCaretPositionForPoster:function(_){if(document.activeElement!==_)return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("span"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("span");e.classList.add("poster__marker","poster__marker_start"),t.classList.add("poster__marker","poster__marker_end");let o=getSelection().getRangeAt(0);o=o.cloneRange(),o.insertNode(e),o.collapse(!1),o.insertNode(t)},restoreCaretPositionForPoster:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("poster__marker_start",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("poster__marker_end",_);if(!e||!t)return void wall.focusOnEnd(_);const o=document.createRange();o.setStartBefore(e),o.setEndBefore(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(t);const i=window.getSelection();i.removeAllRanges(),i.addRange(o)},getMainPostBlock:function(){let _=cur.mainPostBlock;return _||(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("submit_post_box")),cur.mainPostBlock=_),_},changeAuthorInPoster:function(_){cur.poster&&_&&cur.poster.changeBkgAuthor({authorName:_.authorName,authorUrl:_.authorUrl})},closeFancyTooltipsInPost:function(){const _=cur.wallAddMedia.lnkId;cur["postPostponeTT"+_]&&cur["postPostponeTT"+_].hide(),cur["post_action_btn"+_]&&cur["post_action_btn"+_].hide(),(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_31__.topicUISelectorHide)(_)},switchOwner:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_ui_toggler",_),"on"),uiSearch.showProgress("wall_search"),cur.options.params.owners_only=cur.options.params.owners_only?null:1,nav.change({owners_only:cur.options.params.owners_only,offset:null})},fakeReplyAsGroupOver:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("reply_fakebox_with_official",_)&&wall.replyAsGroupOver(_)},fakeReplyAsGroupCheck:function(_,e,t){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("reply_fakebox_with_official",_))return window.tooltips&&window.tooltips.hide(_),Wall.showEditReply(e,null,!1,!1,!0,(function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_as_group"+e);_&&(_.focus(),_.click())})),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(t)},setReplyAsGroup:function(_,e){if(!_)return!1;if(_.hasAttribute("data-reinit-ads-needs-confirmation")&&window.AdsEdit&&!e.reinitConfirmed&&AdsEdit.reinitCreatingPostFormNeeded())return AdsEdit.reinitCreatingPostFormConfirm(wall.setReplyAsGroup.pbind(_,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({},e||{},{reinitConfirmed:!0}))),!1;let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domClosest)("_submit_post_box",_),o=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("signed"),i=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("close_comments"),s=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("mute_notifications"),l=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("official"),a=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("mark_as_ads"),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(_,"tt"),r=e.from||(e.fromGroup?cur.oid:vk.id),d=r==vk.id?wall.replyAsProfileData():window.replyAsData&&window.replyAsData[r]||wall.replyAsGroupDomData(_);d||(d=[]);const[E,c,p,u,,P]=d;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"from-oid")==r||E!=r)return!1;const b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("submit_post_box"),O=!t&&cur.poster&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domClosest)("poster",_),D=t===b;O&&(t=b,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("signed"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("mark_as_ads"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("close_comments"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("mute_notifications"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("official")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"from-oid",r),wall.replyAsAnimate(t,p,c,P),cur.poster&&(D||O)&&Wall.changeAuthorInPoster({authorName:u,authorUrl:p}),n&&n.rows&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(n.rows,(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(this,"active",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(this,"from-oid")==r)})),o&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disable)(o,_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserId(r)),a&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disable)(a,_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserId(r)),i&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disable)(i,_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserId(r)),s&&((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)(a)?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(s,"on"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disable)(s,1)):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disable)(s,_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserId(r))),l&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.checkbox)(l,r!==vk.id),_.setAttribute("aria-label",_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(r)?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_reply_as_group"):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_reply_as_user")),_.hasAttribute("data-replace-owner-name")&&(_.innerHTML=u,"A"===_.tagName&&(_.href=p)),_.hasAttribute("data-replace-post-to")&&(cur.postTo=E),_.hasAttribute("data-replace-oid")&&(cur.oid=E),_.hasAttribute("data-reinit-ads-post-editor")&&window.AdsEdit&&(e.withoutRedraw?AdsEdit.reinitCreatingPostFormBoundWithoutRedraw():AdsEdit.reinitCreatingPostFormBound()),"official"==_.id&&Wall.postChanged(!0);const M=cur.wallAddMedia&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(cur.wallAddMedia.menu.menuNode,"_type_podcast");if(M){let _=cur.postTo==r;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(cur.wallAddMedia.getMedias()||[],(function(e,t){if("podcast"===t[0])return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(t[2],"attach_disabled",!_),_=!1,!1})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggle)(M,_)}return _.id&&Wall.hideCheckTimer(_.id.replace("reply_as_group",""),"editing"),cur.wallAddMedia&&cur.wallAddMedia.donutUpdateVisibility(t),!1},replyAsAnimate:function(_,e,t,o){const i=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("avatar_component_refactor_web"),s=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_post_field_author",_),l=s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("_post_field_image",s),a=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_post_field_official",_),n=a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("_post_field_image",a),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"author_secondary"),d=r?0:1,E=l?.[d]?.offsetWidth,c=n?.[d]?.offsetWidth;if(s&&l&&l[d])if(s.href=e,i){const _=(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_48__.getPostAvatarString)(t,"post_field_user_image",E,!1,r?void 0:"post_field_image_secondary");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domReplaceEl)(l[d],_)}else l[d].src=t;if(n&&n[d])if(i){const _=(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_48__.getPostAvatarString)(t,"post_field_choose_image",c,!1,r?void 0:"post_field_choose_secondary");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domReplaceEl)(n[d],_)}else n[d].src=t;(0,_shared_utils_reflow__WEBPACK_IMPORTED_MODULE_95__.reflow)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(_,"author_secondary")},replyAsGroupOver:function(_){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"checkbox_official")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"reply_fakebox_wrap_image")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"disabled"))return!1;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("_submit_post_box",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("deep_active",_);let o;if(o=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("replies_wrap_deep",_)?[7,8,8]:t?[2,8,8]:[9,8,8],(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_11__.showTooltip)(_,{text:function(){return _shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"from-oid")||vk.id)?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_on_behalf_group"):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_on_behalf_me")},black:1,shift:o,noZIndex:!0}),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"reply_fakebox_wrap_image")&&(wall.isWallReply(_)||wall.isAdsCreatingPost(_))){let e="/al_groups.php",t="get_editor_clubs";wall.isAdsCreatingPost(_)&&(e="/ads_edit.php",t="a_get_promoted_post_stealth_groups"),ajax.post(e,{act:t},{cache:1})}},replyAsGroupFocus:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(_,"tt");e&&e.isShown()||wall.replyAsGroupOver(_)},replyAsGroup:function(_,e,t){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"checkbox_official")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"disabled"))return t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(t);if(!((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"can_reply_as_any_group")>0)&&wall.isWallReply(_))return wall.replyAsGroupTT(_,e,[]),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(t);if(!wall.isWallReply(_)&&!wall.isAdsCreatingPost(_)||cur.replyAsLoaded)wall.showReplyAsGroupTooltip(_,e);else{let t="/al_groups.php",o="get_editor_clubs";wall.isAdsCreatingPost(_)&&(t="/ads_edit.php",o="a_get_promoted_post_stealth_groups"),ajax.post(t,{act:o},{cache:1,onDone:function(t){cur.replyAsLoaded=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)(_)&&wall.showReplyAsGroupTooltip(_,e)}})}return t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(t)},showReplyAsGroupTooltip(_,e){const t=!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("can_reply_only_verified",_),o=(cur.replyAsLoaded||[]).filter((_=>!t||_[0]>0||_[4]||_[6]));wall.replyAsGroupTT(_,e,o)},replyAsGroupDomData:function(_){let e,t,o,i,s,l;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("replies_wrap_deep",_)){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",_),"post-id");o&&(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_box"+o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_fakebox"+o),t=o.split("_")[0])}else e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("_submit_post_box",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"oid");return e&&(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"owner-photo"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"owner-href"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"owner-name"),l=(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_36__.replyBoxOwnerIsNftFromAttr)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"owner-is-nft"))),t&&o&&i&&s&&[t,o,i,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.unclean)(s)),null,l]||cur.wallTpl&&cur.wallTpl.ownerData||!1},isWallReply:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("_submit_post_box",_);return e&&e.id.match(/reply_box(-?\d+)_(\d+)/)},isAdsCreatingPost:function(_){return!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("ads_edit_ad_submit_post_header",_)},replyAsProfileData:function(){return window.cur&&cur.wallTpl&&cur.wallTpl.profileData||window.wkcur&&wkcur.wallTpl&&wkcur.wallTpl.profileData||window.mvcur&&mvcur.wallTpl&&mvcur.wallTpl.profileData},replyAsGroupList:function(_,e){const t=_.hasAttribute("data-disallow-profile")?[]:[wall.replyAsProfileData()],o=wall.replyAsGroupDomData(_);return o&&t.push(o),(wall.isWallReply(_)||wall.isAdsCreatingPost(_))&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(window.replyAsList,(function(){this[0]!=e&&t.push(this)})),t},replyAsGroupTT:function(_,e,t){window.replyAsList=t||[],window.replyAsData={},(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(window.replyAsList,(function(){window.replyAsData[this[0]]=this}));let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(_,"tt"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("_submit_post_box",_),s=i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(i,"from-oid");if(!wall.replyAsProfileData())return!1;if(!o){const t=wall.replyAsGroupList(_,e);let i="";_.hasAttribute("data-enable-search")&&(i+='<div class="post_from_tt_row_search_wrap"><input class="clear_fix post_from_tt_row post_from_tt_row_search" value="" placeholder="'+_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_search")+'" /><div class="post_from_tt_row_search_progress"></div></div>');const l=function(_,e,t,o,i){return'<a id="_post_from_tt_row_oid_'+e+'" class="clear_fix post_from_tt_row _post_from_tt_row_searchable'+_+'" data-from-oid="'+e+'" href="'+t+'"><img class="post_from_tt_image" src="'+o+'" aria-label="'+i+'">'+i+"</a>"};(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(t,(function(){const _=s==this[0]?" active":"";i+=l(_,this[0],this[2],this[1],this[3])}));const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("deep_active",_);o=new ElementTooltip(_,{content:'<div class="post_from_tt_choose _post_scroll_wrap">'+i+"</div>",appendToParent:!0,autoHide:!0,customShow:!0,defaultSide:"bottom",offset:function(){return wall.isAdsCreatingPost(_)?[_.offsetWidth/2+8.5,-2]:a?[1,-5]:[-10,-5]},onFirstTimeShow:function(e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("post_from_tt_row",e);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(t,(function(e,t){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"post_from_tt_row_search")||(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)(t,"click",wall.setReplyAsGroup.pbind(_,{from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(this,"from-oid")}))}));const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("post_from_tt_row_search",e);if(i){let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("_post_from_tt_row_searchable",e);const s=_.getAttribute("data-search-url"),a={};(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)(i,"keyup valueChanged",(function(){const n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(i)).toLowerCase();if(s&&n){_.searchRequestTimeout&&(clearTimeout(_.searchRequestTimeout),delete _.searchRequestTimeout);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("post_from_tt_row_search_progress",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("pr",i)||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.showProgress)(i),_.searchRequestTimeout=setTimeout((function(){a[n]?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.hideProgress)(i):ajax.plainpost(s,{str:n},(function(s){a[n]=!0,s=JSON.parse(s),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(s,(function(){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("_post_from_tt_row_oid_"+this[0])){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)(l("",this[0],this[2],this[1],this[3]));(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_scroll_content",e).appendChild(t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)(t,"click",wall.setReplyAsGroup.pbind(_,{from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"from-oid")})),window.replyAsData[this[0]]||(window.replyAsData[this[0]]=this)}})),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("_post_from_tt_row_searchable",e),setTimeout((function(){o.scroll.update(),o.updatePosition()}),0),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.hideProgress)(i)}),(function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.hideProgress)(i)}))}),500)}(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.each)(t,(function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggle)(e,""===n||-1!==e.innerText.toLowerCase().indexOf(n))}))}))}this.rows=t,this.scroll=new uiScroll((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_post_scroll_wrap",e)),setTimeout((function(){o.scroll.update(),o.updatePosition()}),0)},onShow:function(_){setTimeout((function(){if(!o.scroll)return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("active",_),t=e?e.offsetTop-(o.scroll.data.viewportHeight-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(e)[1])/2:0;o.scroll.scrollTop(t);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("post_from_tt_row_search",_);i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.elfocus)(i)}),0)},onHide:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("post_from_tt_row_search",_);e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(e,"")}}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(_,"tt",o)}e&&o.isShown()&&!_.hasAttribute("data-disallow-profile")&&wall.setReplyAsGroup(_,{from:s==vk.id?e:vk.id}),_.tt&&_.tt.hide&&_.tt.hide(),o.isShown()||o.show()},reportPost:function(_,e,t){window.stManager.add([window.jsc("web/privacy.js"),"privacy.css"],(function(){return Privacy.show(_,e,"report_"+t)}))},parsePostId:_web_wall_wall_utils__WEBPACK_IMPORTED_MODULE_38__.parseObjectPostId,likeIt:function(_,e,t,o){if((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.stopEvent)(o),!vk.id)return!1;if(cur.viewAsBox)return cur.viewAsBox(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(o);const i=wall.parsePostId(e),s=i.type,l=i.id,a=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",_))||wall.domPost(l),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(a,"_like_wrap"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(n,"_count"),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(n,"my_like");let E;E=e==cur.wallLayer?"wkview":cur.wallType?"feed"==cur.wallType?"news"==cur.section?"feed_"+(cur.subsection?cur.subsection:cur.section):"recommended"==cur.section?"feed_recommended"+("recent"!=cur.subsection?"_"+cur.subsection:""):"friends"==cur.section||"groups"==cur.section||"videos"==cur.section||"photos"==cur.section?"feed_"+cur.section+(cur.subsection?"_"+cur.subsection:""):"feed_"+cur.section:"top"==cur.wallType?"wall_top":"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full"):cur.module,ajax.post("like.php",{act:d?"a_do_unlike":"a_do_like",object:s+l,hash:t,wall:2,from:E},{onDone:Wall.likeFullUpdate.pbind(_,e),onFail:function(){return!0}});const c=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.stripHTML)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(r)).replace(/(\s|,)/g,"");return Wall.likeUpdate(_,e,!d,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(c)+(d?-1:1)),"wall"==s&&window.cur.onLike&&window.cur.onLike(_,s,e,d),cur.onWallLike&&cur.onWallLike(),"wall"==s&&Wall.triggerAdStat(l,"like_post"),!1},likesShow:function(_,e,t){if(_.postDontShowLikes)return;t=t||{};const o=wall.parsePostId(e),i=o.type,s=o.id,l=i+s,a=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",_))||wall.domPost(s),n=t.views?"_views_wrap":t.share?"_share_wrap":"_like_wrap",r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(a,n),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"_feedback_info_item")?_:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(r,"_icon"),E=a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(a,"_share_wrap");if(!d||cur.viewAsBox)return;let c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(r)[0],p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(d)[0],u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(d,!0)[0],P=p+u/2-c-41;const b=t.views?{views:1}:t.share?{published:1}:{};if(t.listId&&(b.list=t.listId),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(d,"_feedback_info_item")){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByTag1)("em",d);P=-40,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(d,"feedback_share")&&(P+=7),P+=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(_)[0]/2}const O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(d,"_feedback_info_item")?d:d.parentNode;(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_11__.showTooltip)(O,{url:"/like.php",params:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({act:"a_get_stats",object:l,has_share:E?1:""},b),slide:15,shift:[-P,t.views?2:"wall_reply"==i?-3:7],ajaxdt:100,showdt:400,hidedt:200,dir:"auto",checkLeft:!0,reverseOffset:80,noZIndex:!0,tip:{over:function(){Wall.likesShow(_,e,t)}},onShowStart:function(){const e=O.tt.container;setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.setStyle)(e,{left:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.floatval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getStyle)(e,"left"))+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(d)[0]-p})}),10),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_17__.statlogsValueEvent)("likes_show",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"shown"))},typeClass:"like_tt",className:t.cl||""})},likesShowList:function(_,e,t){t=t||{};const o=wall.parsePostId(e),i=o.type,s=o.id,l=i+s,a=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",_))||wall.domPost(s),n=t.share?"_share_wrap":"_like_wrap",r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(a,n);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domByClass)(r,"_icon")&&!cur.viewAsBox&&(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_9__.showWiki)({w:(t.views?"views":t.share?"shares":"likes")+"/"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clean)(l)},!1,!1,{queue:1})},sharesShow:function(_,e,t){Wall.likesShow(_,e,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(t,{share:1}))},sharesShowList:function(_,e,t){Wall.likesShowList(_,e,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(t,{share:1}))},viewsShowList:function(_,e,t){Wall.likesShowList(_,e,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)(t,{views:1}))},viewsUpdate:function(_,e){const t=wall.parsePostId(e),o={act:"a_get_stats",object:t.type+t.id,views:1};ajax.post("/like.php",o,{cache:1,onDone:function(t,i){Wall.likeUpdate(!1,e,!1,t,void 0,void 0,1);const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{innerHTML:i});_.setAttribute("title",s.innerText||s.textContent),setTimeout(ajax.invalidate.pbind("/like.php",o),3e3)}})},sharesOpen:function(_,e,t){if(cur.viewAsBox)return cur.viewAsBox(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(_);if(!vk.id)return!1;(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.stopEvent)(_);const o=wall.parsePostId(e),i=o.type,s=o.id,l=i+s;return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showBox)("/like.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({act:"publish_box",object:l},t)),"wall"==i&&Wall.triggerAdStat(s,"share_post"),!1},customCur:function(){return window.wkcur&&wkcur.shown?wkcur:window.mvcur&&mvcur.mvShown?mvcur:window.pvcur&&cur.pvShown?pvcur:cur},processPostReplyActions:function(_){},updatePostAuthorData:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("_post_author_data_"+_).forEach((function(_){_.post_author_data_update=!0}))},closeComments:function(_,e,t,o,i){const s=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"closed"))?0:1;if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("feed_post_menu_stats")){const e=_ instanceof HTMLElement?(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.getTrackCodeFromPost)(_):null;s?_shared_feed_stats_click_three_dots__WEBPACK_IMPORTED_MODULE_83__.FeedPostMenuStats.closeComments(e,(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.resolveRefFromCur)()):_shared_feed_stats_click_three_dots__WEBPACK_IMPORTED_MODULE_83__.FeedPostMenuStats.openComments(e,(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.resolveRefFromCur)())}ajax.post("al_wall.php",{act:"close_comments",owner_id:e,post_id:t,close:s,hash:o},{onDone:function(){if(i)i(s);else{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",_);Wall.onCloseComments(s,e)}}})},onCloseComments:function(_,e,t){if(!e||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(e,"post")||vk.widget)return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("comment",e),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("reply_box_inner_wrap",e),s=cur.pgParams&&cur.pgParams.archive||"wall_archive"===cur.module,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(e,"Post--with_closed_comments_donut"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(e,"postponed");if(!(t||l||a||o&&i)){const t=e.id.replace("post","").split("_");return void ajax.post("al_wall.php",{act:"comment_box",owner_id:t[0],post_id:t[1]},{onDone:function(t,o){if(!s){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("comment",e),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("reply_box_inner_wrap",e);if(!_&&t){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("PostButtonReactionsContainer",e).after((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)(t))}if(!i&&o){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("replies_list",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertAfter)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)(o),_)}}Wall.onCloseComments(_,e,!0)}})}s||l||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(e,"closed_comments",_);const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("action_closing_comments",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(n,"closed",_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(n,_?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_open_comments"):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_closing_comments"))},showPostEditedTime:function(_){const e=(cur.lang||{}).wall_changed;if(!e)return;const t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"time")),o=60*((new Date).getTimezoneOffset()+180);t&&(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_11__.showTooltip)(_,{text:e.replace("{time}",(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.getDateText)(t,o)),black:1,shift:[0,4]})},showPostAuthorData:function(_,e){const t=_.className.match(/_post_author_data_(-?\d+_\d+)/)[1]||"",o=e?e.target:window.event.srcElement;!t||o!=_&&o.onmouseover||(_.post_author_data_update&&(delete _.post_author_data_update,_.post_author_data_tt&&(_.post_author_data_tt.destroy(),_.post_author_data_tt=!1)),_.post_author_data_tt||ajax.post("al_page.php",{act:"post_author_data_tt",raw:t},{onDone:function(e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("post_link",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domFC)(_);if(!e||!o)return void(_.post_author_data_tt=!0);const i={content:e,arrowSize:"mini",cls:"post_author_data",defaultSide:"bottom",align:"left",id:"author_tt_"+t},s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("_im_mess_stack",_);s?i.appendTo=s:i.appendToParent=!0,vk.widget&&(i.offset=[0,-2],i.forceSide="bottom"),_.post_author_data_tt=new ElementTooltip(o,i),_.post_author_data_tt.show()}}))},createPostTooltip:_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_33__.createPostTooltip,hidePostCopyrightFeatureTooltip:function(){cur.postCopyrightFeatureTooltip&&cur.postCopyrightFeatureTooltipHash&&(cur.postCopyrightFeatureTooltip=!1,cur.postCopyrightFeatureTT.hide(),setTimeout((()=>{cur.postCopyrightFeatureTT.destroy()}),ElementTooltip.FADE_SPEED),ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.postCopyrightFeatureTooltipHash,type:"post_copyright"}))},showPostCopyrightFeatureTooltip:function(){if(!cur.postCopyrightFeatureTooltip||cur.postCopyrightFeatureTT)return;const _=setTimeout((()=>{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_settings_btn");_&&cur.postCopyrightFeatureTooltip&&(cur.postCopyrightFeatureTT=new ElementTooltip(_,{content:`<div class="feature_tooltip__close" onclick="Wall.hidePostCopyrightFeatureTooltip();"></div>${_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_post_copyright_feature_text")}`,cls:"feature_intro_tt feature_info_tooltip",forceSide:"bottom",autoShow:!1,noOverflow:!1,noHideOnClick:!0,appendToParent:!0,offset:[-6.5,-8],onShow:()=>{ajax.post("al_index.php",{act:"show_feature_tt",hash:cur.postCopyrightFeatureTooltipHash,type:"post_copyright"})},onWindowClick:()=>{cur.postCopyrightFeatureTT&&(cur.postCopyrightFeatureTT.hide(),cur.postField.blur())}}),cur.postCopyrightFeatureTT.show())}),800);cur.destroy.push((()=>clearTimeout(_)))},showPostOnlineBookingTooltip:function(_){if(!_)return;const e=_.querySelector(".ms_items_more_wrap");if(e&&e.hasAttribute("data-disable-show-online-booking-tooltip"))return;let t;var o;o=()=>{const o=_.querySelector(".ms_items_more_wrap");if(!o)return;const i=()=>{t&&(t.hide(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.removeEvent)(e,"mouseover",i))};(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)(e,"mouseover",i),t=new ElementTooltip(o,{content:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("intro_hint_description_online_booking_attach_add_web"),cls:"eltt_fancy poster_feature_tt",defaultSide:"left",autoShow:!1,appendToParent:!0,onHide:()=>(e&&e.setAttribute("data-disable-show-online-booking-tooltip","true"),(0,_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_96__.ensureAccountHelpHintsService)().hideHelpHint(_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_97__.AvailableHelpHints.ACCOUNT_HINT_POSTING_EDITOR_ONLINE_BOOKING),t&&t.destroy(),void(t=null))}),t.show()},(0,_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_96__.ensureAccountHelpHintsService)().canShow(_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_97__.AvailableHelpHints.ACCOUNT_HINT_POSTING_EDITOR_ONLINE_BOOKING)&&o()},hidePosterFeatureTooltip:function(){cur.posterFeatureTooltip=!1,cur.posterFeatureTT&&cur.posterFeatureTooltipHash&&(cur.posterFeatureTT.destroy(),cur.posterFeatureTT=null,ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.posterFeatureTooltipHash,type:"poster_new_year"}))},showPosterFeatureTooltip:function(){if(!cur.posterFeatureTooltip)return;const _=setTimeout((function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domQuery1)(".poster__open-btn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_poster_btn"));if(!_||!cur.posterFeatureTooltip)return;const e='<div class="poster_feature_tt__layout" onclick="cur.posterFeatureTT.hide(); cancelEvent(event);"><div class="poster_feature_tt__close"></div><div class="poster_feature_tt__info">'+_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_new_posters_new_year")+"</div>";cur.posterFeatureTT=new ElementTooltip(_,{content:e,forceSide:"bottom",cls:"eltt_fancy poster_feature_tt",autoShow:!1,noOverflow:!1,align:"left",centerShift:-28,noHideOnClick:!0,appendToParent:!0,offset:[0,-8],onHide:Wall.hidePosterFeatureTooltip,onWindowClick:function(){cur.posterFeatureTT.hide(),cur.postField.blur()}}),cur.posterFeatureTT.show(),cur.poster&&cur.poster.sendStatsInfo("new_bkg_tooltip_show")}),800);(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_92__.pushNavDestroy)((()=>{clearTimeout(_)}))},replyEditPhoto:function(_,e,t){return Wall.showEditReply(e,null,!1,!1,!1,(function(){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_more_attaches"+e);if(t){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ms_item_photo",t);tooltips.hide(_),e&&e.click()}})),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(t)},replyMoreAttachShow:function(_,e,t){return Wall.showEditReply(e,null,!1,!1,!0,(function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ms_items_more_wrap",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_more_attaches"+e));_&&(_.focus(),_.click())})),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(t)},replyFakeEmojiOver:function(_){wall.initEditReply(_,!1,!0,(function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_smile"+_);if(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("emoji_smile",e);_.onmouseenter?.()}}))},hideDeepReplies:function(_){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(e,"reply")&&(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",e),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"post-id"));const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"replies-offset")||0,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"replies-limit")||3,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+_),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(cur.wallTpl.reply_deep_next,{post_id:_,reply_id:_,offset:t,count:o,text:"",class:" replies_next_main",post_author_suffix:""}));i.innerHTML="",i.appendChild(s),(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_18__.scrollToY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(i)[1]-100,0,null,!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(s,"collapse",!0),s.click(),cur.wallMyOpened[_]=0},addNewReply:function(_){const e=_[2],t=(_[10]||"").match(/wall.showReply\([^-)0-9]*(-?[_0-9]+)[^-)0-9]*(-?[_0-9]+)[^-)0-9]*\)/),o=t&&t[2]||"",i=o&&o!==e,s=cur.wallLayer&&cur.wallLayer===e,l=s?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+e),a=l.offsetHeight;let n,r=0,d=0;n=i?wall._addDeepReply(_,o):wall._addRootReply(_);const E=s?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+e);return wall.incReplyCounter(E,1,_[13]),s?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("wl_replies_wrap",E)),cur.count++,cur.loaded++):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("replies_wrap"+e),Wall.repliesSideSetup(e)),Wall.updateMentionsIndex(),n&&((0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_43__.updateNarrativeSnippetsFromQueueByPost)(n),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_44__.updateArticleSnippetsFromQueueByPost)(n),(0,_web_stickers_utils__WEBPACK_IMPORTED_MODULE_49__.updateStickersFromQueue)(n),r=l.offsetHeight-a,d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(n,s)[1]),[r,d]},_addDeepReply:function(_,e){const t=_[2],o=_[10]||"",i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)(o);let s=i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(i,"root-id")||e,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+s);const a=l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("replies_wrap_deep",l),n=cur.wallLayer&&cur.wallLayer===t?wkcur:cur;let r;if(a&&(s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(a,"post-id"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+s)),!l)return null;let d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+s);if(!d){wall.addDeepRepliesBlock(s);const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_fakebox"+s)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_box"+s);_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(_),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+s),r=d}if(!d)return null;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("reply",d).length){const _=wall._addNewReplyShowMore(t,s,d,"replies_next_deep");r=r||_}else{let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_short_deep"+s);const o=wall.isDescRepliesOrder(t);if(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("replies_short_text_count",e),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(_).replace(/[^0-9]/g,""))||0;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(_,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_replied_to_reply_count",t+1))}else{e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(n.wallTpl.reply_deep_short,{post_id:t,reply_id:s,reply_msg_id:s.split("_")[1],img_src:_[6]||"",name:_[5]||"",count:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("global_replied_to_reply_count",1)}));const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domFC)(d);if(i)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertBefore)(e,i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(i,"replies_next_deep")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(i,"replies_prev",o);else{d.appendChild(e);const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(n.wallTpl.reply_deep_next,{post_id:t,reply_id:s,offset:0,count:1,text:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_next_n_replies",1),class:" replies_next_deep"+(o?" replies_prev":""),post_author_suffix:""}));d.appendChild(_)}}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(a,"replies_deep_has_short"),r=e}return wall.updateCollapseDeepReplies(s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(a,"replies_deep_empty_list"),r},_addRootReply:function(_){const e=_[2],t=cur.wallLayer&&cur.wallLayer===e,o=t?wkcur:cur,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+e),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domChildren)(i).length,l="full"===o.wallType,a=!s||s<3&&(t||l),n=wall.isDescRepliesOrder(e);if(a){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.intval)(_[_.length-1]),t=void 0!==o.options.is_admin?o.options.is_admin:_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(o.options.wall_oid)?8&e?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.EDITOR:2&e?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER,s=Wall.getNewReplyHTML(_,t,!1,o);if(!s)throw new Error("Failed to add root reply");const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)(s);return(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.highlightUpdatedReply)(l),n&&i.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertBefore)(l,i.firstChild):i.appendChild(l),l}return wall._addNewReplyShowMore(e,e,i,"replies_next_main",n)},_addNewReplyShowMore:function(_,e,t,o,i){const s=cur.wallLayer&&cur.wallLayer===_?wkcur:cur,l=s.options.replies_page_count||20,a=i?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domFC)(t):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domLC)(t);let n,r;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(a,"replies_next"))return n=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(a,"count")||0,n<l?(n++,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(a,"count",n),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(a,i?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_prev_n_replies",n):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_next_n_replies",n))):i&&(r=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(a,"offset")||0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(a,"offset",r+1)),a;{if(i)r=0;else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)(o,t),e=_[_.length-1],i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domChildren)(t);if(e){const _=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"count")||l,t=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"offset")||0;let o=i.indexOf(e);o=(o>=0?o:0)+1;r=t+_+i.slice(o).filter((function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"reply")})).length}else r=i.filter((function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(_,"reply")})).length}const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(s.wallTpl.reply_deep_next,{post_id:_,reply_id:e,offset:r,count:1,text:i?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_prev_n_replies",1):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_next_n_replies",1),class:" "+(i?" replies_prev":"")+(o?" "+o:""),post_author_suffix:""}));return i?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertBefore)(a,t.firstChild):t.appendChild(a),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_35__.loadRepliesLinkShow)(a),a}},removeDeepReply:function(_){const e=_[2],t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+e);let o=0,i=0;if(cur.wallMyDeleted[e]||!t)return[o,i];i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getXY)(t,cur.layerpost)[1],(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_20__.revertLastInlineVideo)(t);const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",t)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",t),l=s?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(s,"post-id"):"",a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("replies_wrap_deep",t);if(a)o=-t.offsetHeight,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.getSize)(a)[1]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(a,"replies_deep_empty_list"),wall.updateCollapseDeepReplies(e);else{if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_wrap_deep"+e)){const _=cur.wallLayer&&cur.wallLayer===l?wkcur:cur,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("reply_date",t),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("reply_link_wrap",t);let a="";const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.attr)(t,"onclick");n&&(a+=' onclick="'+n+'"');const r=e.split("_")[0],d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(r)?_.wallTpl.reply_deleted_group:_.wallTpl.reply_deleted_user,{reply_id:e,date:i?i.innerHTML:"",answer:s?s.outerHTML:"",class:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"reply_replieable")?" reply_replieable":"",attr:a})),E=t.offsetHeight;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domReplaceEl)(t,d),o=d.offsetHeight-E}else o=-t.offsetHeight,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(t)}return cur.layerpost&&(cur.count--,cur.loaded--),s&&(wall.repliesSideSetup(l),wall.incReplyCounter(s,-1)),[o,i]},addDeepRepliesBlock:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post"+_);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(e,"reply"))return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("wl_post",e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("post",e);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(t,"deep_active"))return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(t,"post-id");let i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies_wrap_deep"+_);const s=(cur.wallLayer?wkcur:cur).wallTpl;i||(i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(s.reply_deep,{post_id:o,reply_id:_,reply_msg_id:_.split("_")[1],text:"",offset:0,class:" replies_next_deep"})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertAfter)(i,e));const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_fakebox"+_),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_box"+_);if(!l&&!a){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_fakebox"+o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("reply_box"+o),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("checkbox_official",e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("reply_fakebox_with_official",e),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(s.reply_box,{post_id:_,owner_name:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.clean)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"owner-name")||""),owner_photo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"owner-photo")||"",owner_href:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"owner-href")||"",owner_is_nft:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"owner-is-nft")||"",can_reply_as_group:t||"",class:t?" reply_fakebox_with_official":""}));i.appendChild(l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(i,"replies_deep_has_field")}},addReplyName:function(_,e){const t={};t[_]=e,wall.addReplyNames(t)},addReplyNames:function(_){const e=cur.wallLayer?wkcur:cur;e.options||(e.options={}),e.options.reply_names=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.extend)({},e.options.reply_names,_)},getReplyNames:function(){return(cur.wallLayer?wkcur:cur).options.reply_names||{}},getReplyName:function(_){if(cur.pvShown&&cur.pvReplyNames)return cur.pvReplyNames[_]||[];if(window.mvcur&&mvcur.mvShown&&!mvcur.minimized)return mvcur.mvReplyNames[_]||[];return wall.getReplyNames()[_]||[]},showReorderRepliesTooltip:function(_,e){const t=cur.wallLayer&&cur.wallLayer===e?wkcur:cur;if(!t["postRepliesReorderTT"+e]&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(_,"ett")){const o=_.closest(".post_replies_reorder_wrap");let i;i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"hide-smart")||!1?t.wallTpl.replies_reorder_tooltip:t.wallTpl.replies_reorder_tooltip_with_smart;const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(i||"",{postId:e})),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("radiobtn",s),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"order")||"asc",n="post_replies_reorder"+e;radioBtns[n]={val:a,els:l},l.some((function(_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"order")===a)return(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_33__.updatePostTooltipActionRadioBtn)(_,!0,n),!0}));const r=new ElementTooltip(_,{appendTo:o?.parentNode,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:[-10,0],content:s,align:"left"});t["postRepliesReorderTT"+e]=r,(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_92__.pushNavDestroy)((()=>{r&&r.destroy()})),r.show()}},reorderReplies:function(_,e,t){const o=cur.wallLayer&&cur.wallLayer===e?wkcur:cur;t=t||"asc",(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_33__.updatePostTooltipActionRadioBtn)(_,t,"post_replies_reorder"+e);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_replies_reorder"+e),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"label")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(_),l=i?.querySelector(".post_replies_reorder");if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(l,s),i&&(i.setAttribute("aria-label",s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(i,"order",t)),o["postRepliesReorderTT"+e]&&o["postRepliesReorderTT"+e].hide(),(0,_web_feed_feed_stats__WEBPACK_IMPORTED_MODULE_72__.isFeedRepliesStatsEnabled)()){let _=0,o=0;if(e&&"string"==typeof e){const t=e.split("_");_=t[0],o=t[1]}const i=document.getElementById("post"+e),s=(0,_web_feed_utils_miscellaneous__WEBPACK_IMPORTED_MODULE_77__.postsGetRaws)(i?.parentElement);_shared_production_stats_click_feed_comments_sort_tab_click__WEBPACK_IMPORTED_MODULE_76__.feedCommentsSortTabClickCollector.logEvent({event:(0,_web_feed_feed_stats__WEBPACK_IMPORTED_MODULE_72__.getCommentsSortEvent)(t),wall_item_id:{owner_id:_,id:o},ref:(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_63__.resolveRefFromCur)(),position:s.index??0},{type:_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_66__.EventItemType.POST})}wall.moreReplies(e,0,0,{deep:!0,clear:!0,order:t,onDone:function(_,t,o){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("replies"+e);if(o.count>o.offset+o.num){const _=cur.wallLayer&&cur.wallLayer===e?wkcur:cur,t=_.options.replies_page_count||20,s=Math.min(t,o.count-o.offset-o.num),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(_.wallTpl.reply_deep_next,{post_id:e,reply_id:e,offset:o.offset+o.num,count:s,text:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_next_n_replies",s),class:" replies_next_main",post_author_suffix:o.author_avatar_suffix}));i.appendChild(l)}o.top_reply_ids&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(i,"top-ids",o.top_reply_ids.join(",")),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[e]=1,wall.repliesSideSetup(e)}})},getRepliesOrder:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("post_replies_reorder"+_);return(e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(e,"order"):"")||"asc"},isDescRepliesOrder:function(_,e){return"desc"===(e=e||wall.getRepliesOrder(_))},postEventChangeStatus:function(_,e,t,o){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domData)(_,"context"),s=()=>document.querySelectorAll(".post_event_action_btn"+e);return window.stManager.add([window.jsc("web/groups.js")],(()=>{Groups.enter(_,e,t,i,((_,t,o)=>{const l=i.split("_"),a=!l[1],n=l[0]+"_"+(a?"decline":""),r=a?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("events_snippet_will_participate_active"):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("events_snippet_cant_participate_active");o=o||{},s().forEach((_=>{_.dataset.context=n,_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.setAppearance(_,_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButtonAppearance.SECONDARY),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.setLabel(_,r)})),o.members&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("page_media_event"+e).forEach((_=>{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("page_media_event_members",_);e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)(e,o.members)}))}),{showProgress:()=>{s().forEach((_=>{_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.lock(_)}))},hideProgress:()=>{s().forEach((_=>{_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_47__.FlatButton.unlock(_)}))}})})),o&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.cancelEvent)(o)},showEventFriends:function(_,e){(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_11__.showTooltip)(_,{url:"/al_groups.php",params:{act:"a_event_friends_tt",owner_id:e},ajaxdt:100,showdt:400,hidedt:200,dir:"auto",noZIndex:!0,typeClass:"like_tt"})},updateRepliesOnScroll:function(){cur.wallLayer?WkView.wallUpdateRepliesOnScroll():"full"===cur.wallType&&FullWall.onePostOnScroll()},updateConvertedClassifiedPost:function({postId:_,ownerId:e}){ajax.post("al_wall.php",{act:"s_one",post_id:_,owner_id:e,render_context:"wall",only_post:!0},{onDone:t=>{const o=Wall.domPost(`${e}_${_}`);if(o&&t){const _=document.createElement("div");_.innerHTML=t,o.querySelector(".post_info").innerHTML=_.querySelector(".post_info").innerHTML}}})},sendFakeNewsMark:function(_,e,t,o,i){const s="data-mark-exists",l={post_id:t,owner_id:o,mark:1===parseInt(_.getAttribute(s))?0:1,hash:i},a={onDone(e,t){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.showDoneBox)(e),_.innerHTML=t,_.setAttribute(s,l.mark)},onFail:_=>(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_26__.showErrorBox)(_),showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockActionsMenuItem)(_),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockActionsMenuItem)(_)};ajax.post(e,l,a)},sendToObsceneCheck:function(_,e,t,o,i){const s={post_id:t,owner_id:o,hash:i},l={onDone(_){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.showDoneBox)(_)},onFail:_=>(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_26__.showErrorBox)(_),showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockActionsMenuItem)(_),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockActionsMenuItem)(_)};ajax.post(e,s,l)},openMarkAsAdsOrdMiniApp:function(_){const e='[name="ord_pred_id"]',t='[name="erid"]',o=(_,e,t)=>{_&&(t?_.classList.contains(e)||(_.classList.add(e),_.classList.add("on")):_.classList.contains(e)&&(_.classList.remove(e),_.classList.remove("on")))},i=(()=>{const o=_.querySelector(e),i=_.querySelector(t),s=_.classList.contains("on"),l=o&&o.value;return{is_ad:s,erid:i&&i.value,ord_pred_id:l}})();(0,_web_ord_utils__WEBPACK_IMPORTED_MODULE_61__.handleOrdMiniappOpen)(i,(i=>(i=>{const s=i.is_ad,l=_.closest(".PostSettings"),a=l&&l.querySelector("#post_icon_gear_settings"),n=_.querySelector(e),r=_.querySelector(t);o(a,"PostOption__iconWrapperApplied",s),o(_,"PostOption__withMarkAdsOrdMiniApp",s),n&&(n.value=i.ord_pred_id),r&&(r.value=i.erid)})(i)),{isSnackbar:!0,edit:!1})},toggleDowngradeState:function(_,e,t,o,i){const s="data-downgraded",l={post_id:t,owner_id:o,set:1===parseInt(_.getAttribute(s))?0:1,hash:i},a={onDone(e,t){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_16__.showDoneBox)(e),_.innerHTML=t,_.setAttribute(s,l.set)},onFail:_=>(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_26__.showErrorBox)(_),showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockActionsMenuItem)(_),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockActionsMenuItem)(_)};ajax.post(e,l,a)},initPostWarningField(){if(window.cur.postWarningField)return;window.cur.postWarningField=document.createElement("span"),window.cur.postWarningField.classList.add("post_field_warning");const _=window.cur.postField?.parentElement;_&&_.appendChild(window.cur.postWarningField)},showPostGeoBanBox(_,e){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showBox)("groups_wall_posts_geoban.php",{act:"manage_geoban_box",gid:_,post_id:e})},initPostGeoBan(_,e,t){this.geoBlockCountryElement=document.getElementById("post_geoban_country"),this.geoBlockCountries=e.values,this.geoBlockCommentField=document.getElementById("post_geoban_comment"),this.geoBlockComments=e.comments,this.geoBlockDoAction=t=>{ajax.post("groups_wall_posts_geoban.php",{act:"a_set_post_geoban",status:t,comment:this.geoBlockCommentField.value,country:this.geoBlockCountry.val(),post_id:_,hash:e.hash},{onDone:()=>{window.nav.reload()},onFail:_=>(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)("Ошибка",_)})},this.geoBlockBanAction=()=>{this.geoBlockDoAction(1)},this.geoBlockUnbanAction=()=>{this.geoBlockDoAction(0)},this.geoBlockCountryChange=()=>{const _=this.geoBlockCountry.val();this.geoBlockComments[_]?(this.geoBlockCommentField.value=this.geoBlockComments[_],this.geoBlockCommentField.disabled=!0,t.setButtons("Разблокировать",this.geoBlockUnbanAction)):(this.geoBlockCommentField.value="",this.geoBlockCommentField.disabled=!1,t.setButtons("Заблокировать",this.geoBlockBanAction))},this.geoBlockCountry=new Dropdown(this.geoBlockCountryElement,this.geoBlockCountries,{big:1,selectedItems:[],onChange:this.geoBlockCountryChange}),this.geoBlockCountryChange(),(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_51__.autosizeSetup)("post_geoban_comment",{minHeight:60})},getLastReplies(_,e=4){const t=wall.isDescRepliesOrder(_),o=wall.getRepliesOrder(_),i="smart"===o,s=cur?.wallLayer===_?wkcur:cur;const l={clear:!0,deep:i,rev:t?1:0,order:o};wall.moreReplies(_,null,e,{...l,onDone:function(e,o,l){const a=document.querySelector(`#replies${_}`);if(!a)return;if(l.count>l.offset+l.num){const e=s.options.replies_page_count||20,o=Math.min(e,l.count-l.offset-l.num),n=t||i,r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.rs)(s.wallTpl.reply_deep_next,{post_id:_,reply_id:_,offset:l.offset+l.num,count:o,text:n?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_next_n_replies",o):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("wall_prev_n_replies",o),class:n?" replies_next replies_next_main":" replies_prev",post_author_suffix:""}));n?a.appendChild(r):a.insertBefore(r,a.firstChild)}const n=a.parentNode;n&&e&&(n.style.display=""),l.top_reply_ids&&(a.dataset.topIds=l.top_reply_ids.join(",")),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[_]=1,wall.repliesSideSetup(_)}})},initHashtagComposer(_,e,t){const o=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("posting_hashtags_web");if(!o)return;const i=(_,e)=>{if(""===_||"isLoading"===window.cur.hashtags)return[];if(!window.cur.hashtags)return window.cur.hashtags="isLoading",(0,_vkontakte_internal_vkjs_lib_API__WEBPACK_IMPORTED_MODULE_73__.api)("wall.getSuggestedHashtags",{}).then((t=>{window.cur.hashtags=t.hashtags,e(i(_,e))})),[];const t=[(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_15__.escapeRE)(_),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.parseLatin)(_),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.parseCyr)(_)].filter((_=>_)),o=new RegExp("(?![^&;]+;)(?!<[^<>]*)((\\(*)("+t.join("|")+"))(?![^<>]*>)(?![^&;]+;)","gi");return window.cur.hashtags.filter((_=>_.match(o))).map((_=>"#"+_))};Wall.initComposer(_,{...e,lang:{introText:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("profile_hashtag_start_typing"),noResult:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang("profile_hashtag_not_found")},hashtagEnable:o,wddOpts:{customNeedEmpty:!0,custom:i}},t)},deinitHashtagComposer(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(_,"composer_hashtag");e&&Composer.destroy(e)}};(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.isPostingStatsEnabled)()&&!vk.widget&&((0,_shared_evbus__WEBPACK_IMPORTED_MODULE_86__.tq)().setInteractiveHandler("Posting/upload_file",(()=>{(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.UPLOAD_FILE)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_86__.tq)().setInteractiveHandler("Posting/upload_video",(()=>{(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.UPLOAD_VIDEO)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_86__.tq)().setInteractiveHandler("Posting/upload_photo",(()=>{(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.UPLOAD_PHOTO)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_86__.tq)().setInteractiveHandler("Posting/albums_load_more",(()=>{(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_84__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_85__.POSTING_STATS_NAMES.SHOW_ALBUM)})));const __WEBPACK_DEFAULT_EXPORT__=Wall},357128:(_,e,t)=>{"use strict";t.d(e,{Atom:()=>o});class o{set(_,{notify:e=!0}={}){e&&this.base.notify(this.key)}getKey(){return`${this.base.options.storeName}-${this.key}`}constructor({key:_,base:e}){this.key=_,this.base=e}}},200644:(_,e,t)=>{"use strict";t.d(e,{Store:()=>o});class o{subscribe(_,e){const t=this.getListeners(e);return t.add(_),()=>{t.delete(_)}}notify(_,e){this.getListeners(e).forEach((e=>{e(_)}))}refresh(){try{localStorage.setItem(this.key,""),localStorage.removeItem(this.key)}catch{}}destroy(){this.listeners.clear(),this.syncListeners.clear(),o.instances.delete(this.key)}get key(){const{dbName:_,storeName:e,version:t}=this.options;return`${_}-v${t}-${e}`}getListeners(_){return _?this.syncListeners:this.listeners}constructor(_){this.listeners=new Set,this.syncListeners=new Set,this.options=_,o.instances.set(this.key,this)}}o.instances=new Map,window.addEventListener("storage",(({key:_,newValue:e})=>{if(!_||null===e)return;const t=o.instances.get(_);t?.notify()}))},199880:(_,e,t)=>{"use strict";t.d(e,{SyncAtom:()=>s,SyncAtomType:()=>o});var o,i=t(357128);!function(_){_.OBJECT="object",_.STRING="string",_.NUMBER="number",_.BOOLEAN="boolean",_.STRING_NUMBER="string_number"}(o||(o={}));class s extends i.Atom{get(){const _=this.getKey();try{let e=localStorage.getItem(_);if(!e)return null;switch(this.type){case o.OBJECT:try{e=JSON.parse(e)}catch{return null}break;case o.NUMBER:e=Number(e)||0;break;case o.STRING_NUMBER:e=Number(e)||e;break;case o.BOOLEAN:e=Boolean(Number(e))}return e}catch(e){return console.log(`${_}: Ошибка чтения данных из хранилища`),console.log(e),this.cache||null}}set(_,e){const t=this.getKey();let i;switch(this.type){case o.OBJECT:i=JSON.stringify(_);break;case o.BOOLEAN:i=String(Number(_));break;default:i=String(_)}try{localStorage.setItem(t,i)}catch(e){console.log(`${t}: Не удалось записать данные в хранилище`),console.log(e),this.cache=_}super.set(_,e)}delete(){const _=this.getKey();try{delete this.cache,localStorage.removeItem(_)}catch(e){console.log(`${_}: Ошибка удаления ключа из хранилища`),console.log(e)}}getKey(){return`${this.base.key}-${this.key}`}constructor(_){super(_);const{base:e,type:t}=_;this.base=e,this.type=t}}},415117:(_,e,t)=>{"use strict";t.d(e,{createSyncStore:()=>l});var o=t(200644),i=t(199880);class s extends o.Store{createAtom(_,e){return new i.SyncAtom({key:_,type:e,base:this})}constructor(_){super(_)}}function l(_){return new s(_)}},484801:(_,e,t)=>{"use strict";t.d(e,{PackContext:()=>r});var o=t(434518),i=t(763812),s=(0,i._)("_options"),l=(0,i._)("_pack"),a=(0,i._)("_product"),n=(0,i._)("_stockItem");class r{get rawData(){return(0,o._)(this,l)[l]||(0,o._)(this,n)[n]||(0,o._)(this,a)[a]}get isPack(){return Boolean((0,o._)(this,l)[l])}get isProduct(){return Boolean((0,o._)(this,a)[a])}get isStockItem(){return Boolean((0,o._)(this,n)[n])}get isStoreItem(){return this.isProduct||this.isStockItem}get stockItem(){return(0,o._)(this,n)[n]}get id(){const _=(0,o._)(this,s)[s]?.redefine?.id;if(void 0!==_)return _;const e=(0,o._)(this,a)[a]?.id;return void 0!==e?e:(0,o._)(this,l)[l]?.id}setHint(_){return(0,o._)(this,s)[s]?((0,o._)(this,s)[s].hint=_,this):this}get hintId(){return(0,o._)(this,s)[s]?.hint?.id}get hintWidth(){return(0,o._)(this,s)[s]?.hint?.width}get index(){return(0,o._)(this,s)[s]?.index}get referrer(){return(0,o._)(this,s)[s]?.referrer}get tooltip(){return(0,o._)(this,s)[s]?.tooltip}get title(){return(0,o._)(this,s)[s]?.redefine?.title||(0,o._)(this,a)[a]?.title||""}get stickers(){return(0,o._)(this,s)[s]?.redefine?.stickers||(0,o._)(this,l)[l]?.stickers||(0,o._)(this,a)[a]?.stickers}get baseId(){return(0,o._)(this,a)[a]?.base_id}get isStyle(){return void 0!==this.baseId}get hasStyles(){return Boolean(this.styleIds?.length)}get styleIds(){return(0,o._)(this,a)[a]?.style_ids}get canGift(){return Boolean((0,o._)(this,n)[n]?.can_gift)}get vmojiAvatar(){return(0,o._)(this,a)[a]?.vmoji_avatar}get isVmoji(){return Boolean(this.vmojiAvatar||(0,o._)(this,a)[a]?.is_vmoji)}get isPopup(){return(0,o._)(this,a)[a]?.is_popup}get isNew(){return(0,o._)(this,a)[a]?.is_new}get previews(){return(0,o._)(this,a)[a]?.previews}constructor({pack:_,...e}){Object.defineProperty(this,s,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,a,{writable:!0,value:void 0}),Object.defineProperty(this,n,{writable:!0,value:void 0}),(0,o._)(this,s)[s]=e,_&&("product"in _?((0,o._)(this,n)[n]=_,(0,o._)(this,a)[a]=_.product):"id"in _&&"type"in _?(0,o._)(this,a)[a]=_:(0,o._)(this,l)[l]=_)}}},624761:(_,e,t)=>{"use strict";t.d(e,{stickersEmojiKeyboard:()=>o});const o=(0,t(32489).createDomain)()},498716:(_,e,t)=>{"use strict";t.d(e,{$favoriteStickers:()=>s,setFavoriteStickers:()=>i});var o=t(624761);const i=o.stickersEmojiKeyboard.createEvent(),s=o.stickersEmojiKeyboard.createStore(null).on(i,((_,e)=>e))},656947:(_,e,t)=>{"use strict";t.d(e,{$hasAvatar:()=>s,setHasAvatar:()=>i});var o=t(624761);const i=o.stickersEmojiKeyboard.createEvent(),s=o.stickersEmojiKeyboard.createStore(null).on(i,((_,e)=>e))},603943:(_,e,t)=>{"use strict";t.d(e,{$packs:()=>p,ServicePackKey:()=>o});var o,i,s=t(32489),l=t(61070),a=t(625722),n=t(656947),r=t(684490),d=t(316299),E=t(498716),c=t(484801);!function(_){_[_.FAVORITE=-1]="FAVORITE",_[_.RECENT=-2]="RECENT",_[_.VMOJI=-3]="VMOJI",_[_.UGC=-4]="UGC"}(o||(o={})),function(_){_.RECENT="recent",_.FAVORITE="favourite",_.KEYBOARD="keyboard"}(i||(i={}));const p=(0,s.combine)(l.$ugcInfo,a.$ugcPacks,r.$stockItems,d.$recentStickers,E.$favoriteStickers,n.$hasAvatar,((_,e,t,s,l,a)=>{const n=new Map;let r=[];const d=new Map;let E=0;if(!t||!s||!l)return{};l.length&&(n.set(o.FAVORITE,new c.PackContext({index:E,referrer:i.FAVORITE,redefine:{id:o.FAVORITE,title:"stickers_picker_favorite",stickers:l}})),r.push(o.FAVORITE),E++),s.length&&(n.set(o.RECENT,new c.PackContext({index:E,referrer:i.RECENT,redefine:{id:o.RECENT,title:"stickers_picker_recently_used",stickers:s}})),r.push(o.RECENT),E++);-1!==t?.findIndex((({product:{vmoji_avatar:_}})=>void 0!==_))||a||(n.set(o.VMOJI,new c.PackContext({index:E,referrer:i.KEYBOARD,redefine:{id:o.VMOJI,title:"stickers_picker_vmoji"}})),r.push(o.VMOJI),E++);const p=e?.[0],u=_?.can_edit,P=p?.stickers?.length,b=_?.show_keyboard_onboarding&&u;if(!_?.is_keyboard_hidden&&(P||b)){const _=new c.PackContext({pack:p,index:E,referrer:i.KEYBOARD,tooltip:{header:"stickers_picker_ugc_tooltip_title",text:"stickers_picker_ugc_tooltip_description"},redefine:{id:o.UGC,title:"stickers_picker_ugc"}});u&&_.setHint({id:"stickers:ugc_keyboard_onboarding_tooltip",width:176}),n.set(o.UGC,_),r.push(o.UGC),E++}return t.forEach((_=>{const{product:{id:e,vmoji_avatar:t}}=_;if(n.set(e,new c.PackContext({index:E,referrer:i.KEYBOARD,pack:_})),t){let _=d.get(t.id);_||(_=r.push([])-1,d.set(t.id,_));const o=r[_];Array.isArray(o)&&o.push(e)}else r.push(e);E++})),{packs:n,packsGroups:r}}))},684490:(_,e,t)=>{"use strict";t.d(e,{$stockItems:()=>s,setStockItems:()=>i});var o=t(624761);const i=o.stickersEmojiKeyboard.createEvent(),s=o.stickersEmojiKeyboard.createStore(null).on(i,((_,e)=>e))},316299:(_,e,t)=>{"use strict";t.d(e,{$recentStickers:()=>s,setRecentStickers:()=>i});var o=t(624761);const i=o.stickersEmojiKeyboard.createEvent(),s=o.stickersEmojiKeyboard.createStore(null).on(i,((_,e)=>e))},61070:(_,e,t)=>{"use strict";t.d(e,{$ugcInfo:()=>d,reloadUGCInfo:()=>n,setUGCInfo:()=>a});var o=t(32489),i=t(962177),s=t(624761),l=t(164272);const a=s.stickersEmojiKeyboard.createEvent(),n=s.stickersEmojiKeyboard.createEvent(),r=s.stickersEmojiKeyboard.createEffect((_=>_.cache.ugcInfo.get().catch((()=>null)))),d=s.stickersEmojiKeyboard.createStore(null).on(a,((_,e)=>e)).on(r.doneData,((_,e)=>e)).on(l.submitUGCReportFx.doneData,(()=>null));(0,o.sample)({clock:n,source:i.$api,target:r})},625722:(_,e,t)=>{"use strict";t.d(e,{$ugcPacks:()=>l,setUGCPacks:()=>s});var o=t(624761),i=t(164272);const s=o.stickersEmojiKeyboard.createEvent(),l=o.stickersEmojiKeyboard.createStore(null).on(s,((_,e)=>e)).on(i.submitUGCReportFx.doneData,(()=>null))},164272:(_,e,t)=>{"use strict";t.d(e,{submitUGCReport:()=>l,submitUGCReportFx:()=>a});var o=t(32489),i=t(962177),s=t(624761);const l=s.stickersEmojiKeyboard.createEvent(),a=s.stickersEmojiKeyboard.createEffect((_=>{_.cache.clearUGC()}));(0,o.sample)({clock:l,source:i.$api,target:a})},243939:(_,e,t)=>{"use strict";t.d(e,{$userEnv:()=>s,setUserEnv:()=>i});var o=t(624761);const i=o.stickersEmojiKeyboard.createEvent(),s=o.stickersEmojiKeyboard.createStore({}).on(i,((_,e)=>e))},188616:(_,e,t)=>{"use strict";t.d(e,{VKWebAppCustomMessage:()=>o.VKWebAppCustomMessage,getStore:()=>i.getStore});var o=t(712466),i=t(76773)},76773:(_,e,t)=>{"use strict";t.d(e,{getStore:()=>l});var o=t(942451),i=t(32489);function s(){return{onOrdData:(0,i.createDomain)("APPS_CONNECT/VKWebAppCustomMessage").createEvent()}}function l(){return(0,o.makeSharedState)("static/js/modules/shared/apps_connect/handlers/VKWebAppCustomMessage/store.ts",s,{version:0})()}},961019:(_,e,t)=>{"use strict";t.d(e,{default:()=>l});var o=t(942451),i=t(334052),s=t(476726);const l=(0,s.partConfigEnabled)("mini_apps_modal_stack_fix")?new class{initCallback(){window.cur=window.cur||{},window.cur.clearVKMiniAppsLayerPopups=this.clearLayerPopups.bind(this)}get vkMiniAppsStack(){return(0,o.makeSharedState)("MiniAppsModalsStack",(()=>[]),{version:0})()}get modalCount(){return this.vkMiniAppsStack.length}push(_){_.init(),0===this.modalCount&&_.show(),this.vkMiniAppsStack.push(_)}clearLayerPopups(){if(this.modalCount>0){const _=this.vkMiniAppsStack.filter((_=>"appNode"in _&&!_.appNode.id.includes("container_layer")));this.vkMiniAppsStack.splice(0,this.modalCount),this.vkMiniAppsStack.push(..._)}}pop(_){const e=this.vkMiniAppsStack.indexOf(_);-1!==e&&(this.vkMiniAppsStack.splice(e,1),this.checkForNext())}shift(){this.vkMiniAppsStack.shift(),this.checkForNext()}checkForNext(){this.modalCount>0&&this.vkMiniAppsStack[0].show()}constructor(){this.initCallback()}}:new i.ModalStackOld},858723:(_,e,t)=>{"use strict";t.d(e,{BestFriendsEventType:()=>o,sendBestFriendsAnalytic:()=>l});var o,i=t(490712),s=t(476726);function l(_,e){const t={event_type:_,nav_screen:e||window.cur.module};(0,s.partConfigEnabled)("best_friends_analytics_log")&&console.log(t),(0,i.statlogsValueEvent)("best_friends_product_analytic",t)}!function(_){_.addFriendsFromChat="add_friends_from_chat",_.clear="clear",_.moreChats="more_chats",_.selectFriendFromSearch="select_friend_from_search",_.selectChatFromSearch="select_chat_from_search",_.saveBestFriendsList="save_best_friends_list",_.updatePopupSave="update_popup_save",_.updatePopupCancel="update_popup_cancel",_.createPostFromPopupBest="create_post_from_popup_best",_.createPostFromPopupFriends="create_post_from_popup_friends",_.clickToLockFriends="click_to_lock_friends",_.clickToLockBestFriends="click_to_lock_best_friends",_.editBestFriendsFromPopup="edit_best_friends_from_popup",_.editBestFriends="edit_best_friends",_.selectBestFriends="select_best_friends",_.clickToBestFriendsEntrypoint="click_to_best_friends_entrypoint"}(o||(o={}))},650164:(_,e,t)=>{"use strict";t.d(e,{preservePositionBetween:()=>s});var o=t(226095),i=t(8520);function s(_,{scrollByImpl:e=window.scrollBy}={}){let t=_;return{start:(0,i.once)((function(_){_&&(t=_);const s=(0,o.getElementOffset)(t);return(0,i.once)((function(_){if(_&&(t=_),t.isConnected){const _=(0,o.getElementOffset)(t);e(0,_.top-s.top)}}))}))}}},645084:(_,e,t)=>{"use strict";t.d(e,{isPostingStatsEnabled:()=>l,sendPostingEvent:()=>a});var o=t(490712),i=t(909668),s=t(476726);const l=()=>(0,s.partConfigEnabled)("posting_web_input_stats"),a=_=>{l()&&(0,o.statlogsValueEvent)(i.POSTING_STATS_NAME,"",_)}},777901:(_,e,t)=>{"use strict";t.d(e,{feedCommentsSortTabClickCollector:()=>s});var o=t(695290),i=t(581903);const s=new class{logEvent(_,e){const t={...this.productionStatCollector.getBaseEvent(_.ref),type:o.ClickProductionStatEventTypes.TYPE_FEED_COMMENTS_SORT_TAB_CLICK,[o.ClickProductionStatEventTypes.TYPE_FEED_COMMENTS_SORT_TAB_CLICK]:_};this.clickStatCollector.logEvent(t,e)}constructor(){this.productionStatCollector=new i.ProductionStatCollector,this.clickStatCollector=new i.ClickStatCollector(this.productionStatCollector)}}},699742:(_,e,t)=>{"use strict";t.d(e,{PostingItemStatCollector:()=>s});var o=t(695290),i=t(581903);class s{logEvent(_){const e={type:o.ClickProductionStatEventTypes.TYPE_POSTING_ITEM,[o.ClickProductionStatEventTypes.TYPE_POSTING_ITEM]:_},t={type:o.EventItemType.POST};this.clickStatCollector.logEvent(e,t)}constructor(){this.productStatCollector=new i.ProductionStatCollector,this.clickStatCollector=new i.ClickStatCollector(this.productStatCollector)}}},946709:(_,e,t)=>{"use strict";t.d(e,{checkIfVideoShouldBeLoadedAsClip:()=>w,checkStopActionOnEventOnShortVideo:()=>P,formatNumberTranslation:()=>O,getThumb:()=>p,hashtagReplaceReact:()=>c,isLockedVideo:()=>u,transformChallengePinnedItems:()=>b});var o=t(474848),i=t(8520),s=t(765668),l=t(112268),a=t(674508),n=t(610989),r=t(705744),d=t(423212),E=t(476726);function c(_,e,t){return(0,o.jsx)(s.Link,{href:`/clips/hashtag/${encodeURIComponent(e.slice(1))}`,onClick:t,"data-testid":"hashtag",children:e},_)}function p(_,e,t){const o=_.filter((_=>!_.with_padding)),s=t&&(0,i.isRetina)()?2:1,l=((0,i.isNumber)(e)?e:e.width||0)*s,a=((0,i.isNumber)(e)?0:e.height||0)*s;return(0,i.getPhotoSize)(o.length?o:_,l,a)?.url}function u(_,e){return Boolean(e?.userIsAdmin)&&Boolean(_.privacyView&&!function(_){return function(_,e){return!_.category||!e.length||e.includes(_.category)}(_,["all","any"])&&0===(_?.excludedCategory?.length||0)&&0===(_?.lists?.allowed?.length||0)&&0===(_?.lists?.excluded?.length||0)&&0===(_?.owners?.allowed?.length||0)&&0===(_?.owners?.excluded?.length||0)}(_.privacyView))}const P=_=>{const e=_?.target,t=new RegExp(`^https?:\\/\\/${r.VK_HOST_REGEX_UNSAFE.source}\\/clip(-?\\d+_\\d+)$`);return!!e?.href&&t.test(e.href)};function b(_){const e=new Map,t=[];return _?.forEach((_=>{const o=(0,l.joinRawId)({ownerId:_.video?.owner_id??0,itemId:_.video?.id??0});t.push(o),_.label&&e.set(o,_.label)})),{idToLabel:e,pinnedItems:t}}function O(_,e){return`${(0,a.formatCount)(_)} ${(0,n.langNumeric)(_>=1e3?1e3:_,e)}`}const D=1,M=60;async function w(_,e){if(e?.is_closed)return!1;const t=await(0,d.getVideoMetadata)(_),o=(0,E.getConfigValue)("short_video_publish_video_to_clips_duration_min")??D,i=(0,E.getConfigValue)("short_video_publish_video_to_clips_duration_max")??M;return null!==t&&t.duration<i&&t.duration>o&&t.height>=t.width}},957081:(_,e,t)=>{"use strict";t.d(e,{STICKERS_CONFDATA_KEY:()=>o,isNewStickerPicker:()=>s,isPromoVmojiCounterEnabled:()=>a,isUGCStickersEnabled:()=>l});var o,i=t(476726);function s(){return(0,i.partConfigEnabled)("new_sticker_picker")}function l(){return(0,i.partConfigEnabled)("stickers.ugc")}function a(){return(0,i.partConfigEnabled)("vmoji.promo.avatar_suggestion.promo_counter")}!function(_){_.UGC="stickers.ugc",_.PROMO_VMOJI_COUNTER="vmoji.promo.avatar_suggestion.promo_counter",_.NEW_STICKER_PICKER="new_sticker_picker"}(o||(o={}))},524258:(_,e,t)=>{"use strict";t.d(e,{POPUP_STICKER_CLASS:()=>s,POPUP_STICKER_ICON_CLASS:()=>l,POPUP_STICKER_ICON_CLASS_ANIMATED:()=>a,POPUP_STICKER_ICON_CLASS_ROTATED:()=>n,POPUP_STICKER_WRAPPER_CLASS:()=>o,POPUP_STICKER_WRAPPER_CLASS_ANIMATION_IS_PLAYING:()=>i,STICKER_CLASS:()=>r,StickersSettingsApiMethods:()=>d});const o="popupStickerWrapper",i="popupStickerWrapperAnimationIsPlaying",s="popupSticker",l="popupStickerIcon",a="popupStickerIconAnimated",n="popupStickerIconRotated",r="stickerImageWrapper",d={getSettings:"stickers.getSettings",setPopupSettings:"stickers.setPopupSettings"}},405504:(_,e,t)=>{"use strict";function o(_){try{_.offsetWidth,_.offsetHeight}catch(_){}}t.d(e,{reflow:()=>o})},769876:(_,e,t)=>{"use strict";t.d(e,{CLIP_UPLOAD_MAX_FILE_SIZE_IN_GB:()=>r,SHORT_VIDEO_UPLOAD_EXTS:()=>i,SHORT_VIDEO_UPLOAD_INPUT_ACCEPT:()=>l,VIDEO_DEFAULT_THUMB_ID:()=>P,VIDEO_UPLOAD_CHUNK_MAX_RETRY_NUMBER:()=>c,VIDEO_UPLOAD_CHUNK_SIZE:()=>d,VIDEO_UPLOAD_EXTS:()=>s,VIDEO_UPLOAD_FILE_THREAD_NUMBER:()=>E,VIDEO_UPLOAD_INPUT_ACCEPT:()=>a,VIDEO_UPLOAD_MAX_FILE_SIZE_IN_GB:()=>n,VIDEO_UPLOAD_SUBTITLES_DISABLED:()=>p,VIDEO_UPLOAD_SUBTITLES_USER_LANG:()=>u});const o=_=>["video/*",..._.map((_=>`.${_}`))].join(","),i="avi mp4 3gp mpeg mov flv f4v wmv mkv webm vob rm rmvb m4v mpg ogv ts m2ts mts mxf".split(" "),s=[...i,"torrent"],l=o(i),a=o(s),n=5,r=8,d=4194304,E=4,c=10,p=-1,u=-2,P="0_0"},423212:(_,e,t)=>{"use strict";t.d(e,{checkFileType:()=>d,getUploadErrorInfo:()=>c,getUploadErrorText:()=>E,getVideoMetadata:()=>n,getVideoSize:()=>r,sendVideoMetadataStatsBeforeUpload:()=>p});var o,i=t(610989),s=t(769876),l=t(581903),a=t(695290);function n(_){return new Promise((e=>{try{const t=document.createElement("video");t.preload="metadata",t.onloadedmetadata=()=>{const _=t.duration||0,o=t.videoWidth,i=t.videoHeight;e({duration:_,width:o,height:i})},t.onerror=()=>e(null),t.src=window.URL.createObjectURL(_)}catch(_){e(null)}}))}function r(_){return _.size}function d(_,e){const t=(_.name.split(".").pop()||"").toLowerCase(),o=(e||s.VIDEO_UPLOAD_EXTS).includes(t);return!!(_.type&&_.type.match(/^video/i)||o)}function E(_,e){switch(_){case 100:return i.getLang("video_upload_encode_error_too_short_1s");case 101:return i.getLang("video_upload_encode_error_too_long");case 20:return i.getLang("video_upload_error_uploading");case-1:return i.getLang("video_upload_error_incorrect_publish_date");case-2:return i.getLang("video_upload_error_limit_postpone_posts");case-3:return i.getLang("video_upload_error_day_limit_postpone_posts");case-4:return i.getLang("video_upload_error_same_publish_date");case-5:return i.getLang("video_upload_error_day_limit_posts");default:return e||i.getLang("global_unknown_error")}}function c(_){switch(_){case-2:return i.getLang("video_upload_error_info_limit_postpone_posts");case-3:return i.getLang("video_upload_error_info_day_limit_postpone_posts");case-4:return i.getLang("video_upload_error_info_same_publish_date")}}!function(_){_[_.SHORT_VIDEO_TOO_SHORT=100]="SHORT_VIDEO_TOO_SHORT",_[_.SHORT_VIDEO_TOO_LONG=101]="SHORT_VIDEO_TOO_LONG",_[_.INCORRECT_PUBLISH_DATE=-1]="INCORRECT_PUBLISH_DATE",_[_.LIMIT_POSTPONE_POSTS=-2]="LIMIT_POSTPONE_POSTS",_[_.LIMIT_POSTPONE_POSTS_PER_DAY=-3]="LIMIT_POSTPONE_POSTS_PER_DAY",_[_.SAME_POSTPONE_POST_DATE=-4]="SAME_POSTPONE_POST_DATE",_[_.LIMIT_POSTS_PER_DAY=-5]="LIMIT_POSTS_PER_DAY",_[_.SHORT_VIDEO_CONVERT=20]="SHORT_VIDEO_CONVERT"}(o||(o={}));const p=async(_,e,t)=>{const o=await n(_);o?.duration&&o?.width&&l.videoUploadStatsCollector.logEvent({event_type:a.VideoUploadActionEventTypes.DECODE_VIDEO_METAINFO,video_owner_id:e,video_id:t,decode_metainfo:JSON.stringify({width:o.width,height:o.height,video_duration:o.duration,format:(_.name.split(".").pop()||"").toLowerCase()})})}},194440:(_,e,t)=>{"use strict";t.d(e,{buildBadgesStackHtml:()=>c,buildHtmlAttributesString:()=>d,getBadgeImage:()=>r,getBadgesPlacementInPostActionStatusBarToUpdate:()=>E,openHelpPage:()=>u,updateNewPostHTMLForBadges:()=>p});var o=t(879007),i=t(858237),s=t(216147),l=t(610989),a=t(545284),n=t(400066);function r(_,e,t=!1){const{base_url:i,version:s}=_,l=s?`?${s}`:"";return!t&&(0,o.isRetina)()&&(e*=2),`${i}/${e}.png${l}`}const d=_=>Object.entries(_).reduce(((_,[e,t])=>{if(t){_+=` ${e}="${(0,o.escapeAttr)(String(t))}"`}return _}),""),E=(_,e,t)=>{const o={place:void 0},s=_.querySelector(`._like_wall${e}_${t}`);if(!s)return(0,i.badgesLogger)("Нет кнопки лайка"),o;const l=s.parentNode?.querySelector(".PostActionStatusBar");if(!l)return(0,i.badgesLogger)("Нет .PostActionStatusBar"),o;const a=l.querySelector(".BadgesStatusBar__badgesSendButton"),n=l.querySelector(".BadgesStack");return a||n?a?(o.element=a,o.place="button",o):(o.element=n,o.place="stack",o):((0,i.badgesLogger)('Нет ни стака значков, ни кнопки "Подарить"'),o)},c=({counters:_,badges:e,tqAttributes:t,withContainer:i,withLabel:a})=>{let n=0,r=0,E="";const c=s.colorScheme.isDarkScheme();if((_||[]).forEach((({type:_,badge_id:t,value:i})=>{if("total"===_)n=i;else if("badge"===_&&t&&r<3){r++;const _=e?.find((_=>_.id===t));if(_){const{image:e}=_,t=(0,o.isRetina)()?"stack28_light_2x.png":"stack28_light.png",i=(0,o.isRetina)()?"stack28_dark_2x.png":"stack28_dark.png",s=e.version?`?${e.version}`:"",l=`${e.base_url}/${t}${s}`,a=`${e.base_url}/${i}${s}`,n=d({src:c?a:l,class:"BadgesStackItem BadgesStack__item",alt:_.alt_text||"","data-src-light":l,"data-src-dark":a});E+=`<img ${n}>`}}})),n>0&&E){const _=a?l.getLang("groups_have_donuts_total",n):l.getLang("groups_wkview_donuts_total",n);let e=`\n      <div class="BadgesStack__inner" ${t}>\n        <div class="BadgesStack__items">${E}</div>\n        <span class="BadgesStack__counter">${_}</span>\n      </div>\n    `;if(i){e=`\n        <div data-tooltip-container="true" id="badges_stack" class="BadgesStack" ${"data-exec='{\"BadgesStack/init\":[]}'"}>\n          ${e}\n        </div>\n      `}return e}return""},p=(_,e,t)=>{const o=t[2],[i,s]=o.split("_"),l=e?.wallTpl?.send_badge,r={};return(0,n.isBadgesEnabled)()&&l&&(_.push(l),Object.assign(r,{badges_object_id:s,badges_object_owner_id:i,badges_object_type:a.BadgesObjectType.WALL,badges_event_ref:a.BadgesEventRef.POST_BTN})),r},u=()=>{window.open(a.LINK_TO_HELP_FOR_AUTHORS,"_blank")}},858237:(_,e,t)=>{"use strict";t.d(e,{badgesLogger:()=>i});var o=t(568352);const i=(_,e)=>{window.vk.dev&&console.log(e),(0,o.logError)(new Error(_),{environment:"badges"})}},400066:(_,e,t)=>{"use strict";t.d(e,{isBadgesEnabled:()=>i,isBadgesRenderingEnabled:()=>s});var o=t(476726);const i=()=>(0,o.partConfigEnabled)("badges"),s=()=>(0,o.partConfigEnabled)("badges_rendering")},263425:(_,e,t)=>{"use strict";t.d(e,{getPrimaryCarouselGallery:()=>i});var o=t(946076);function i(_){const e=_.closest(`.${o.UI_GALLERY_CLASSNAME}`);if(!e)return;const t=(0,o.uiGetGallery)(e);return t||void 0}},117855:(_,e,t)=>{"use strict";t.d(e,{AttachmentsViewSelector:()=>d});var o=t(898971),i=t(317412),s=t(499048),l=t(909668),a=t(699742),n=t(8520);const r=new a.PostingItemStatCollector;class d{setMediaSelectedValue(_){this.addMedia.setAttachView(_)}createTooltip(){const _=this.selectorEl.querySelector(".post_action_tt_content"),e=this.selectorEl.querySelector(".post_action_btn_layout");if(!_||!e)return;const t=(0,o.createPostTooltip)(s.ACTION_BUTTON_ID,this.linkId,void 0,{customShow:!0})?.toooltip;return t&&((0,i.addEvent)(e,"click",(()=>{this._isEnabled&&t.toggle()})),this.selectorEl.querySelectorAll(".radiobtn").forEach((_=>{(0,i.addEvent)(_,"click",this.handleOptionClick.bind(this))}))),t}handleOptionClick(_){if(!(_.currentTarget instanceof HTMLElement))return;const e=_.currentTarget.getAttribute("data-value");if(this.tooltip?.hide(),e){this.setMediaSelectedValue(e),this.selectOption(e);const _=l.ATTACH_VIEW_EVENTS[e];_&&r.logEvent({primary_mode_event:{primary_mode_event_type:_}})}}updateTooltipRadioBtn(_,e){(0,o.updatePostTooltipActionRadioBtn)(_,e,`post_settings_btn${s.ACTION_BUTTON_ID}${this.linkId}`)}updateActionButtonText(_,e){if(e){const t=(0,n.decodeHTMLEntities)(e);_.innerHTML=t,_.setAttribute("aria-label",t)}}selectOption(_){const e=this.selectorEl.querySelector(`[data-value="${_}"]`),t=this.selectorEl.querySelector(".post_action_btn_text");if(!(e instanceof HTMLElement&&t instanceof HTMLElement))return;this.updateTooltipRadioBtn(e,_);const o=e.getAttribute("aria-label")||"";this.updateActionButtonText(t,o)}isHidden(){return this._isHidden}setVisibility(_){let e=_;this._forceHidden&&(e=!1),this.selectorEl.style.display=e?"":"none",this._isHidden=!_}isEnabled(){return this._isEnabled}setEnabled(_){_?this.selectorEl.classList.remove(s.ACTION_BUTTON_DISABLED):this.selectorEl.classList.add(s.ACTION_BUTTON_DISABLED),this._isEnabled=_}constructor(_,e,t,o,i={isHidden:!0,isEnabled:!1,forceHidden:!1}){this.linkId=e,this.selectorEl=t,this.tooltip=this.createTooltip(),this.addMedia=_,this._forceHidden=i.forceHidden,this.selectOption(o),this.setVisibility(!i.isHidden),this.setEnabled(i.isEnabled),this.setMediaSelectedValue(o)}}},511714:(_,e,t)=>{"use strict";t.d(e,{initAttachmentsViewSelector:()=>s});var o=t(117855),i=t(740328);const s=({linkId:_,postActionsEl:e,addMedia:t,initValue:s,isGridOnly:l,isCarouselOnly:a})=>{if(!(e instanceof HTMLElement))return;const n=(0,i.renderTemplate)("primary_attachments_view_template",{link_id:_});if(!n)return;const r=e.querySelector(".post_postpone")||e.querySelector(".PostDonutDuration")||e.querySelector(".post_available");r?r.parentNode?.insertBefore(n,r.nextSibling):e.insertBefore(n,e.firstChild);const d=new o.AttachmentsViewSelector(t,_,n,s??(0,i.getAttachmentsPrimaryModeDefaultValue)(),{isHidden:!0,isEnabled:!1,forceHidden:Boolean(l||a)}),E=_=>{_?(d.setVisibility(!0),d.setEnabled(!0)):d.setVisibility(!1)};return E(t.getMediaUIViewSelectorAvailable()),t.emitter.on(t.eventTypes.previewUpdate,E),t.emitter.on(t.eventTypes.viewDraw,E),{setOption:_=>{d.selectOption(_)},onClear:()=>{d.setVisibility(!1)}}}},740328:(_,e,t)=>{"use strict";t.d(e,{getAttachmentsPrimaryModeDefaultValue:()=>u,getAttachmentsPrimaryModeParam:()=>d,renderTemplate:()=>r,saveAttachmentsPrimaryModeDefaultValue:()=>p});var o=t(499048),i=t(879007),s=t(452314),l=t(250682),a=t(476726),n=t(964032);const r=(_,e)=>{const t=(0,i.getTemplate)(_,e);return t?(0,s.se)(t):null},d=_=>{const e=document.getElementById(`${o.ACTION_BUTTON_ID}${_}`);if(e?.classList.contains(o.ACTION_BUTTON_DISABLED))return;const t=e?.querySelector(".radiobtn.on")?.getAttribute("data-value");return t?{primary_attachments_mode:t}:void 0},E="posting_attachments_primary_mode_default_value",c=()=>`${E}_${window.vk.id}`,p=_=>{(0,a.partConfigEnabled)("content_multiaccount_web_feature")?l.ls.set(c(),_):l.ls.set(E,_)},u=_=>{if(_?.isCarouselOnly)return o.ATTACHMENT_PRIMARY_MODE.carousel;if(_?.isGridOnly)return o.ATTACHMENT_PRIMARY_MODE.grid;const e=(0,a.partConfigEnabled)("attachments_primary_mode_web_carousel_default_feature")||(0,n.isCarouselCropEnabled)()?o.ATTACHMENT_PRIMARY_MODE.carousel:o.ATTACHMENT_PRIMARY_MODE.grid;let t;return t=(0,a.partConfigEnabled)("content_multiaccount_web_feature")?l.ls.get(c())??l.ls.get(E)??e:l.ls.get(E)??e,o.ATTACHMENT_PRIMARY_MODE[t]??e}},145309:(_,e,t)=>{"use strict";t.d(e,{getPostTopicSelectorParams:()=>i.getPostTopicSelectorParams,initPostTopicCreatingSelector:()=>r,initPostTopicEditingSelector:()=>d,isPostTopicEditingEnabled:()=>i.isPostTopicEditingEnabled,isPostTopicSettingEnabled:()=>i.isPostTopicSettingEnabled,topicUISelectorHide:()=>a.topicUISelectorHide});var o=t(830961),i=t(703083),s=t(21379),l=t(315654),a=t(663535);const n=(_,e,t,i)=>{const a=o.TopicUISelector.create(e,{linkId:_,selectTopicId:s.selectTopicId});if(a)return(0,s.initActionsParamsState)(_,a,i),a.selectTopicId(t[l.WallPostParams.topicId]),{clearSelection:()=>{a.clearSelection()},onDestroy:()=>{a.destroy()}}},r=(_,e,t)=>n(_,e,{[l.WallPostParams.topicId]:i.TOPIC_ID_NONE},t),d=(_,e,t,o)=>n(_,e,{[l.WallPostParams.topicId]:t[l.WallPostParams.topicId]??i.TOPIC_ID_NONE},o)},315654:(_,e,t)=>{"use strict";var o;t.d(e,{WallPostParams:()=>o}),function(_){_.topicId="topic_id"}(o||(o={}))},21379:(_,e,t)=>{"use strict";t.d(e,{getActionParams:()=>a,getSelectorRegistry:()=>s,initActionsParamsState:()=>l,selectTopicId:()=>r});var o=t(315654);let i=new Map;const s=_=>i.get(_),l=(_,e,t)=>((_,e)=>i.set(_,e))(_,{actionParams:void 0,selector:e,onChange:t}),a=_=>i.get(_)?.actionParams,n=(_,e)=>{((_,e)=>{const t=i.get(_);void 0!==t&&i.set(_,e(t))})(_,(_=>(_?.onChange&&_.onChange(e?.topic_id),{..._,actionParams:e})))},r=(_,e)=>{n(_,{[o.WallPostParams.topicId]:e})}},703083:(_,e,t)=>{"use strict";t.d(e,{TOPIC_ID_NONE:()=>s,getPostTopicSelectorParams:()=>l,isPostTopicEditingEnabled:()=>n,isPostTopicSettingEnabled:()=>a});var o=t(315654),i=t(21379);const s=-1,l=_=>{const e=(0,i.getActionParams)(_)?.[o.WallPostParams.topicId];return void 0!==e&&e!==s?{[o.WallPostParams.topicId]:e}:void 0},a=_=>!0===_?.wallPostTopicSettingEnabled,n=_=>void 0!==_.topic_options},830961:(_,e,t)=>{"use strict";t.d(e,{TopicUISelector:()=>E});var o=t(96526),i=t(452314),s=t(317412),l=t(663535),a=t(703083),n=t(7144),r=t(226095),d=t(898971);class E{static create(_,e){const t=(0,l.renderSelector)(_,e.linkId);if(!t)return;const o=this.getSelectorContentEl(t),s=(0,i.domQuery1)(".post_action_btn_layout",t);return o&&s?new E(s,t,e,o):void 0}static getSelectorContentEl(_){return(0,i.domQuery1)(".post_action_tt_content",_)}destroy(){this.tooltip.destroy(),delete window.radioBtns[this.radioBtnId]}tooltipHide(){this.tooltip.hide()}selectTopicId(_){this.options.selectTopicId(this.linkId,_),this.updateViewForSelectedTopic({isTopicSelected:_!==a.TOPIC_ID_NONE,topicId:_})}clearSelection(){this.selectTopicId(a.TOPIC_ID_NONE)}updateViewForSelectedTopic({isTopicSelected:_,topicId:e}){const t=E.getSelectOptionEl(this.containerEl,e),o=t&&(0,r.getJsonDataValue)(t,"data-click-params"),s=(0,i.domQuery1)(".post_action_btn_text",this.containerEl);if(!t||!o||!s)return;const{label:a}=o;(0,d.updatePostTooltipActionRadioBtn)(t,void 0,(0,l.getTooltipId)(this.options.linkId));const c=s.getAttribute("data-empty")||"",p=_?a:c;s.innerHTML=p,s.setAttribute("aria-label",(0,n.replaceEntities)(p)),(0,i.toggleClass)(this.containerEl,"on",_)}static getSelectOptionEl(_,e){return(0,i.domQuery1)(`[data-value="${e}"]`,_)}constructor(_,e,t,a){this.btnEl=_,this.containerEl=e,this.options=t,this.selectorContentEl=a,this.onOptionClickWrapper=(..._)=>{this.tooltip.hide();const e=_[0].currentTarget;if(!(e instanceof HTMLElement))return;const t=(0,r.getJsonDataValue)(e,"data-click-params");t&&this.selectTopicId(t.value)},this.linkId=this.options.linkId,this.radioBtnId=(0,l.getTooltipId)(this.options.linkId),window.radioBtns[this.radioBtnId]={val:!1,els:a.children},this.tooltip=new o.ElementTooltip(_,{appendTo:e,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:[-12*(window.vk.rtl?-1:1),7],content:a,align:"left",onFirstTimeShow:()=>{(0,i.show)(a)}}),(0,i.domQuery)('[data-onclick="togglePostTopic"]',e).forEach((_=>{(0,s.addEvent)(_,"click",this.onOptionClickWrapper)}))}}},663535:(_,e,t)=>{"use strict";t.d(e,{getTooltipId:()=>l,renderSelector:()=>a,topicUISelectorHide:()=>n});var o=t(452314),i=t(879007),s=t(21379);const l=_=>`post_discover_category_btn${_}`,a=(_,e)=>{const t=(_=>{const e=(0,i.getTemplate)("postCategorySelect",_);return e?(0,o.se)(e):null})({link_id:String(e)});if(_ instanceof HTMLElement&&t instanceof HTMLElement)return _.appendChild(t),t},n=_=>{(0,s.getSelectorRegistry)(_)?.selector?.tooltipHide()}},919514:(_,e,t)=>{"use strict";t.d(e,{TOOLTIP_SUCCESS_EVENT:()=>i,TooltipEventService:()=>s});var o=t(948616);const i="group_tooltip_success_event",s={onUploadAvatar:()=>{window.dispatchEvent(new CustomEvent(i,{detail:o.OnboardingTooltipIds.Avatar}))},onUploadCover:()=>{window.dispatchEvent(new CustomEvent(i,{detail:o.OnboardingTooltipIds.Cover}))},onAddPost:()=>{window.dispatchEvent(new CustomEvent(i,{detail:o.OnboardingTooltipIds.Post}))},onAddMarketItem:()=>{window.dispatchEvent(new CustomEvent(i,{detail:o.OnboardingTooltipIds.MarketItem}))},onAddServiceItem:()=>{window.dispatchEvent(new CustomEvent(i,{detail:o.OnboardingTooltipIds.ServiceItem}))}}},948616:(_,e,t)=>{"use strict";var o;t.d(e,{OnboardingTooltipIds:()=>o}),function(_){_.Avatar="business_groups_web:avatar",_.Cover="business_groups_web:cover",_.ActionButton="business_groups_web:action_button",_.MarketItem="business_groups_web:add_item",_.ServiceItem="business_groups_web:add_service",_.Post="business_groups_web:make_post",_.Dov="business_groups_web:fill_dov",_.Trigger="business_groups_web:ui_trigger"}(o||(o={}))},155207:(_,e,t)=>{"use strict";t.d(e,{sendExpandStats:()=>a});var o=t(681589),i=t(695290),s=t(782784),l=t(468189);function a(_){if(!_)return;const e=(0,o.getTrackCodeFromPost)(_);s.feedInteractionItemStatCollector.logEvent({track_code:e??void 0,ref:(0,o.resolveRefFromCur)(),item:(0,l.getFeedInteractionItemType)()},i.EventItemType.EXPAND)}},837542:(_,e,t)=>{"use strict";t.d(e,{stripPercentVars:()=>o});const o=_=>_.replace(/%[-\w]+%/g,"")},630298:(_,e,t)=>{"use strict";function o(_){const e=_.match(/^([a-z_]+)([0-9\-_]+)$/);if(!e)return null;const[,t,o]=e;return{objectType:t,objectId:o}}t.d(e,{getElementLikeButtonCount:()=>a,getElementLikeButtonIcon:()=>n,getElementLikeButtonLabel:()=>r,isObjectTypeIsVideo:()=>l,likePostObjectId:()=>i,likeReplyObjectId:()=>s,parseLikeObjectId:()=>o});const i=_=>`wall${_}`,s=_=>`wall_reply${_}`,l=_=>["video","video_comment"].includes(_),a=_=>_?.querySelector(".like_button_count, ._like_button_count")??void 0,n=_=>_?.querySelector(".like_button_icon, ._like_button_icon")??void 0,r=_=>_.querySelector(".like_button_label, ._like_button_label")??void 0},906357:(_,e,t)=>{"use strict";t.d(e,{handleOrdMiniappOpen:()=>r});var o=t(422109),i=t(340257),s=t(610989),l=t(188616),a=t(659179),n=t(51963);const r=(_,e,t,r)=>{const d=r?{..._,service:r}:_,E=d?(0,o.objectToQuerystring)(d,"#"):"",c=(0,l.getStore)().onOrdData.watch((o=>{t?.isSnackbar&&(o?.is_ad&&!_?.is_ad?(0,a.showSnackbar)({text:s.getLang("global_ads_wall_post_ord_mark_as_ads_added"),timeout:3e3,type:"ok28"}):!o?.is_ad&&_?.is_ad&&(0,a.showSnackbar)({text:s.getLang("global_ads_wall_post_ord_mark_as_ads_removed"),timeout:3e3,type:"loudspeaker28"})),e(o,t?.ref),c()}));t=t||{};const p={...t,options:{...t.options||{}}},{onDestroy:u,onLoaded:P}=p.options;p.options.asBox?p.options.onDestroy=(..._)=>{u?.(..._),c()}:p.options.onLoaded=(..._)=>{P?.(..._),(0,n.addWkViewHideQueue)((()=>c()))},window.showWiki?.({w:`app${i.ORD_APP_ID}${E}`},p?.edit,p?.ev,p?.options)}},214249:(_,e,t)=>{"use strict";t.d(e,{PostponedPosts:()=>u,isPostponedPostsActResult:()=>M,isPostponedPostsFixEnabled:()=>O,isPostponedPostsPaginationEnabled:()=>P,isPostponedPostsParallelLoadingEnabled:()=>b,isPostponedPostsUpdateEnabled:()=>D});var o=t(624216),i=t(476726),s=t(171444),l=t(287841),a=t(610989),n=t(7144),r=t(268915),d=t(592541),E=t(987046);function c(_){return new Promise(((e,t)=>{o.ajax.post("al_wall.php",{act:"get_postponed",..._},{onDone:_=>{e(_)},onFail:_=>{t(_)},local:1})}))}function p(_){const e=document.querySelector("#page_postponed_posts");e&&e.insertAdjacentHTML("beforeend",_)}class u{setLock(_){this.lock=_,this.lock?this.showMoreButton.lock():this.showMoreButton.unlock()}static new(){return new u}getPostsSize(){return this.postsSize}isLocked(){return this.lock}updateState(_){Object.assign(this,_)}toggleSort(){this.sort="sort_desc"===this.sort?"sort_asc":"sort_desc"}canStartInitialLoading(){const _=document.querySelector("#page_postponed_posts");return 0===this.offset||""===_?.innerHTML.trim()}areAllPostsLoaded(){return this.offset>=this.postsSize}getNextPosts(){this.setLock(!0),c({offset:this.offset,owner_id:this.ownerId,sort:this.sort}).then((_=>{p(_.rendered_posts),this.offset=this.offset+this.limit,this.restoreLoadingState()})).catch((()=>{this.restoreLoadingState()}))}initPaginationAndShowMoreButton(){this.areAllPostsLoaded()||(this.showMoreButton.renderInWallModule(),P()&&this.paginate())}paginationHandler(){const{scrollTop:_,scrollHeight:e,clientHeight:t}=document.documentElement;_+t>=(this.offset<2*this.limit?0:e/2)&&!this.areAllPostsLoaded()&&!this.lock&&this.getNextPosts()}destroyPagination(){window.removeEventListener("scroll",this.throttledPaginationHandler)}paginate(){return window.addEventListener("scroll",this.throttledPaginationHandler,{passive:!0}),(0,s.pushNavDestroy)(this.destroyPagination.bind(this)),this.destroyPagination}removePost(){this.postsSize-=1,this.offset-=1}restorePost(){this.postsSize+=1,this.offset+=1}cleanUp(){this.destroyPagination(),this.showMoreButton.remove()}cleanUpOnNavigation(){this.cleanUp(),this.makeInitialState()}makeInitialState(){this.offset=0,this.postsSize=0,this.lock=!1,this.ownerId=0,this.limit=0,this.sort="sort_asc"}restoreLoadingState(){this.setLock(!1),this.areAllPostsLoaded()&&(this.showMoreButton.remove(),this.destroyPagination())}chunkedPostponedPostRequests(_=0){return(0,E.rangeWithStep)(this.limit,this.postsSize,_).map((_=>c({offset:_,owner_id:window.cur.oid??0,sort:this.sort})))}loadInParallel(_,{onLoaded:e,onError:t},o){this.setLock(!0),(0,d.trackStartWithMarkName)(d.POSTPONED_POSTS_PARALLEL_LOADING_MARK);const i=this.chunkedPostponedPostRequests(_);Promise.all(i).then((_=>{const t=(0,d.trackEndWithMarkName)(d.POSTPONED_POSTS_PARALLEL_LOADING_MARK),i=_.map((_=>_.rendered_posts)).reduce(((_,e)=>_+e),""),s=_?.[0]?.count,l=_?.[0]?.limit;(0,d.saveLoadingStats)(d.POSTPONED_STATS_KEY,t.duration,{type:"parallel",action:o?"after_posting":"just_loading",offset:this.offset,limit:l,postsSize:s,userId:window.cur.oid??0,hasError:!1}),this.offset=s,this.limit=l,this.postsSize=s,this.restoreLoadingState();e({count:s,limit:l,rendered_posts:i})})).catch((_=>{this.restoreLoadingState();const e=(0,d.trackEndWithMarkName)(d.POSTPONED_POSTS_PARALLEL_LOADING_MARK),i=(0,d.getErrorMessage)(_);(0,d.saveLoadingStats)(d.POSTPONED_STATS_KEY,e.duration,{type:"parallel",action:o?"after_posting":"just_loading",offset:this.offset,limit:this.limit,postsSize:this.postsSize,userId:window.cur.oid??0,hasError:!1,errorMessage:i}),t?.(_)}))}loadInitialForPagination({onLoaded:_,onError:e}){this.setLock(!0),c({offset:0,owner_id:window.cur.oid??0,sort:this.sort}).then((e=>{_(e),this.postsSize=e.count,this.offset=e.limit,this.ownerId=window.cur.oid??0,this.limit=e.limit,this.initPaginationAndShowMoreButton(),this.restoreLoadingState()})).catch((_=>{e?.(_),this.restoreLoadingState()}))}loadOnTabReturn(){this.initPaginationAndShowMoreButton()}loadAfterPosting(_){this.postsSize=_.count,this.limit=_.limit,this.offset=_.limit,this.ownerId=window.cur.oid??0,this.cleanUp(),this.initPaginationAndShowMoreButton()}loadAllAfterPosting(_){this.cleanUp(),this.areAllPostsLoaded()||(this.initPaginationAndShowMoreButton(),this.loadInParallel(_.starts_from??0,{onLoaded:_=>{p(_.rendered_posts)}},!0))}constructor(){this.throttledPaginationHandler=(0,l.throttle)(this.paginationHandler.bind(this),500).bind(this),this.offset=0,this.postsSize=0,this.lock=!1,this.ownerId=0,this.limit=0,this.sort="sort_asc",this.showMoreButton=r.ShowMoreButton.new(a.getLang("wall_post_text_show_more"),{onClick:this.getNextPosts.bind(this)}),this.destroyPagination=this.destroyPagination.bind(this)}}function P(){return(0,i.partConfigEnabled)("wall_postponed_posts_pagination_web")}function b(){return(0,i.partConfigEnabled)("wall_postponed_posts_parallel_loading_web")}function O(){return P()||b()}function D(){return(0,i.partConfigEnabled)("wall_postponed_posts_update_enabled_web")}function M(_){return!!_&&(!("string"==typeof _||!(0,n.isObject)(_))&&"rendered_posts"in _)}},592541:(_,e,t)=>{"use strict";t.d(e,{POSTPONED_POSTS_PARALLEL_LOADING_MARK:()=>s,POSTPONED_STATS_KEY:()=>i,getErrorMessage:()=>l,saveLoadingStats:()=>a,trackEndWithMarkName:()=>r,trackStartWithMarkName:()=>n});t(490712);var o=t(144770);const i="wall_postponed_posts_stats",s="postponed_posts_parallel_loading_mark";function l(_){return _?"string"==typeof _?_:_ instanceof Error&&_.message?_.message:"Unknown error":"Unknown error"}function a(_,e,t){(0,o.saveStatlogEvents)({name:_,value:e,keys:[t]})}function n(_){window.cur.postponedPostsPerformanceMarks||(window.cur.postponedPostsPerformanceMarks={}),window.cur.postponedPostsPerformanceMarks[_]=performance.now()}function r(_){return window.cur.postponedPostsPerformanceMarks&&window.cur.postponedPostsPerformanceMarks[_]?{duration:performance.now()-+window.cur.postponedPostsPerformanceMarks[_]}:{duration:-1}}},268915:(_,e,t)=>{"use strict";t.d(e,{ShowMoreButton:()=>i});var o=t(258643);class i{static new(_,e){return new i(_,e)}putInContainer(){this.container=document.createElement("div"),this.container.style.display="flex",this.container.style.justifyContent="center",this.container.style.marginBottom="16px",this.container.append(this.button)}lock(){o.FlatButton.lock(this.button)}unlock(){o.FlatButton.unlock(this.button)}remove(){this.container?.remove()}renderInWallModule(){this.container||this.putInContainer();const _=document.querySelector(".wall_module");_?.append(this.container)}constructor(_,{onClick:e}){this.button=o.FlatButton.render({children:_,appearance:o.FlatButtonAppearance.SECONDARY,size:o.FlatButtonSize.M}),this.onClick=e,this.button.addEventListener("click",this.onClick)}}},987046:(_,e,t)=>{"use strict";function o(_,e,t=0){return Array.from(Array(Math.ceil((e-t)/_)).keys()).map((e=>e*_+t))}t.d(e,{rangeWithStep:()=>o})},70517:(_,e,t)=>{"use strict";t.d(e,{getNavigableTabs:()=>i,showHiddenNavigableTabs:()=>s});var o=t(452314);const i=_=>{const e=[],t=document.querySelector("#wall_tabs");return t?Array.from(t.querySelectorAll(".ui_tab")).filter((e=>{const t=e.parentNode;return null!==t&&t!==_&&!(0,o.hasClass)(t,"unshown")&&!(0,o.matchesSelector)(t,'[data-ui-tab="no_posts"]')})):e},s=()=>{const _=document.querySelector("#wall_tabs"),e=_?.querySelector(".page_wall_no_posts");e?.remove(),(0,o.removeClass)(document.querySelector("#wall_tabs"),"page_tabs_hidden")}},7226:(_,e,t)=>{"use strict";t.d(e,{CarouselRatioSelector:()=>u});var o=t(898971),i=t(317412),s=t(853687),l=t(610989),a=t(623702),n=t(741531),r=t(165753),d=t(699742),E=t(417552),c=t(169709);const p=new d.PostingItemStatCollector;class u{setCarouselRatio(_){this.addMedia.setCarouselRatio(_)}createTooltip(){const _=this.selectorEl.querySelector(".post_action_tt_content"),e=this.selectorEl.querySelector(".post_action_btn_layout");if(!_||!e)return;const t=(0,o.createPostTooltip)(s.ACTION_BUTTON_ID,this.linkId,void 0,{customShow:!0,width:s.RATIO_TOOLTIP_WIDTH})?.toooltip;return t&&((0,i.addEvent)(e,"click",(()=>{this._isEnabled&&t.toggle()})),this.selectorEl.querySelectorAll(".radiobtn").forEach((_=>{(0,i.addEvent)(_,"click",this.handleOptionClick.bind(this))}))),t}handleOptionClick(_){if(!(_.currentTarget instanceof HTMLElement))return;const e=_.currentTarget.getAttribute("data-value");this.tooltip?.hide(),e&&(this.setCarouselRatio(Number(e)),this.selectOption(Number(e)),p.logEvent({settings_event:{settings_event_type:E.SettingsEventType.RatioChange}}))}updateTooltipRadioBtn(_,e){(0,o.updatePostTooltipActionRadioBtn)(_,e,`post_settings_btn${s.ACTION_BUTTON_ID}${this.linkId}`)}updateActionButtonText(_,e){e&&(_.innerText=e,_.setAttribute("aria-label",e))}selectOption(_){const e=this.selectorEl.querySelector(`[data-value="${_}"]`),t=this.selectorEl.querySelector(".post_action_btn_text");if(!(e instanceof HTMLElement&&t instanceof HTMLElement))return;this.updateTooltipRadioBtn(e,_);const o=e.getAttribute("aria-label")||"";this.updateActionButtonText(t,o)}isHidden(){return this._isHidden}setVisibility(_){let e=_;this.selectorEl.style.display=e?"":"none",this._isHidden=!_}isEnabled(){return this._isEnabled}setEnabled(_){this.selectorEl.classList.toggle(s.ACTION_BUTTON_DISABLED,!_),this._isEnabled=_}showHintTooltip(_){if((0,n.ensureAccountHelpHintsService)().canShow(r.AvailableHelpHints.ACCOUNT_HINT_POSTING_EDITOR_PHOTO_ATTACHMENTS_CROP)){const e=Number(a.vkLocalStorage.getItem(s.STORAGE_HINT_NAME));e&&e+1>=5?((0,n.ensureAccountHelpHintsService)().hideHelpHint({hintId:r.AvailableHelpHints.ACCOUNT_HINT_POSTING_EDITOR_PHOTO_ATTACHMENTS_CROP}),a.vkLocalStorage.removeItem(s.STORAGE_HINT_NAME)):a.vkLocalStorage.setItem(s.STORAGE_HINT_NAME,e+1),(0,c.renderCarouselRatioSelectorHint)({element:this.selectorEl,text:l.getLang("global_posting_carousel_ratio_hint")+" "+s.RatioShowValue[_]})}}constructor(_,e,t,o,i={isHidden:!0,isEnabled:!1}){this.linkId=e,this.selectorEl=t,this.tooltip=this.createTooltip(),this.addMedia=_,o&&(this.selectOption(o),this.setCarouselRatio(o)),this.setVisibility(!i.isHidden),this.setEnabled(i.isEnabled)}}},169709:(_,e,t)=>{"use strict";t.d(e,{renderCarouselRatioSelectorHint:()=>E});var o=t(474848),i=t(296540),s=t(320830),l=t(102846),a=t(473438),n=t(205338),r=t(171444);const d=({element:_,text:e,onClose:t})=>{const[n,r]=(0,i.useState)(!0),d=(0,i.useCallback)((()=>{t?.(),r(!1)}),[t,r]);return(0,i.useEffect)((()=>(window.addEventListener("mousedown",d,{once:!0}),()=>window.removeEventListener("mousedown",d))),[d]),(0,o.jsx)(s.TextTooltip,{appearance:"neutral",hideWhenReferenceHidden:!0,placement:"top-end",offsetDistance:0,shown:n,onClose:d,text:(0,o.jsx)(l.InnerHTML,{children:e}),children:(0,o.jsx)(a.ElementPortal,{element:_})})},E=({onClose:_,...e})=>{const t=document.createElement("div");document.body.append(t),e.element.parentElement&&e.element.parentElement.setAttribute("data-tooltip-container","true");const i=(0,n.createRoot)(t),s=()=>{i.unmount(),t.remove()};i.render((0,o.jsx)(d,{...e,onClose:()=>{_?.(),s()}})),(0,r.pushNavDestroy)((()=>{t&&s()}))}},205712:(_,e,t)=>{"use strict";t.d(e,{initCarouselRatioSelector:()=>r});var o=t(7226),i=t(853687),s=t(420211),l=t(857558),a=t(499048),n=t(964032);const r=({linkId:_,postActionsEl:e,addMedia:t,initValue:r})=>{if(!(e instanceof HTMLElement))return;let d="";Object.values(n.ratioValues).forEach((_=>{const e=_===r?`<span class="FancyElementTT__checkIcon">${(0,s.getIcon16Done)().icon}</span>`:"";d+=`<div class="FancyElementTT__item radiobtn" role="radio" data-value="${_}" aria-label="${i.RatioShowValue[_]}">\n    ${e}\n  <div class="FancyElementTT__itemLabel">${i.RatioShowValue[_]}</div>\n</div>`}));const E=document.createElement("div");E.classList.add("post_action_btn"),E.id=i.ACTION_BUTTON_ID+_??"",E.innerHTML=`<div class="post_action_btn_layout">\n    <span class="post_action_btn_text">${r&&i.RatioShowValue[r]?i.RatioShowValue[r]:""}</span>\n    <span class="post_action_image_btn">${(0,l.getIcon12Dropdown)().icon}</span>\n    <div class="post_action_tt_content">\n      ${d}\n    </div>\n  </div>`;const c=e.querySelector(`#${a.ACTION_BUTTON_ID}`)||e.querySelector(`#${a.ACTION_BUTTON_ID}${_}`);if(!c)return;c.after(E);const p=new o.CarouselRatioSelector(t,_,E,r,{isHidden:!0,isEnabled:!1}),u=(_,e)=>{e?(p.setVisibility(!0),p.setEnabled(!0)):p.setVisibility(!1)};return u(0,t.isRatioSelectorVisible()),t.emitter.on(t.eventTypes.previewUpdate,u),t.emitter.on(t.eventTypes.viewDraw,u),{setOption:_=>{p.selectOption(_)},onClear:()=>{p.setVisibility(!1)},showHintTooltip:_=>{p.showHintTooltip(_)}}}},221123:(_,e,t)=>{"use strict";t.d(e,{getThumbsCount:()=>u,isCarouselAllowed:()=>P,isGridAllowed:()=>b,makeReactCarouselRenderer:()=>p,mediaDataToAttachments:()=>O,mediaDataToClickHandlers:()=>D,renderCarousel:()=>w});var o=t(26023),i=t(152314),s=t(568352),l=t(263425),a=t(810903),n=t(410796),r=t(8520),d=t(610989),E=t(964032);const c="PrimaryAttachmentCarouselWrapper",p=()=>{let _;return({thumbs:e,onDelete:o,ratio:i,changeRatio:s},l)=>{const a=()=>{_&&_.isMounted()&&_.unmount(),_=void 0;const e=l.querySelector(`.${c}`);e?.remove()};if(!e.length)return a(),()=>{};if(!_?.isMounted()){l.innerHTML=`<div class="${c}"></div>`;if(!l.querySelector(`.${c}`))return()=>{};_||(_=(0,n.createReactLazyInitiator)((()=>(0,r.asyncImportLoader)((()=>Promise.all([t.e(91498),t.e(89631),t.e(762),t.e(52781)]).then(t.bind(t,997004)).then((({PrimaryAttachmentsCarousel:_})=>_))))),(()=>l.querySelector(".PrimaryAttachmentCarouselWrapper"))))}return _?.render({thumbs:e,onDelete:o,ratio:i,changeRatio:s}),a}},u=_=>(0,i.getThumbsMediaItems)(_).length,P=(_,{skipClipsCheck:e=!1}={})=>{const t=(0,E.isCarouselCropEnabled)()||u(_)>1,o=e||_?.every((([_,,e])=>!(_===i.THUMB_TYPE_VIDEO&&e?.editable?.is_short_video)));return Boolean(t&&o)},b=(_,e=!1)=>{const t=_?.every((([_,,e])=>_===i.THUMB_TYPE_VIDEO&&e?.editable?.is_short_video));return Boolean((!e||t)&&(!(0,E.isCarouselCropEnabled)()||u(_)>1||t&&1===u(_)))},O=_=>[...new Set((0,i.getThumbsMediaItems)(_).map((([_,e])=>`${_}${e}`)))].join(","),D=_=>_?.reduce(((_,e)=>{if(e[2]&&"editable"in e[2]){const t=e[2]?.editable?.click;_[e[1]]=t??_[e[1]]}return _}),{})??{},M=_=>e=>{if(!_)return;if(!(e.target instanceof HTMLElement))return;const t=function(_){const e=".js-PrimaryAttachment",t=_.closest(e);if(!t)return void(0,s.logError)(new Error("PrimaryAttachment: posting delete handler: missing card"));const o=t.closest(".js-PrimaryAttachmentCarousel");if(!o)return void(0,s.logError)(new Error("PrimaryAttachment: posting delete handler: missing carousel"));const i=o.querySelectorAll(e),a=Array.prototype.indexOf.call(i,t);if(-1===a)return void(0,s.logError)(new Error("PrimaryAttachment: posting delete handler: card not in carousel"));const n=(0,l.getPrimaryCarouselGallery)(t);if(!n)return;return{gallery:n,index:a}}(e.target);if(!t)return void(0,s.logError)(new Error("PrimaryAttachment: posting delete handler: missing gallery instance"));const{gallery:o,index:i}=t;o.removeItem(i),_(i)},w=({oid:_,postId:e,attachments:t,photoClickHandlers:i,onDelete:s,wkView:l=!1},n)=>{n.firstChild||(n.innerHTML='<div class="PrimaryAttachmentCarousel__skeleton"></div>');let r=()=>{},E=!1,c=!1;return{renderCarouselPromise:new Promise(((o,i)=>{const s=window.ajax.post("al_wall.php",{act:"render_carousel",post_id:e,owner_id:_,attachments:t,wk_view:l?1:0},{onDone:o,onFail:()=>(i(),!1)});r=()=>{c||(E=!0,s.abort(),i())}})).catch((()=>({carousel_html:""}))).then((_=>{const e=_?.carousel_html;if(!E&&n&&e){n.innerHTML=`<div class="PrimaryAttachmentCarouselWrapper">${String(e)}</div>`,Object.keys(i).forEach((_=>{const e=n.querySelector(`[data-photo-id="${_}"]`);e?.addEventListener("click",(e=>{e.stopPropagation(),e.preventDefault(),i[_]?.()}))}));const _=n.querySelector(".PrimaryAttachmentCarouselWrapper")??void 0;n.querySelectorAll(".js-PrimaryAttachmentCarousel__close").forEach((e=>{e.addEventListener("mouseover",(()=>{(0,a.showTooltip)(e,{text:d.getLang("dont_attach"),shift:[11,8],black:1,appendEl:_,dir:void 0})}))})),(0,o.default)(n,".js-PrimaryAttachmentCarousel__close","click",M(s))}c=!0})),abort:r}}},954347:(_,e,t)=>{"use strict";t.d(e,{ATTR_USER_REACTION_ID:()=>o});const o="data-reaction-user-reaction-id"},197888:(_,e,t)=>{"use strict";t.d(e,{getLastOwnReactionChangeTime:()=>h,setDataCurrentId:()=>A,updateReactionButtonContainerForCounts:()=>m,updateReactionButtonCounts:()=>T,updateReactionButtonForCurrentReaction:()=>C});var o=t(441120),i=t(7144),s=(t(226095),t(610989)),l=t(221097),a=t(198882),n=t(452314),r=t(663878),d=t(954347),E=t(738028),c=t(371098),p=t(185105);const u="data-reaction-last-own-change-time",P="PostButtonReactions__icon--animationActive";const b="post_button";o.LottieManager.observer.ignoreGroup(b);const O=_=>{const e=_.__reactionIconAnimation?.player;e&&(e.destroy(),delete _.__reactionIconAnimation)},D=async(_,e,t,i)=>{if(!(_!==t.__reactionIconAnimation?.animationURL)&&_||(O(t),e.innerHTML="",t.classList.remove(P)),!i||!_)return;const s=await o.LottieManager.loadAnimation({group:b,animationUrl:_,containers:[e],loop:!1,autoplay:!0});s.addEventListener("firstFrame",(()=>{t.classList.add(P)})),s.addEventListener("loopComplete",(()=>{(function(){const _=(0,p.getReactionConfig)();return!0===_?.animationShowStaticAfterEnd})()&&(t.classList.remove(P),O(t))})),t.__reactionIconAnimation={player:s,animationURL:_}},M=(_,e)=>{const t=_.querySelector('[data-section-ref="reactions-button-icon"]');if(!t)return;const{currentOption:o,isUserAction:i}=e;if(o.isReactionSet){const _=o.current,e=_?.imageMenuURL;t.style.backgroundImage=`url('${e}')`,t.setAttribute("aria-label",_?.title)}else{const _=o.default;t.style.backgroundImage="",_?.title&&t.setAttribute("aria-label",_?.title)}t.classList.toggle("PostButtonReactions__icon--custom",o.isReactionSet);{const _=o.isReactionSet?o.current.animationURL:void 0,e=(_=>{let e=_.querySelector(".PostButtonReactions__iconAnimation");return e||(e=(0,n.se)('<div class="PostButtonReactions__iconAnimation" data-section-ref="reactions-button-icon-animation"></div>'),_.appendChild(e),e)})(t);D(_,e,t,i)}},w=(_,e,t)=>{_.classList.toggle("PostButtonReactions--icon-active",e),_.classList.toggle("PostButtonReactions--active",e)},m=(_,e)=>{const t=!e||!(0,a.hasReactionsForCounts)(e);_.classList.toggle("PostBottomAction--empty",t)},C=(_,e,t,o)=>{const i=!(0,a.isReactionIdUnset)(e),n=((_,e)=>{let t,o=(0,a.getDefaultReaction)(_);if((0,a.isReactionIdUnset)(e)){if(o)return{isReactionSet:!1,default:o}}else{if(t=_.itemsById[e],t)return{isReactionSet:!0,current:t};console.error(new Error(`Missing reaction meta for ${e} in set '${_.id}'`))}return{_error:!0}})(t,e);"_error"in n||(M(_,{currentOption:n,isUserAction:o}),((_,e)=>{const{currentOption:t}=e,o=t.isReactionSet?t.current.titleColor:void 0,i=t.isReactionSet?t.current.backgroundColor:void 0,s={...o?{"--reaction-button-title-color-light":o.light,"--reaction-button-title-color-dark":o.dark}:{"--reaction-button-title-color-light":null,"--reaction-button-title-color-dark":null},...i?{"--reaction-button-background-color-light":i.light,"--reaction-button-background-color-dark":i.dark}:{"--reaction-button-background-color-light":null,"--reaction-button-background-color-dark":null}};Object.entries(s).forEach((([e,t])=>{_.style.setProperty(e,t)}))})(_,{currentOption:n}),((_,e)=>{const{currentOption:t}=e;let o="";o=t.isReactionSet?(0,s.langReplace)(s.getLang("reactions_button_unset_reaction_title")||"",{reaction_name:t.current.title||""}):(0,s.langReplace)(s.getLang("reactions_button_set_reaction_with_name")||"",{reaction_name:t.default.title||""})||s.getLang("reactions_button_title")||"",_.setAttribute("aria-label",o||"")})(_,{currentOption:n}),(0,E.isCounterEnabledForBtn)(_)||((_,e)=>{const t=_.querySelector('[data-section-ref="reactions-button-title"]');if(!t)return;const{currentOption:o}=e,i=o.isReactionSet?o.current.title:o.default.title;i?t.innerText=i:(0,l.isDebugEnabled)()&&console.log("reactions: setReactionNameTitle: missing title",o)})(_,{currentOption:n})),w(_,i),o&&function(_,e){_.setAttribute(u,String(e))}(_,Date.now())},T=(_,e,t,o,i)=>{const n=(0,E.getCounterForTitle)(_,e,o,i);if((0,E.isCounterEnabled)(n)&&(((_,e)=>{const t=_.querySelector('[data-section-ref="reactions-button-title"]');if(!t)return;const{counterForTitle:o}=e;if((0,E.isCounterAvailable)(o)){const _=o.buttonText;(0,r.animateCount)(t,_,{allowZero:o.allowZeroAnimation,str:!0,noWrapWidth:!0,noSpaceIfEmpty:!0})}else(0,l.isDebugEnabled)()&&console.log("reactions: setReactionTitle: missing title",o)})(_,{counterForTitle:n}),o)){((_,e)=>{const t=(0,c.getClosestLikeBtnContainerElem)(_)?.querySelector('[data-section-ref="reactions-button-screen-reader-counter"]');if(!t)return;const o=(0,s.langNumeric)(e,s.getLang("reactions_n_reacted","raw")||"%s");t.innerText=o})(_,(0,a.calcCountersSum)(o))}},h=_=>{const e=_.getAttribute(u);if(e&&(0,i.isNumeric)(e))try{return new Date(Number.parseInt(e)).getTime()||void 0}catch(_){return void console.error(_)}};const A=(_,e)=>{_.setAttribute(d.ATTR_USER_REACTION_ID,(0,a.isReactionIdUnset)(e)?"":String(e))}},676084:(_,e,t)=>{"use strict";t.d(e,{ReactionMenuTitleVariants:()=>s,TITLE_VARIANT_DEFAULT:()=>i,TitleVariantWithLikedUsers:()=>o});const o="WithLikedUsers",i=o,s=[o,"TitleOnly"]},426719:(_,e,t)=>{"use strict";t.d(e,{ButtonStyleVariant:()=>o});const o={Post:"post",Reply:"reply"}},946398:(_,e,t)=>{"use strict";t.d(e,{renderPreviewItems:()=>d});var o=t(8520),i=t(198882),s=t(452314),l=t(962444),a=t.n(l),n=t(426719),r=t(185105);const d=(_,e,t,l,d)=>{const E=((_,e,t=!1)=>{let o=[];for(const e of Object.keys(_)){const t=(0,i.parseReactionId)(e);t.isValid&&_[t.value]>0&&o.push(t.value)}return o=o.sort(((e,t)=>(_[t]||0)-(_[e]||0))).slice(0,e),t&&o.reverse(),o})(e,3),c=_.querySelector(".ReactionsPreview__items"),p=(0,r.getReactionSet)(t),u=0===(0,i.calcCountersSum)(e),P=a().reactions_preview_item;c&&p&&"string"==typeof P?(c.innerHTML=E.map((_=>{const e=p.itemsById[_];if(!e)return"";const t=(0,o.classNames)({"ReactionsPreviewItem--lite ReactionsPreviewItem--stackOverlayLite":d===n.ButtonStyleVariant.Reply,"ReactionsPreviewItem--post ReactionsPreviewItem--stackOverlayPost":d===n.ButtonStyleVariant.Post});return(0,s.rs)(P,{image_url:e.imagePreviewURL,title:e.title,class:t})})).join(""),_.classList.toggle("ReactionsPreview--empty",u),_.classList.toggle("ReactionsPreview--active",void 0!==l)):console.warn("Unable to render reaction previews",{itemsContainer:c,previewItemTemplate:P,reactionSet:p})}},335291:(_,e,t)=>{"use strict";t.d(e,{isIntentPreviewHidden:()=>n,isIntentPreviewInActionStatusBar:()=>a,isIntentPreviewUseCurrent:()=>r,isVariantHidden:()=>s,isVariantInActionStatusBar:()=>i,parsePreviewVariant:()=>E,previewVisibilityIntentForVariant:()=>d,previewVisibilityUseCurrent:()=>l});var o=t(396708);const i=_=>_===o.PreviewVariantActionStatusBar,s=_=>_===o.PreviewVariantHidden,l={kind:"useCurrent"},a=_=>_.kind===o.PreviewVariantActionStatusBar,n=_=>_.kind===o.PreviewVariantHidden,r=_=>"useCurrent"===_.kind,d=_=>_?{kind:_}:l,E=_=>o.PreviewVariants.includes(_)?_:void 0},396708:(_,e,t)=>{"use strict";t.d(e,{PreviewVariantActionStatusBar:()=>o,PreviewVariantHidden:()=>i,PreviewVariants:()=>s});const o="action_status_bar",i="hidden",s=[o,i]},738028:(_,e,t)=>{"use strict";t.d(e,{getCounterForTitle:()=>l,isCounterAvailable:()=>n,isCounterEnabled:()=>a,isCounterEnabledForBtn:()=>s});var o=t(198882),i=t(610989);const s=_=>!!_.getAttribute("data-reaction-button-text-is-counter");function l(_,e,t,l){if(!s(_))return{kind:"disabled"};if(!t)return{kind:"error"};const a=0!==(l?(0,o.calcCountersSum)(l):0);if(!(0,o.hasReactionsForCounts)(t))return{kind:"enabled",allowZeroAnimation:a,buttonText:""};const n=(0,o.calcCounters)(t,e),r=(0,o.calcCountersWeightedSum)(n);return{kind:"enabled",allowZeroAnimation:a,buttonText:(0,i.langNumeric)(r,"%s",!0)}}function a(_){return!!_&&"disabled"!==_.kind}function n(_){return"enabled"===_.kind}},572700:(_,e,t)=>{"use strict";t.d(e,{addDataUpdateListener:()=>a,addReactionChooseListener:()=>r,emitDataUpdate:()=>n,emitReactionChoose:()=>d});var o=t(942451),i=t(678751);const s=(0,o.makeSharedState)("reactions-menu-events",(()=>({emitter:new i.default})),{version:0}),l=()=>s().emitter,a=(_,e)=>{const t=l(),o=`${_}:data_update`,i={[o]:e};return t.addListeners(i),()=>{t.removeListeners(i)}},n=(_,e)=>{l().emit(`${_}:data_update`,e)},r=(_,e)=>{const t=l(),o=`${_}:reaction_choose`,i={[o]:e};return t.addListeners(i),()=>{t.removeListeners(i)}},d=_=>{l().emit(`${_}:reaction_choose`)}},468961:(_,e,t)=>{"use strict";t.d(e,{getPreviewVariantForLikeBtn:()=>u,reactionsElemPayload:()=>P,reactionsElemPayloadForBadges:()=>b,shouldReactionsPreviewBeVisible:()=>D,updateReactionsButtonForCounts:()=>m,updateReactionsPreview:()=>w,verifyPayloadForBadges:()=>O});var o=t(614212),i=t(198882),s=t(663878),l=t(610989),a=t(185105),n=t(371098),r=t(503085),d=t(335291),E=t(946398),c=t(954347);const p=_=>{const e=_.getAttribute("data-reaction-counts");if(null===e)return{};const t=e?(0,o.parseJSON)(e):void 0;return"object"==typeof t&&null!==t?t:void 0},u=_=>{const e=_.getAttribute("data-reaction-preview-variant");if(e)return(0,d.parsePreviewVariant)(e)},P=_=>{const e=_.getAttribute("data-reaction-target-object"),t=_.getAttribute("data-reaction-hash"),o=_.getAttribute("data-reaction-set-id");if(null===o)return;const s=_.getAttribute(c.ATTR_USER_REACTION_ID),l=s?(0,i.parseReactionIdOrUnset)(s):void 0,a=_.getAttribute("data-reaction-style-variant"),n=a&&(0,r.isValidButtonStyleVariant)(a)?a:void 0,d=_.getAttribute("data-reaction-menu-title-variant"),E=d&&(0,r.isValidButtonTitleVariant)(d)?d:void 0,P=u(_);return{counts:p(_),csrfHash:t,objectRaw:e,reactionSetId:o,styleVariant:n,titleVariant:E,userReactionId:l,previewVariant:P}},b=_=>({objectId:_.getAttribute("data-badges-object-id"),objectOwnerId:_.getAttribute("data-badges-object-owner-id"),objectType:_.getAttribute("data-badges-object-type"),ref:_.getAttribute("data-badges-ref"),showOnboarding:_.getAttribute("data-badges-show-onboarding")}),O=_=>{const{objectId:e,objectOwnerId:t,objectType:o}=_;return e&&t&&o},D=_=>(0,i.hasReactionsForCounts)(_),M=(_,{counts:e,countsPrevious:t,objectRaw:o,reactionId:r,reactionSetId:d,styleVariant:c})=>{const p=(0,a.getReactionSet)(d),u=(0,i.calcCounters)(e,p),P=(0,i.calcCountersWeightedSum)(u),b=(0,i.calcCountersSum)(e),O=t?(0,i.calcCountersSum)(t):0,D=(0,n.getPreviewElem)(o);D&&((0,E.renderPreviewItems)(D,e,d,r,c),((_,e,t,o)=>{const i=(0,l.langNumeric)(t,l.getLang("reactions_n_reacted","raw")||"%s",!0);_.setAttribute("aria-label",i);const a=_.querySelector('[data-section-ref="like-button-count"]')??void 0;if(!a)return;_.tt&&"object"==typeof _.tt&&(_.tt.shown||_.tt.showing||_.tt?.destroy?.());const n=(0,l.langNumeric)(e,"%s",!0);(0,s.animateCount)(a,n,{allowZero:0!==o,str:!0,noWrapWidth:!0,noSpaceIfEmpty:!0})})(D,P,b,O))},w=(_,e)=>{const t=(0,n.getLikeBtnElem)(_),o=e.counts;t&&o?((_,e,t)=>{const o=P(_);o&&o.objectRaw&&M(0,{counts:e,countsPrevious:t,objectRaw:o.objectRaw,reactionId:o.userReactionId,reactionSetId:o.reactionSetId,styleVariant:o.styleVariant})})(t,o,e.countsPrevious):console.warn("Unable to update object reactions",{objectRaw:_,options:e})},m=(_,{counts:e})=>{const t=(0,n.getLikeBtnElem)(_);t&&((_,e)=>{_.setAttribute("data-reaction-counts",JSON.stringify(e))})(t,e)}},371098:(_,e,t)=>{"use strict";t.d(e,{getButtonContainer:()=>l,getClosestLikeBtnContainerElem:()=>i,getHiddenLikeBtn:()=>r,getLikeBtn:()=>n,getLikeBtnElem:()=>o,getLikeWrap:()=>s,getMenuMount:()=>a,getPreviewElem:()=>d});const o=_=>document.querySelector(`[data-section-ref="reactions-button"][data-reaction-target-object="${_}"]`)??void 0,i=_=>_.closest('[data-section-ref="reactions-button-container"]')??void 0,s=_=>{const e=o(_);if(e)return e.closest(".like_wrap")??void 0},l=_=>_.closest('[data-section-ref="reactions-button-container"]'),a=_=>_.querySelector('[data-section-ref="reactions-menu-mount"]')??null,n=_=>_.querySelector('[data-section-ref="reactions-button"]')??null,r=_=>_.querySelector('[data-section-ref="reactions-hidden-button"]')??void 0,d=_=>document.querySelector(`[data-section-ref="reactions-preview-items"][data-reaction-target-object="${_}"]`)},503085:(_,e,t)=>{"use strict";t.d(e,{isValidButtonStyleVariant:()=>c,isValidButtonTitleVariant:()=>E,isValidEnvironment:()=>l,preloadImage:()=>a,usePrevious:()=>n,usePreviousRef:()=>r});var o=t(296540),i=t(676084),s=t(426719);const l=()=>"function"==typeof window.cur?.viewAsBox?(window.cur.viewAsBox(),!1):!(window.vk.widget&&!window.vk.id)||(window.Widgets?.oauth?.(),!1),a=_=>new Promise(((e,t)=>{const o=new Image;o.src=_,o.onload=()=>e(),o.onerror=()=>t()})),n=_=>{const e=(0,o.useRef)(_);return(0,o.useEffect)((()=>{e.current=_})),e.current},r=_=>{const e=(0,o.useRef)(_);return(0,o.useEffect)((()=>{e.current=_})),e},d=Object.values(s.ButtonStyleVariant),E=_=>i.ReactionMenuTitleVariants.includes(_),c=_=>d.includes(_)},40113:(_,e,t)=>{"use strict";t.d(e,{isReactionsFullUpdatePayload:()=>s,reactionsCountsOnlyUpdatePayload:()=>l,reactionsCountsUpdatePayload:()=>i});var o=t(973634);const i=(_,e)=>({kind:o.PayloadKindFull,..._,reactionIdState:{reactionId:e.id}}),s=_=>_.kind===o.PayloadKindFull,l=_=>({kind:o.PayloadKindCountsOnly,..._})},973634:(_,e,t)=>{"use strict";t.d(e,{PayloadKindCountsOnly:()=>o,PayloadKindFull:()=>i});const o="counts_only",i="counts_with_current_reaction"},82404:(_,e,t)=>{"use strict";t.d(e,{postRenderReactionsInit:()=>B});var o=t(197888),i=t(8520),s=t(650164),l=t(452314),a=t(837542),n=t(630298),r=t(283080),d=t(468961),E=t(335291),c=t(371098),p=t(40113),u=t(47762),P=t(489944),b=t(193933),O=t(476726),D=t(572700),M=t(396708),w=t(185105),m=t(400066);const C=(_,e,t=window.cur?.wallTpl)=>{const o=t?.[_];if(o)return(0,a.stripPercentVars)((0,l.rs)(o,e));console.warn(`renderTemplate: missing template '${_}'`,t)},T=({isUserAction:_=!1},...e)=>{_?console.error(...e):(0,r.isDebugEnabled)()&&console.warn(...e)},h=_=>(0,m.isBadgesEnabled)()&&_.classList.contains("PostActionStatusBar--withBadges");const A=(_,e,{isActionStatusBarVisible:t,isReactionsPreviewVisible:o,positionTrackingEnd:s})=>{const a=((_,e)=>{const t=(0,c.getLikeWrap)(_);if(!t)return;const o=(0,P.getPostElem)(e,t),i=o?.querySelector('[data-section-ref="post-action-status-bar"]');if(i)return{actionStatusBar:i};const s=(0,b.isWkLayerWallPostOpen)()?window.wkcur?.wallTpl:window.cur?.wallTpl,a=(0,l.se)(C("post_action_status_bar",{class:"PostActionStatusBar--hidden"},s));return a?((0,O.partConfigEnabled)("feed_redesign_post_bottom_2023_enabled")?(0,l.domInsertAfter)(a,t):(0,l.domInsertBefore)(a,t),{actionStatusBar:a}):void 0})(_,e.postFullId);if(!a)return void T({},"Unable to init ActionStatusBar in post",e);const{actionStatusBar:n}=a;if(n.classList.toggle("PostActionStatusBar--hidden",!t),h(n)&&n.classList.toggle("PostActionStatusBar--withReactions",o),t&&!(0,c.getPreviewElem)(_)){const e=(0,l.se)(function(_,e,t={}){const o=(0,b.isWkLayerWallPostOpen)()?window.wkcur?.wallTpl:window.cur?.wallTpl,s=(0,i.classNames)({"ReactionsPreview--empty":!_,"ReactionsPreview--isInActionStatusBar":!!t.isInActionStatusBar});return C("post_reactions_preview",{class:s,object_raw:e},o)}(o,_,{isInActionStatusBar:!0}));if(h(n)){const _=n.querySelector(".PostActionStatusBar__leftInner");_&&_.prepend(e)}else n.prepend(e)}if(s){const e=(0,c.getLikeBtnElem)(_);s?.(e)}},g=_=>{if(!(_=>void 0!==_.counts)(_))return void T(_,"Counts is invalid or missing");const e=(0,n.likePostObjectId)(_.postFullId),t=(0,P.getPostElem)(_.postFullId,(0,c.getLikeWrap)(e));t||T(_,"Missing post element for reactions preview update",{payload:_,likeWrap:(0,c.getLikeWrap)(e)});const o=(0,c.getLikeBtnElem)(e);if(!o)return void T(_,"Unable to find reactions button",{likeObjectId:e});const i=(0,d.reactionsElemPayload)(o),s=i?.counts;R({elemPayload:i,likeBtnElem:o,likeObjectId:e,payload:_}),I({countsPrevious:s,likeBtnElem:o,likeObjectId:e,payload:_,postEl:t})},R=({elemPayload:_,likeBtnElem:e,likeObjectId:t,payload:i})=>{const{counts:s}=i;if(!!i.isQueueUpdate&&(_=>{const e=(0,o.getLastOwnReactionChangeTime)(_);if(!e)return!1;const t=e+1e4;return Date.now()<t})(e))(0,r.isDebugEnabled)()&&console.log("Ignoring reactions update from queue",i);else{if(_){const{counts:t,reactionSetId:l}=_,a=(0,w.getReactionSet)(l);if((0,p.isReactionsFullUpdatePayload)(i)){const _=i.reactionIdState.reactionId;a&&(0,o.updateReactionButtonForCurrentReaction)(e,_,a,i.isUserAction)}a&&((0,o.updateReactionButtonCounts)(e,a,i.isUserAction,s,t),(0,o.updateReactionButtonContainerForCounts)(e,s))}if((0,p.isReactionsFullUpdatePayload)(i)){const t=i.reactionIdState.reactionId;(0,o.setDataCurrentId)(e,t),i.isUserAction&&_?.objectRaw&&(0,D.emitDataUpdate)(_.objectRaw,{currentReactionId:t})}(0,d.updateReactionsButtonForCounts)(t,{counts:s})}},I=({countsPrevious:_,likeBtnElem:e,likeObjectId:t,payload:o,postEl:i})=>{const{counts:l,previewVisibility:a=E.previewVisibilityUseCurrent}=o,n=((_,e)=>{if((0,E.isIntentPreviewInActionStatusBar)(_))return{previewVariant:M.PreviewVariantActionStatusBar};if((0,E.isIntentPreviewHidden)(_))return{previewVariant:M.PreviewVariantHidden};if((0,E.isIntentPreviewUseCurrent)(_)){const _=(0,d.getPreviewVariantForLikeBtn)(e);if(_)return{previewVariant:_}}})(a,e);if(!n)return;const{previewVariant:r}=n,c=(0,E.isVariantInActionStatusBar)(r),p=(0,d.shouldReactionsPreviewBeVisible)(l),u=(0,E.isVariantHidden)(r)||c&&!p;if(c){let _;o.isPrimaryLikeButtonClick&&!o.isFromWkLayer&&(_=(0,s.preservePositionBetween)(e).start());const l=p;(0,m.isBadgesEnabled)()||i?.classList.toggle("post--withActionStatusBar",l),A(t,o,{isActionStatusBarVisible:l,isReactionsPreviewVisible:p,positionTrackingEnd:_})}u||(0,d.updateReactionsPreview)(t,{counts:l,countsPrevious:_})},L=_=>{if(!r.ENABLED_IN_POST_REPLY)return!1;const{counts:e}=_;if(!e)return;const t=(0,n.likeReplyObjectId)(_.replyFullId);(0,d.updateReactionsPreview)(t,{counts:e,countsPrevious:void 0}),(0,d.updateReactionsButtonForCounts)(t,{counts:e})},B=()=>{let _=[(0,u.registerUniqueListener)("wall-post-action-status-bar",u.WallDataEvents.post_reactions_counts_update,g),(0,u.registerUniqueListener)("wall-reply-reactions-counts",u.WallDataEvents.reply_reactions_counts_update,L)];return{onDestroy:()=>{_.forEach((_=>{_()})),_=[]}}}},678041:(_,e,t)=>{"use strict";t.d(e,{ReportReasonIds:()=>c,afterCommentReportSubmit:()=>u,showReportForm:()=>p});var o=t(474848),i=t(618913),s=t(610989),l=t(105352),a=t(933052),n=t(186301),r=t(507607),d=t(272259);(0,l.initApi)();const E=window.vk;var c;function p(_,e,i,s,l,a,n,E){const c=(0,r.asyncComponent)((()=>Promise.all([t.e(91498),t.e(89631),t.e(99595)]).then(t.bind(t,930887))),(({ReportForm:_})=>_));(0,d.showMessageBoxModalSuspense)((t=>(0,o.jsx)(c,{...t,reportSource:_,reportSourceOwnerId:e,reportSourceId:i,onSubmit:s,messengerAdditionalData:a,from:n,adData:E})),{onDestroy:l})}function u(_,e,t){const o=function(_,e,t){switch(_){case"photo":return`#post${e}photo_${t}`;case"video":return`#post${e}video_${t}mv`;case"market":return`#post${e}market_${t}`}}(_,e,t);if("photo"===_){const _=document.querySelector(`${o} .dld`);null!==_&&(_.outerHTML="")}const l=document.querySelector(`${o} .reply_wrap`);null!==l?(l.style.display="none",l.outerHTML+=`<div class="dld">${s.getLang("global_report_sent")}</div>`):(0,i.debugLog)(`Unable to hide report button for ${_} comment`)}(0,a.setLoginConfig)({onCaptcha:n.handleCaptcha,domain:E?.apiConfigDomains?.loginDomain}),(0,a.setApiConfig)({onCaptcha:n.handleCaptcha,domain:E?.apiConfigDomains?.apiDomain}),function(_){_[_.NotOriginalContent=28]="NotOriginalContent"}(c||(c={}))},815019:(_,e,t)=>{"use strict";t.d(e,{checkStopActionOnEventOnSticker:()=>c,checkStopActionOnEventOnStickerPopupIcon:()=>E,previewSticker:()=>a,showPackByClickOnSticker:()=>n,wrapSticker:()=>d});var o,i=t(427360),s=t(957081),l=t(524258);!function(_){_.MESSAGE="message"}(o||(o={}));const a=_=>window.Emoji.previewSticker(_,!1,{sticker_referrer:"message"}),n=(_,e)=>{(0,s.isNewStickerPicker)()?window.StickerPickerViewer?.api.getPack({productId:_}).then((t=>{Boolean(t?.product?.active)?window.StickerPickerViewer?.showPack(_,e):a(_)})).catch((()=>{a(_)})):window.Emoji.getStickerPack(_).then((t=>{Boolean(t&&t[window.Emoji.PACK_FIELD_IS_ACTIVE])?window.Emoji.showPackInKeyboard(_,e):a(_)}))},r=_=>`stickerSize${_}`,d=({stickerHtml:_,stickerWrapperClass:e="",icon:t,iconClass:o,size:s,iconTqAttrs:l})=>{const a=t?`<div class="${i.STICKER_ICON_CLASS} ${o}" ${l}>${t}</div>`:"";return`\n  <div class="${[i.STICKER_ROW_CLASS,e,r(s)].join(" ")}">\n    ${_}\n    ${a}\n  </div>  \n`},E=_=>{const e=_?.target;return!!e?.closest("."+l.POPUP_STICKER_ICON_CLASS)},c=_=>{const e=_?.target;return!!e?.closest("."+i.STICKER_ROW_CLASS)||(!!e?.closest("."+l.POPUP_STICKER_WRAPPER_CLASS)||!!E(_))}},918595:(_,e,t)=>{"use strict";t.d(e,{WallDataEvents:()=>s,emitEvent:()=>d,registerNonGlobalNonUniqueListener:()=>r,registerUniqueListener:()=>n});var o=t(942451),i=t(678751);const s={post_reactions_counts_update:"wall/post_reactions_counts_update",reply_reactions_counts_update:"wall/reply_reactions_counts_update",post_subscribe_update:"wall/post_subscribe_update"},l=(0,o.makeSharedState)("wall-data",(()=>({emitter:new i.default,keyedListeners:Object.create(null)})),{version:0}),a=(_,e,t)=>{const o=l(),i=o.keyedListeners?.[_]?.[e];return i&&o.emitter.removeListener(_,i),((_,e,t)=>{const o=l();return o.emitter.addListener(_,t),o.keyedListeners[_]={...o.keyedListeners[_],[e]:t},()=>{o.emitter.removeListener(_,t);const i=o.keyedListeners[_]?.[e];i===t&&delete o.keyedListeners[_]?.[e]}})(_,e,t)},n=(_,e,t)=>a(e,_,t),r=(_,e)=>((_,e)=>{const t=l();return t.emitter.addListener(_,e),()=>{t.emitter.removeListener(_,e)}})(_,e),d=(_,e)=>{l().emitter.emit(_,e)}},815578:(_,e,t)=>{"use strict";t.d(e,{scrollOutsideFixedReplyArea:()=>s});var o=t(452314),i=t(912493);const s=(_,e)=>{if(!(_ instanceof HTMLElement&&e instanceof HTMLElement))return;const t="fixed"===(0,o.getStyle)(e,"position"),s=void 0!==window.cur.wallLayer;if(!t){if(s)return;const _=e.closest(".replies_wrap");return void(_&&(_=>{const e=(0,o.clientHeight)();if(_.getBoundingClientRect().bottom>e){const t=(0,o.getXY)(_)[1]+(0,o.getH)(_)-e;(0,i.setActiveAreaScroll)(t)}})(_))}const l=_.getBoundingClientRect(),a=20-(e.getBoundingClientRect().top-l.bottom);a>0&&(0,i.scrollActiveAreaToYDelta)(a)}},603370:(_,e,t)=>{"use strict";t.d(e,{postSubscribeHandlerInit:()=>D,subscribeByAction:()=>P,subscribeByButton:()=>b,subscribeToAuthor:()=>u});var o=t(248298),i=t(879007),s=t(452314),l=t(20025),a=t(624216),n=t(610989),r=t(193933),d=t(918595),E=t(388078),c=t(175241);const p="_subscribed";function u(_,e,t,o,i){const s={onFail:_=>{setTimeout((0,l.showFastBox)(n.getLang("global_error"),_).hide,3e3)},...o};i=i||{},E.Ranges.isUserId(e)?a.ajax.post("al_friends.php",{act:_?"remove":"add",mid:e,hash:t,from:"post_subscribe_button",...i},s):a.ajax.post("al_groups.php",{act:_?"list_leave":"list_enter",gid:-e,hash:t,...i},s)}function P(_,e,t,a){if((0,o.actionsMenuItemLocked)(_))return;const r=(0,i.intval)((0,s.domData)(_,"value"))?1:0;let d={showProgress:()=>(0,o.lockActionsMenuItem)(_),hideProgress:()=>(0,o.unlockActionsMenuItem)(_)};const c={};E.Ranges.isUserId(e)&&a?c.from=a:E.Ranges.isGroupId(e)&&(d={...d,onDone:(o,i,a)=>{if(i){const _=(0,l.showFastBox)(n.getLang("global_warning"),i,n.getLang("group_leave_group"),(()=>{_.hide(),u(r,e,t,d,{confirm:1})}),n.getLang("global_cancel"));return!0}(0,s.val)(_,o),_.setAttribute("data-value",String(1-r)),a&&((0,s.re)((0,s.domNS)(_)),(0,s.re)(_))}}),u(r,e,t,d,c)}function b(_,e,t,{query:i}={}){const s=_.querySelector(".post_header_subscribe_button_loader"),l="post_header_subscribe_button_icons_only_loading";let a=_.classList.contains(p);const n=(0,r.isWkLayerWallPostOpen)();u(a,e,t,{onDone:()=>{n?_.classList.toggle(p,!a):(0,d.emitEvent)(d.WallDataEvents.post_subscribe_update,{groupId:-e,isSubscribed:!a}),!a&&E.Ranges.isGroupId(e)&&(0,c.trackTmrGroupsJoin)()},showProgress:()=>{_.classList.toggle(l,!0),(0,o.showProgress)(s)},hideProgress:()=>{_.classList.toggle(l,!1),(0,o.hideProgress)(s)}},i)}const O=_=>{const{isSubscribed:e,groupId:t}=_,o=document.querySelector(`[id^="post-${t}"]`),i=o?.querySelector(".post_header_subscribe_button");i&&i.classList.toggle(p,e)},D=()=>(0,d.registerUniqueListener)("wall-post-subscribe",d.WallDataEvents.post_subscribe_update,O)},47762:(_,e,t)=>{"use strict";t.d(e,{WallDataEvents:()=>o.WallDataEvents,registerUniqueListener:()=>o.registerUniqueListener});var o=t(918595)},414505:(_,e,t)=>{"use strict";t.d(e,{wallPostRenderInit:()=>s});var o=t(82404),i=t(603370);const s=()=>{(0,o.postRenderReactionsInit)(),(0,i.postSubscribeHandlerInit)()}},912493:(_,e,t)=>{"use strict";t.d(e,{scrollActiveAreaToYDelta:()=>s,setActiveAreaScroll:()=>i});var o=t(688701);const i=_=>{window.cur.wallLayer?window.wkLayerWrap&&(window.wkLayerWrap.scrollTop=_):(0,o.scrollToY)(_,0,!1,!0)},s=_=>{i((window.cur.wallLayer?window.wkLayerWrap?.scrollTop??0:(0,o.scrollGetY)())+_)}},899623:(_,e,t)=>{"use strict";t.d(e,{buildOwnerDraftKey:()=>i,parseObjectPostId:()=>o});t(623702);const o=_=>{const e=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/);if(e)return{type:e[3]||"wall",id:e[1]+"_"+e[4]}},i=_=>"wall_draft"+window.vk.id+"_"+_}}]);try{stManager.done("dist/web/chunks/73310976.011fa94b.js")}catch(_){}